<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 10 Distribuições contínuas | Probabilidade e Estatística com R</title>
<meta name="author" content="Fernando Náufel">
<meta name="description" content="10.1 Vídeo    10.2 Distribuição uniforme  10.2.1 Exemplo: gerador de números aleatórios Um programa para gerar números reais aleatórios no intervalo \([0, 10]\). A probabilidade é distribuída...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Capítulo 10 Distribuições contínuas | Probabilidade e Estatística com R">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/640px-Nightingale-mortality.jpg">
<meta property="og:description" content="10.1 Vídeo    10.2 Distribuição uniforme  10.2.1 Exemplo: gerador de números aleatórios Um programa para gerar números reais aleatórios no intervalo \([0, 10]\). A probabilidade é distribuída...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 10 Distribuições contínuas | Probabilidade e Estatística com R">
<meta name="twitter:description" content="10.1 Vídeo    10.2 Distribuição uniforme  10.2.1 Exemplo: gerador de números aleatórios Um programa para gerar números reais aleatórios no intervalo \([0, 10]\). A probabilidade é distribuída...">
<meta name="twitter:image" content="/images/640px-Nightingale-mortality.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lexend-0.4.7/font.css" rel="stylesheet">
<link href="libs/JetBrains_Mono-0.4.7/font.css" rel="stylesheet">
<link href="libs/Roboto-0.4.7/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="html_files/alterar_detalhes.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="html_files/styles_all.css">
<link rel="stylesheet" href="html_files/styles_book.css">
<link rel="stylesheet" href="html_files/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Ir para conteúdo principal</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Probabilidade e Estatística com R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Mostrar sumário</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Conteúdo"><h2>Conteúdo</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Apresentação</a></li>
<li><a class="" href="oque.html"><span class="header-section-number">1</span> O que é estatística?</a></li>
<li><a class="" href="rintro.html"><span class="header-section-number">2</span> Introdução a R</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-ao-tidyverse.html"><span class="header-section-number">3</span> Introdução ao tidyverse</a></li>
<li><a class="" href="viz.html"><span class="header-section-number">4</span> Visualização com ggplot2</a></li>
<li><a class="" href="viz2.html"><span class="header-section-number">5</span> Visualização com ggplot2 (continuação)</a></li>
<li><a class="" href="medidas.html"><span class="header-section-number">6</span> Medidas</a></li>
<li><a class="" href="probs.html"><span class="header-section-number">7</span> Probabilidades</a></li>
<li><a class="" href="variaveis.html"><span class="header-section-number">8</span> Variáveis aleatórias</a></li>
<li><a class="" href="discretas.html"><span class="header-section-number">9</span> Distribuições discretas</a></li>
<li><a class="active" href="distribui%C3%A7%C3%B5es-cont%C3%ADnuas.html"><span class="header-section-number">10</span> Distribuições contínuas</a></li>
<li><a class="" href="tcl.html"><span class="header-section-number">11</span> Teorema central do limite</a></li>
<li><a class="" href="ic.html"><span class="header-section-number">12</span> Intervalos de confiança</a></li>
<li><a class="" href="th.html"><span class="header-section-number">13</span> Testes de hipóteses</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/fnaufel/probestr">Ver código-fonte do livro <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="distribuições-contínuas" class="section level1" number="10">
<h1>
<span class="header-section-number">Capítulo 10</span> Distribuições contínuas<a class="anchor" aria-label="anchor" href="#distribui%C3%A7%C3%B5es-cont%C3%ADnuas"><i class="fas fa-link"></i></a>
</h1>
<div id="vídeo-4" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Vídeo<a class="anchor" aria-label="anchor" href="#v%C3%ADdeo-4"><i class="fas fa-link"></i></a>
</h2>
<iframe src="https://www.youtube.com/embed/TrmDPVYTpHc" width="100%" height="400px" data-external="1" class="center" style="width: 80%;">
</iframe>
</div>
<div id="distribuição-uniforme-1" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Distribuição uniforme<a class="anchor" aria-label="anchor" href="#distribui%C3%A7%C3%A3o-uniforme-1"><i class="fas fa-link"></i></a>
</h2>
<div id="exemplo-gerador-de-números-aleatórios" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> Exemplo: gerador de números aleatórios<a class="anchor" aria-label="anchor" href="#exemplo-gerador-de-n%C3%BAmeros-aleat%C3%B3rios"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Um programa para gerar números <span class="hl">reais</span> aleatórios no intervalo <span class="math inline">\([0, 10]\)</span>.</p></li>
<li><p>A probabilidade é distribuída <span class="hl">uniformemente</span> neste intervalo.</p></li>
<li><p>A variável aleatória <span class="math inline">\(X\)</span> representa os números gerados.</p></li>
</ul>
<div class="rmdimportant">
<p><span class="hl"><span class="math inline">\(P(X = x) = 0!\)</span></span></p>
<p>Como <span class="math inline">\(X\)</span> é uma variável aleatória contínua, as probabilidades
<span class="math inline">\(P(X = 1)\)</span>, <span class="math inline">\(P(X = 3{,}1416)\)</span>, ou qualquer outra probabilidade pontual
<span class="math inline">\(P(X = x)\)</span>, <span class="hl">são iguais a zero</span>!</p>
</div>
<ul>
<li>
<p>A fdp (função de densidade de probabilidade) de <span class="math inline">\(X\)</span> é</p>
<p><span class="math display">\[
  f(x) =
    \begin{cases}
      \frac{1}{10} &amp; \text{se } x \in [0, 10] \\
      0 &amp; \text{se } x \not\in [0, 10]
    \end{cases}
\]</span></p>
<p>cujo gráfico é</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-285-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
</ul>
<div class="rmdimportant">
<p><span class="hl">Densidade não é probabilidade</span>!</p>
<p>Perceba que a <span class="hl">probabilidade</span> <span class="math inline">\(P(X = 5)\)</span> é <span class="math inline">\(0\)</span>, mas a <span class="hl">densidade</span> <span class="math inline">\(f(5)\)</span> é <span class="math inline">\(1/10\)</span>.</p>
</div>
<ul>
<li>
<p>A probabilidade de um número gerado estar <span class="hl">entre <span class="math inline">\(5\)</span> e <span class="math inline">\(7\)</span></span> é de</p>
<p><span class="math display">\[
  P(5 &lt; X &lt; 7) = P(5 \leq X \leq 7) = \int_5^7 f(x)\;\text{d}x = \int_5^7 \frac{1}{10}\;\text{d}x = \frac{1}{5}
\]</span></p>
</li>
<li>
<p>O <span class="hl">valor esperado</span> de <span class="math inline">\(X\)</span> é</p>
<p><span class="math display">\[
E(X) = \int_{-\infty}^{\infty} xf(x)\;\text{d}x = \int_{0}^{10} \frac{1}{10}x\;\text{d}x = 5
\]</span></p>
</li>
<li>
<p>A <span class="hl">variância</span> de <span class="math inline">\(X\)</span> é</p>
<p><span class="math display">\[
  \sigma^2(X)
    = \int_{-\infty}^{+ \infty} (x - 5)^2 \cdot f(x)\;\text{d}x
    = \int_{0}^{10} (x-5)^2 \cdot \frac{1}{10}\;\text{d}x
    = \frac{25}{3}
    = 8{,}33
\]</span></p>
</li>
<li><p><strong>Exercício:</strong> calcule <span class="math inline">\(\sigma^2(X)\)</span> usando a fórmula <span class="math inline">\(\sigma^2(X) = E(X^2) - [E(X)]^2\)</span>.</p></li>
</ul>
</div>
<div id="no-geral-6" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> No geral<a class="anchor" aria-label="anchor" href="#no-geral-6"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Escrevemos <span class="math inline">\(X \sim \text{Unif} (a, b)\)</span>.</p></li>
<li><p>Os extremos do intervalo são <span class="math inline">\(a, b \in \mathbb{R}, a &lt; b\)</span>.</p></li>
<li><p>O <span class="hl">suporte</span> é o intervalo <span class="math inline">\([a, b]\)</span>.</p></li>
<li>
<p>A <span class="hl">função de densidade de probabilidade</span> é</p>
<p><span class="math display">\[
  f(x \mid a, b) =
    \begin{cases}
      \frac{1}{b - a} &amp; \text{se } x \in [a, b] \\
      0 &amp; \text{se } x \not\in [a, b]
    \end{cases}
\]</span></p>
</li>
<li>
<p><span class="hl">Valor esperado</span>:</p>
<p><span class="math display">\[E(X) = \frac{a+b}{2}\]</span></p>
</li>
<li>
<p><span class="hl">Variância</span>:</p>
<p><span class="math display">\[\sigma^2(X) = \frac{(a - b)^2}{12}\]</span></p>
</li>
</ul>
</div>
<div id="em-r-5" class="section level3" number="10.2.3">
<h3>
<span class="header-section-number">10.2.3</span> Em R<a class="anchor" aria-label="anchor" href="#em-r-5"><i class="fas fa-link"></i></a>
</h3>
<div id="função-de-densidade-de-probabilidade-fx-mid-a-b" class="section level4 unnumbered">
<h4>Função de densidade de probabilidade: <span class="hl"><span class="math inline">\(f(x \mid a, b)\)</span></span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-de-densidade-de-probabilidade-fx-mid-a-b"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><code>dunif(x, min = a, max = b)</code>.</p></li>
<li>
<p>No exemplo do gerador de números aleatórios em <span class="math inline">\([0, 10]\)</span>, todos os valores no intervalo têm a mesma densidade: <span class="math inline">\(\frac{1}{10}\)</span>. Valores fora do intervalo têm densidade <span class="math inline">\(0\)</span>:</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>, </span>
<span>  min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,0 0,1 0,1 0,1 0,0</code></pre>
</li>
</ul>
</div>
<div id="função-de-probabilidade-acumulada-textunifx-leq-q-mid-a-b" class="section level4 unnumbered">
<h4>Função de probabilidade acumulada: <span class="hl"><span class="math inline">\(\text{Unif}(X \leq q \mid a, b)\)</span></span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-de-probabilidade-acumulada-textunifx-leq-q-mid-a-b"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><code>punif(q, min = a, max = b)</code>.</p></li>
<li>
<p>No exemplo do gerador de números aleatórios no intervalo <span class="math inline">\([0, 10]\)</span>, qual a probabilidade de obter um número <span class="hl">menor que <span class="math inline">\(4\)</span></span>?</p>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span><span class="op">(</span><span class="fl">4</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,4</code></pre>
</li>
<li>
<p>E um número <span class="hl">maior que <span class="math inline">\(4\)</span></span>?</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span><span class="op">(</span><span class="fl">4</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,6</code></pre>
</li>
</ul>
</div>
<div id="função-quantil-dado-um-valor-de-textunifx-leq-x-mid-a-b-então-x" class="section level4 unnumbered">
<h4>Função quantil: <span class="hl">dado um valor de <span class="math inline">\(\text{Unif}(X \leq x \mid a, b)\)</span>, então <span class="math inline">\(x = ?\)</span></span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-quantil-dado-um-valor-de-textunifx-leq-x-mid-a-b-ent%C3%A3o-x"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>O objetivo é achar <span class="math inline">\(x\)</span> tal que <span class="math inline">\(\text{Unif}(X \leq x \mid a, b) = m\)</span>.</p></li>
<li><p><code>qunif(p, min = a, max = b)</code>.</p></li>
<li>
<p>No exemplo do gerador de números aleatórios no intervalo <span class="math inline">\([0, 10]\)</span>, qual o número <span class="math inline">\(x\)</span> tal que existe uma probabilidade de <span class="math inline">\(80\%\)</span> de que um número <span class="hl">menor ou igual a <span class="math inline">\(x\)</span></span> seja gerado?</p>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">qunif</a></span><span class="op">(</span><span class="fl">.8</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 8</code></pre>
</li>
<li>
<p>E qual o número <span class="math inline">\(x\)</span> tal que existe uma probabilidade de <span class="math inline">\(80\%\)</span> de que um número <span class="hl">maior ou igual a <span class="math inline">\(x\)</span></span> seja gerado?</p>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">qunif</a></span><span class="op">(</span><span class="fl">.8</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</li>
</ul>
</div>
<div id="função-para-gerar-números-aleatórios-2" class="section level4 unnumbered">
<h4>Função para <span class="hl">gerar números aleatórios</span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-para-gerar-n%C3%BAmeros-aleat%C3%B3rios-2"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><code>runif(n, min = a, max = b)</code></p></li>
<li>
<p>Os números gerados são de ponto flutuante:</p>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 8,0446404 2,7052190 8,7356228 6,3046186 4,6212423 6,1559463 3,1436863 3,0824766
##  [9] 4,0517886 0,6781619</code></pre>
</li>
<li><p><strong>Exercício:</strong> e se você quiser gerar apenas números inteiros no intervalo dado?</p></li>
<li><p><strong>Exercício:</strong> os extremos do intervalo (<code>min</code> e <code>max</code>) podem ser gerados?</p></li>
</ul>
</div>
</div>
</div>
<div id="distribuição-normal" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Distribuição normal<a class="anchor" aria-label="anchor" href="#distribui%C3%A7%C3%A3o-normal"><i class="fas fa-link"></i></a>
</h2>
<div id="exemplo-6" class="section level3" number="10.3.1">
<h3>
<span class="header-section-number">10.3.1</span> Exemplo<a class="anchor" aria-label="anchor" href="#exemplo-6"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Segundo o <a href="https://pdf4pro.com/view/levantamento-do-perfil-antropom-201-trico-10652c.html">Levantamento do Perfil Antropométrico da População Brasileira Usuária do Transporte Aéreo Nacional</a>, em 2009, a estatura do homem brasileiro adulto era distribuída normalmente, com média <span class="math inline">\(1{,}73\)</span>m e desvio-padrão <span class="math inline">\(0{,}07\)</span>m.</p></li>
<li>
<p>Segundo <a href="https://www.pearson.com/us/higher-education/product/De-Veaux-Stats-Data-and-Models-Plus-NEW-My-Lab-Statistics-with-Pearson-e-Text-Access-Card-Package-4th-Edition/9780133956498.html">este livro</a>, a estatura do homem holandês é distribuída normalmente, com média <span class="math inline">\(1{,}84\)</span>m e desvio-padrão <span class="math inline">\(0{,}08\)</span>m.</p>
<div class="sourceCode" id="cb666"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_brasil</span> <span class="op">&lt;-</span> <span class="fl">1.73</span></span>
<span><span class="va">sigma_brasil</span> <span class="op">&lt;-</span> <span class="fl">.07</span></span>
<span></span>
<span><span class="va">mu_holanda</span> <span class="op">&lt;-</span> <span class="fl">1.84</span></span>
<span><span class="va">sigma_holanda</span> <span class="op">&lt;-</span> <span class="fl">.08</span></span></code></pre></div>
</li>
<li>
<p>Gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/altura-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p><strong>Exercício:</strong> o que são os números no eixo vertical?</p></li>
<li><p>Por que a curva do Brasil é mais alta?</p></li>
</ul>
</div>
<div id="no-geral-7" class="section level3" number="10.3.2">
<h3>
<span class="header-section-number">10.3.2</span> No geral<a class="anchor" aria-label="anchor" href="#no-geral-7"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Escrevemos <span class="math inline">\(X \sim \mathcal{N}(\mu, \sigma)\)</span>.</p></li>
<li><p>O <span class="hl">valor esperado</span> é <span class="math inline">\(\mu \in \mathbb{R}\)</span>.</p></li>
<li><p>O <span class="hl">desvio-padrão</span> é <span class="math inline">\(\sigma \in \mathbb{R}_{\geq 0}\)</span>.</p></li>
<li><p>O <span class="hl">suporte</span> é o intervalo<span class="math inline">\((-\infty, \infty)\)</span>.</p></li>
<li>
<p>A <span class="hl">função de densidade de probabilidade</span> é:</p>
<p><span class="math display">\[
f(x \mid \mu, \sigma) =
\frac{1}{\sigma \sqrt{2\pi}}
  e^{-\frac{1}{2}\left(\frac{x - \mu}{\sigma}\right)^2}
\]</span></p>
</li>
</ul>
</div>
<div id="em-r-6" class="section level3" number="10.3.3">
<h3>
<span class="header-section-number">10.3.3</span> Em R<a class="anchor" aria-label="anchor" href="#em-r-6"><i class="fas fa-link"></i></a>
</h3>
<div id="função-de-densidade-de-probabilidade-fx-mid-mu-sigma" class="section level4 unnumbered">
<h4>Função de densidade de probabilidade: <span class="hl"><span class="math inline">\(f(x \mid \mu, \sigma)\)</span></span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-de-densidade-de-probabilidade-fx-mid-mu-sigma"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>dnorm(x, mean = μ, sd = σ)</code>.</li>
</ul>
</div>
<div id="função-de-probabilidade-acumulada-textnormx-leq-q-mid-mu-sigma" class="section level4 unnumbered">
<h4>Função de probabilidade acumulada: <span class="hl"><span class="math inline">\(\text{Norm}(X \leq q \mid \mu, \sigma)\)</span></span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-de-probabilidade-acumulada-textnormx-leq-q-mid-mu-sigma"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><code>pnorm(q, mean = μ, sd = σ)</code>.</p></li>
<li><p>Qual a probabilidade de um homem <span class="hl">brasileiro</span> ter <span class="hl">entre <span class="math inline">\(1{,}80\)</span>m e <span class="math inline">\(1{,}90\)</span>m de altura</span>?</p></li>
<li>
<p>Gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/entre-180-e-190-br-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Menos que <span class="math inline">\(1{,}80\)</span>m:</p>
<div class="sourceCode" id="cb667"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.80</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,8413447</code></pre>
</li>
<li>
<p>Menos que <span class="math inline">\(1{,}90\)</span>m:</p>
<div class="sourceCode" id="cb669"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.90</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,9924208</code></pre>
</li>
<li>
<p>Entre <span class="math inline">\(1{,}80\)</span>m e <span class="math inline">\(1{,}90\)</span>m:</p>
<div class="sourceCode" id="cb671"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.90</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span> <span class="op">-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.80</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,151076</code></pre>
</li>
<li><p>Qual a probabilidade de um homem <span class="hl">holandês</span> ter <span class="hl">entre <span class="math inline">\(1{,}80\)</span>m e <span class="math inline">\(1{,}90\)</span>m de altura</span>?</p></li>
<li>
<p>Gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/entre-180-e-190-ho-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Menos que <span class="math inline">\(1{,}80\)</span>m:</p>
<div class="sourceCode" id="cb673"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.80</span>, <span class="va">mu_holanda</span>, <span class="va">sigma_holanda</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,3085375</code></pre>
</li>
<li>
<p>Menos que <span class="math inline">\(1{,}90\)</span>m:</p>
<div class="sourceCode" id="cb675"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.90</span>, <span class="va">mu_holanda</span>, <span class="va">sigma_holanda</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,7733726</code></pre>
</li>
<li>
<p>Entre <span class="math inline">\(1{,}80\)</span>m e <span class="math inline">\(1{,}90\)</span>m:</p>
<div class="sourceCode" id="cb677"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.90</span>, <span class="va">mu_holanda</span>, <span class="va">sigma_holanda</span><span class="op">)</span> <span class="op">-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.80</span>, <span class="va">mu_holanda</span>, <span class="va">sigma_holanda</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,4648351</code></pre>
</li>
</ul>
</div>
<div id="função-quantil-dado-um-valor-de-textnormx-leq-x-mid-mu-sigma-então-x" class="section level4 unnumbered">
<h4>Função quantil: dado um valor de <span class="hl"><span class="math inline">\(\text{Norm}(X \leq x \mid \mu, \sigma)\)</span>, então <span class="math inline">\(x = ?\)</span></span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-quantil-dado-um-valor-de-textnormx-leq-x-mid-mu-sigma-ent%C3%A3o-x"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><code>qnorm(p, mean = μ, sd = σ)</code>.</p></li>
<li><p>Quais as <span class="hl">alturas mínima e máxima</span> dos homens que estão <span class="hl">nos <span class="math inline">\(50\%\)</span> da população em torno da média</span>?</p></li>
<li>
<p>Gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/intervalo-50-br-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>O limite <span class="hl">inferior</span> é o valor à <span class="hl">esquerda</span> do qual existem <span class="hl"><span class="math inline">\(25\%\)</span></span> de probabilidade:</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1,682786</code></pre>
</li>
<li>
<p>O limite <span class="hl">superior</span> é o valor à <span class="hl">esquerda</span> do qual existem <span class="hl"><span class="math inline">\(75\%\)</span></span> de probabilidade:</p>
<div class="sourceCode" id="cb681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1,777214</code></pre>
</li>
<li>
<p>Ou, equivalentemente, o valor à <span class="hl">direita</span> do qual existem <span class="hl"><span class="math inline">\(25\%\)</span></span> de probabilidade:</p>
<div class="sourceCode" id="cb683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1,777214</code></pre>
</li>
<li><p>As alturas mínima e máxima dos homens que estão nos <span class="math inline">\(50\%\)</span> da população em torno da média são <span class="math inline">\(1{,}68\)</span>m e <span class="math inline">\(1{,}78\)</span>m.</p></li>
</ul>
</div>
<div id="função-para-gerar-números-aleatórios-3" class="section level4 unnumbered">
<h4>Função para <span class="hl">gerar números aleatórios</span><a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%A3o-para-gerar-n%C3%BAmeros-aleat%C3%B3rios-3"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><code>rnorm(n, mean = μ, sd = σ)</code>.</p></li>
<li><p>Qual é a <span class="hl">probabilidade de um homem holandês</span> escolhido ao acaso ser <span class="hl">mais baixo</span> do que <span class="hl">um homem brasileiro</span> escolhido ao acaso?</p></li>
<li><p>Vamos responder fazendo uma simulação.</p></li>
<li>
<p>Vamos repetir muitas vezes o experimento de escolher um holandês ao acaso e um brasileiro ao acaso:</p>
<div class="sourceCode" id="cb685"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e6</span></span>
<span><span class="va">holandeses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu_holanda</span>, <span class="va">sigma_holanda</span><span class="op">)</span></span>
<span><span class="va">brasileiros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu_brasil</span>, <span class="va">sigma_brasil</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Qual a proporção de vezes em que o holandês é mais baixo?</p>
<div class="sourceCode" id="cb686"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">holandeses</span> <span class="op">&lt;</span> <span class="va">brasileiros</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,150629</code></pre>
</li>
<li><p>Segundo nossa simulação, esta é a resposta.</p></li>
</ul>
</div>
</div>
<div id="qqplots" class="section level3" number="10.3.4">
<h3>
<span class="header-section-number">10.3.4</span> <em>QQplots</em><a class="anchor" aria-label="anchor" href="#qqplots"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Como saber se um conjunto de dados numéricos segue a distribuição normal?</p></li>
<li><p>Vamos gerar dados aproximadamente normais (média <span class="math inline">\(0\)</span>, desvio-padrão <span class="math inline">\(1\)</span>):</p></li>
</ul>
<div class="sourceCode" id="cb688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">valores</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  1,1990763 -2,2858432 -0,4370087 -0,5767288 -0,8333627  1,0278603</code></pre>
<ul>
<li>Histograma:</li>
</ul>
<div class="sourceCode" id="cb690"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'valor'</span>,</span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/hist-normal-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>Para estes dados, os quartis são</li>
</ul>
<div class="sourceCode" id="cb691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">valores</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          0%         25%         50%         75%        100% 
## -3,48205150 -0,61771144  0,01948869  0,73147328  3,93829553</code></pre>
<ul>
<li>Na distribuição <span class="math inline">\(\mathcal{N}(0, 1)\)</span> teórica, os quartis seriam</li>
</ul>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]       -Inf -0,6744898  0,0000000  0,6744898        Inf</code></pre>
<ul>
<li>O gráfico QQ (quantil-quantil) mostra os quantis da amostra no eixo <span class="math inline">\(y\)</span> e os quantis teóricos no eixo <span class="math inline">\(x\)</span>. A reta vermelha serve para referência; se as duas distribuições fossem idênticas, todos os pontos estariam sobre a reta.</li>
</ul>
<div class="sourceCode" id="cb695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'amostra'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'N(0, 1)'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/qq-valores-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>Um exemplo concreto: pesos de <span class="math inline">\(15\)</span> mulheres com idades entre <span class="math inline">\(30\)</span> e <span class="math inline">\(39\)</span> anos:</li>
</ul>
<div class="sourceCode" id="cb696"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pesos</span> <span class="op">&lt;-</span> <span class="va">women</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html">transmute</a></span><span class="op">(</span>peso <span class="op">=</span> <span class="va">weight</span> <span class="op">*</span> <span class="fl">.4535924</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Histograma:</li>
</ul>
<div class="sourceCode" id="cb697"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pesos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">peso</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/hist-pesos-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>O gráfico quantil-quantil fica</li>
</ul>
<div class="sourceCode" id="cb698"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pesos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'pesos'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'N(0, 1)'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/pesos-qq-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li><p>Quanto mais próximos de uma reta com inclinação de <span class="math inline">\(45\)</span> graus os pontos ficarem, mais próximos da distribuição normal os dados estão.</p></li>
<li><p>Podemos usar, como distribuição teórica no eixo <span class="math inline">\(x\)</span>, a distribuição normal com média e desvio-padrão iguais à média e ao desvio-padrão dos dados:</p></li>
</ul>
<div class="sourceCode" id="cb699"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pesos</span><span class="op">$</span><span class="va">peso</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">pesos</span><span class="op">$</span><span class="va">peso</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pesos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span></span>
<span>      dparams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        mean <span class="op">=</span> <span class="va">m</span>,</span>
<span>        sd <span class="op">=</span> <span class="va">s</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'pesos'</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'N('</span>, <span class="va">m</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">' ; '</span>, <span class="va">s</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">')'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/pesos-qq-nao-padrao-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li><p>Ou podemos padronizar os dados no eixo <span class="math inline">\(y\)</span>, fazendo com que a média deles seja <span class="math inline">\(0\)</span> e o desvio-padrão deles seja <span class="math inline">\(1\)</span>.</p></li>
<li><p>Para fazer isso manualmente, basta subtrair a média e dividir pelo desvio-padrão:</p></li>
</ul>
<div class="sourceCode" id="cb700"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pesos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peso <span class="op">=</span> <span class="op">(</span><span class="va">peso</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span></span>
<span>    format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">'.'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_paper</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'striped'</span>, <span class="st">'hover'</span><span class="op">)</span>,</span>
<span>    full_width <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class=" lightable-paper lightable-striped lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:right;">
peso
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-1,4022687
</td>
</tr>
<tr>
<td style="text-align:right;">
-1,2732255
</td>
</tr>
<tr>
<td style="text-align:right;">
-1,0796608
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,8860962
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,6925315
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,4989668
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,3054021
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,1118374
</td>
</tr>
<tr>
<td style="text-align:right;">
0,1462489
</td>
</tr>
<tr>
<td style="text-align:right;">
0,3398136
</td>
</tr>
<tr>
<td style="text-align:right;">
0,5978998
</td>
</tr>
<tr>
<td style="text-align:right;">
0,8559861
</td>
</tr>
<tr>
<td style="text-align:right;">
1,1140723
</td>
</tr>
<tr>
<td style="text-align:right;">
1,4366802
</td>
</tr>
<tr>
<td style="text-align:right;">
1,7592880
</td>
</tr>
</tbody>
</table></div>
<ul>
<li>Ou podemos usar a função <code>scale</code>, que faz o mesmo:</li>
</ul>
<div class="sourceCode" id="cb701"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pesos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span></span>
<span>    format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">'.'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_paper</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'striped'</span>, <span class="st">'hover'</span><span class="op">)</span>,</span>
<span>    full_width <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class=" lightable-paper lightable-striped lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:right;">
peso
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-1,4022687
</td>
</tr>
<tr>
<td style="text-align:right;">
-1,2732255
</td>
</tr>
<tr>
<td style="text-align:right;">
-1,0796608
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,8860962
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,6925315
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,4989668
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,3054021
</td>
</tr>
<tr>
<td style="text-align:right;">
-0,1118374
</td>
</tr>
<tr>
<td style="text-align:right;">
0,1462489
</td>
</tr>
<tr>
<td style="text-align:right;">
0,3398136
</td>
</tr>
<tr>
<td style="text-align:right;">
0,5978998
</td>
</tr>
<tr>
<td style="text-align:right;">
0,8559861
</td>
</tr>
<tr>
<td style="text-align:right;">
1,1140723
</td>
</tr>
<tr>
<td style="text-align:right;">
1,4366802
</td>
</tr>
<tr>
<td style="text-align:right;">
1,7592880
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb702"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pesos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'pesos\n(padronizados)'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'N(0, 1)'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/pesos-qq-padrao-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>Um exemplo de dados não normais:</li>
</ul>
<div class="sourceCode" id="cb703"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">100</span>, rate <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Histograma:</li>
</ul>
<div class="sourceCode" id="cb704"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'valor'</span>,</span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/hist-nao-normal-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>QQ:</li>
</ul>
<div class="sourceCode" id="cb705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span></span>
<span>      dparams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        mean <span class="op">=</span> <span class="va">m</span>,</span>
<span>        sd <span class="op">=</span> <span class="va">s</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'dados'</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'N('</span>, <span class="va">m</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">' ; '</span>, <span class="va">s</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">')'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/qq-nao-normal-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>
<strong>Exercício</strong>: gere um gráfico quantil-quantil para estes dados, usando a distribuição exponencial com média <span class="math inline">\(10\)</span> como distribuição teórica no eixo <span class="math inline">\(x\)</span>.</li>
</ul>
</div>
<div id="aproximação-da-binomial-pela-normal" class="section level3" number="10.3.5">
<h3>
<span class="header-section-number">10.3.5</span> Aproximação da binomial pela normal<a class="anchor" aria-label="anchor" href="#aproxima%C3%A7%C3%A3o-da-binomial-pela-normal"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>Exemplo:</p>
<ul>
<li><p>Uma organização vai receber sangue de <span class="math inline">\(32\)</span> mil doadores escolhidos ao acaso.</p></li>
<li><p>A probabilidade de um doador ter sangue tipo O- é <span class="math inline">\(p = 0{,}06\)</span>.</p></li>
<li><p>Qual a probabilidade de a organização conseguir no mínimo <span class="math inline">\(1.850\)</span> doadores com sangue do tipo O-?</p></li>
</ul>
</li>
<li><p>Cada doador é uma prova de Bernoulli, com probabilidade de sucesso <span class="math inline">\(p = 0{,}06\)</span>. Supondo que os doadores são independentes (por exemplo, não são todos parentes) e usando a distribuição binomial, a resposta é
<span class="math display">\[
\text{Binom}(X \geq 1850 \mid n = 32000, p = 0.06)
\]</span></p></li>
<li><p>Em R</p></li>
</ul>
<div class="sourceCode" id="cb706"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span></span>
<span>  q <span class="op">=</span> <span class="fl">1849</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">32000</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.06</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,9521106</code></pre>
<ul>
<li><p>Este resultado é o valor da longa e trabalhosa expressão
<span class="math display">\[
{32000 \choose 1850} 0{,}06^{1850} 0{,}94^{30150} +
{32000 \choose 1851} 0{,}06^{1851} 0{,}94^{30149} + \cdots +
{32000 \choose 32000} 0{,}06^{32000} 0{,}94^{0}
\]</span></p></li>
<li>
<p>Felizmente, podemos usar a distribuição normal para achar uma aproximação:</p>
<ul>
<li><p>A média da distribuição binomial é <span class="math inline">\(np = 32.000 \cdot 0{,}06 = 1920\)</span>.</p></li>
<li><p>O desvio-padrão da distribuição binomial é <span class="math inline">\(\sqrt{np(1-p)} \approx 42{,}48\)</span>.</p></li>
<li><p>Usando uma normal com esta média e este desvio-padrão, temos</p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb708"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span></span>
<span>  q <span class="op">=</span> <span class="fl">1849</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">1920</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">42.48</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,9526762</code></pre>
<ul>
<li>As distribuições são mesmo parecidas:</li>
</ul>
<div class="inline-figure"><img src="_main_files/figure-html/normal-binom-plot-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>Mas nem toda binomial se parece com uma normal:</li>
</ul>
<div class="sourceCode" id="cb710"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">.1</span></span>
<span><span class="fu">normal_binom</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, limites <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/normal-binomial-plot-ruim-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li>Neste exemplo, quanto da probabilidade da normal está em valores abaixo de <span class="math inline">\(-0.5\)</span> (valores que não fazem sentido para a binomial!)?</li>
</ul>
<div class="sourceCode" id="cb711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="va">n</span> <span class="op">*</span> <span class="va">p</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,06801856</code></pre>
<ul>
<li><p>Como resolver isto?</p></li>
<li><p>Lembrando que <span class="math inline">\(99{,}7\%\)</span> da probabilidade da distribuição normal está a <span class="math inline">\(3\)</span> desvios-padrão de distância da média, podemos exigir que a distribuição binomial esteja dentro destes limites.</p></li>
<li><p>Então, a normal deve ser <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span> tal que o intervalo de <span class="math inline">\(\mu - 3\sigma\)</span> até <span class="math inline">\(\mu + 3\sigma\)</span> só tenha valores positivos.</p></li>
<li><p>Ou seja, queremos <span class="math display">\[\mu - 3\sigma &gt; 0\]</span></p></li>
<li><p>O que equivale a <span class="math display">\[\mu &gt; 3\sigma\]</span></p></li>
<li><p>Como a normal é calculada a partir de <span class="math inline">\(\text{Binom}(X \mid n, p)\)</span>, isto equivale a
<span class="math display">\[
np &gt; 3 \sqrt{np(1-p)}
\]</span></p></li>
<li><p>Elevando os dois lados ao quadrado: <span class="math display">\[n^2p^2 &gt; 9np(1-p)\]</span></p></li>
<li><p>Dividindo ambos os lados por <span class="math inline">\(np\)</span> (que é positivo): <span class="math display">\[np &gt; 9(1-p)\]</span></p></li>
<li><p>Como <span class="math inline">\((1-p) \leq 1\)</span>, podemos nos satisfazer com <span class="math display">\[np &gt; 9\]</span></p></li>
<li>
<p><strong>Conclusão:</strong></p>
<ul>
<li><p>Para aproximar a binomial <span class="math inline">\(\text{Binom}(X \mid n, p)\)</span> por uma normal, exigimos que <span class="math inline">\(np\)</span> seja pelo menos <span class="math inline">\(10\)</span>.</p></li>
<li><p>Como a normal é simétrica, também exigimos que <span class="math inline">\(n(1-p)\)</span> também seja pelo menos <span class="math inline">\(10\)</span>.</p></li>
<li><p>Em outras palavras, o número esperado de sucessos e o número esperado de fracassos precisam ser, ambos, maiores ou iguais a <span class="math inline">\(10\)</span>.</p></li>
</ul>
</li>
</ul>
</div>
<div id="correção-de-continuidade" class="section level3" number="10.3.6">
<h3>
<span class="header-section-number">10.3.6</span> Correção de continuidade<a class="anchor" aria-label="anchor" href="#corre%C3%A7%C3%A3o-de-continuidade"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>E se, no exemplo dos doadores de sangue, quiséssemos calcular a probabilidade de a organização obter <em>exatamente</em> <span class="math inline">\(1.850\)</span> doadores com sangue O-?</li>
</ul>
<div class="sourceCode" id="cb713"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">1850</span>, <span class="fl">32000</span>, <span class="fl">.06</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,002420205</code></pre>
<ul>
<li><p>Usando a aproximação normal, como calcularíamos esta probabilidade? Como a normal é uma distribuição contínua, <span class="math inline">\(P(X = 1850)\)</span> é igual a zero (como qualquer probabilidade pontual)!</p></li>
<li><p>A solução é calcular <span class="math inline">\(P(1849{,}5 \leq X \leq 1850{,}5)\)</span>:</p></li>
</ul>
<div class="sourceCode" id="cb715"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1849.5</span>, <span class="fl">1850.5</span><span class="op">)</span>, </span>
<span>  mean <span class="op">=</span> <span class="fl">32000</span> <span class="op">*</span> <span class="fl">0.06</span>,  </span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">32000</span> <span class="op">*</span> <span class="fl">0.06</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.06</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">probs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 0,002416361</code></pre>
<ul>
<li>Trabalhando com uma distribuição <span class="math inline">\(\text{Binom}(X \mid n = 20, p = 0{,}5)\)</span>, isto fica claro no gráfico. Cada barra centrada no valor <span class="math inline">\(x\)</span> compreende uma região de <span class="math inline">\(x - 0{,}5\)</span> até <span class="math inline">\(x + 0{,}5\)</span>:</li>
</ul>
<div class="inline-figure"><img src="_main_files/figure-html/correcao-cont-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="exponencial" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Exponencial<a class="anchor" aria-label="anchor" href="#exponencial"><i class="fas fa-link"></i></a>
</h2>
<div id="exemplo-7" class="section level3" number="10.4.1">
<h3>
<span class="header-section-number">10.4.1</span> Exemplo<a class="anchor" aria-label="anchor" href="#exemplo-7"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Lembre-se de que a distribuição de Poisson modela o número de ocorrências de um fenômeno que tem uma média de <span class="math inline">\(\lambda\)</span> ocorrências por período de tempo.</p></li>
<li><p>Imagine que o números de visitas por minuto à sua página web é <span class="math inline">\(\lambda = 4\)</span>.</p></li>
<li><p>Então, o <em>tempo</em> entre visitas é uma variável aleatória contínua <span class="math inline">\(X\)</span>, que pode ser modelada pela distribuição exponencial com média <span class="math inline">\(1/\lambda = 1/4 = 0{,}25\)</span>.</p></li>
<li><p>Qual a probabilidade de que o tempo entre uma visita e a próxima seja menor do que <span class="math inline">\(0{,}33\)</span> minuto?
<span class="math display">\[
\begin{aligned}
P(X \leq 0{,}33 \mid \lambda = 4)
  &amp;= \int_0^{0{,}33} \lambda e^{-\lambda \cdot 0{,}33} dx \\
  &amp;= 1 - e^{-\lambda \cdot 0{,}33} \\
  &amp;= 1 - e^{-1{,}32} \\
  &amp;\approx 0{,}73
\end{aligned}
\]</span></p></li>
</ul>
</div>
<div id="no-geral-8" class="section level3" number="10.4.2">
<h3>
<span class="header-section-number">10.4.2</span> No geral<a class="anchor" aria-label="anchor" href="#no-geral-8"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><span class="math inline">\(X \sim \text{Exp}(\lambda)\)</span></p></li>
<li><p>Média: <span class="math inline">\(1/\lambda\)</span></p></li>
<li><p>Desvio padrão: <span class="math inline">\(1/\lambda^2\)</span></p></li>
<li><p>Suporte: <span class="math inline">\([0, \infty)\)</span></p></li>
<li><p>Fdp:
<span class="math display">\[
f(x \mid \lambda) = \lambda e^{-\lambda x}
\]</span></p></li>
</ul>
</div>
<div id="em-r-7" class="section level3" number="10.4.3">
<h3>
<span class="header-section-number">10.4.3</span> Em R<a class="anchor" aria-label="anchor" href="#em-r-7"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Densidade: <code>dexp(x, rate = 1)</code></p></li>
<li><p>Probabilidade acumulada: <code>pexp(q, rate = 1, lower.tail = TRUE)</code></p></li>
<li><p>Quantil: <code>qexp(p, rate = 1, lower.tail = TRUE)</code></p></li>
<li><p>Geração de números aleatórios: <code>rexp(n, rate = 1)</code></p></li>
</ul>
</div>
</div>
<div id="outras-distribuições-contínuas-importantes" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Outras distribuições contínuas importantes<a class="anchor" aria-label="anchor" href="#outras-distribui%C3%A7%C3%B5es-cont%C3%ADnuas-importantes"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Distribuição <span class="math inline">\(t\)</span> de Student</p></li>
<li><p>Distribuição <span class="math inline">\(\chi^2\)</span></p></li>
<li><p>Distribuição <span class="math inline">\(F\)</span></p></li>
</ul>
</div>
<div id="jardim-zoológico-de-distribuições-1" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Jardim zoológico de distribuições<a class="anchor" aria-label="anchor" href="#jardim-zool%C3%B3gico-de-distribui%C3%A7%C3%B5es-1"><i class="fas fa-link"></i></a>
</h2>
<p>Para sua diversão: <a href="https://ben18785.shinyapps.io/distribution-zoo/" class="uri">https://ben18785.shinyapps.io/distribution-zoo/</a></p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

init_exercises = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

$(init_exercises)

</script><div class="chapter-nav">
<div class="prev"><a href="discretas.html"><span class="header-section-number">9</span> Distribuições discretas</a></div>
<div class="next"><a href="tcl.html"><span class="header-section-number">11</span> Teorema central do limite</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta página"><h2>Nesta página</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#distribui%C3%A7%C3%B5es-cont%C3%ADnuas"><span class="header-section-number">10</span> Distribuições contínuas</a></li>
<li><a class="nav-link" href="#v%C3%ADdeo-4"><span class="header-section-number">10.1</span> Vídeo</a></li>
<li>
<a class="nav-link" href="#distribui%C3%A7%C3%A3o-uniforme-1"><span class="header-section-number">10.2</span> Distribuição uniforme</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exemplo-gerador-de-n%C3%BAmeros-aleat%C3%B3rios"><span class="header-section-number">10.2.1</span> Exemplo: gerador de números aleatórios</a></li>
<li><a class="nav-link" href="#no-geral-6"><span class="header-section-number">10.2.2</span> No geral</a></li>
<li><a class="nav-link" href="#em-r-5"><span class="header-section-number">10.2.3</span> Em R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#distribui%C3%A7%C3%A3o-normal"><span class="header-section-number">10.3</span> Distribuição normal</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exemplo-6"><span class="header-section-number">10.3.1</span> Exemplo</a></li>
<li><a class="nav-link" href="#no-geral-7"><span class="header-section-number">10.3.2</span> No geral</a></li>
<li><a class="nav-link" href="#em-r-6"><span class="header-section-number">10.3.3</span> Em R</a></li>
<li><a class="nav-link" href="#qqplots"><span class="header-section-number">10.3.4</span> QQplots</a></li>
<li><a class="nav-link" href="#aproxima%C3%A7%C3%A3o-da-binomial-pela-normal"><span class="header-section-number">10.3.5</span> Aproximação da binomial pela normal</a></li>
<li><a class="nav-link" href="#corre%C3%A7%C3%A3o-de-continuidade"><span class="header-section-number">10.3.6</span> Correção de continuidade</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exponencial"><span class="header-section-number">10.4</span> Exponencial</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exemplo-7"><span class="header-section-number">10.4.1</span> Exemplo</a></li>
<li><a class="nav-link" href="#no-geral-8"><span class="header-section-number">10.4.2</span> No geral</a></li>
<li><a class="nav-link" href="#em-r-7"><span class="header-section-number">10.4.3</span> Em R</a></li>
</ul>
</li>
<li><a class="nav-link" href="#outras-distribui%C3%A7%C3%B5es-cont%C3%ADnuas-importantes"><span class="header-section-number">10.5</span> Outras distribuições contínuas importantes</a></li>
<li><a class="nav-link" href="#jardim-zool%C3%B3gico-de-distribui%C3%A7%C3%B5es-1"><span class="header-section-number">10.6</span> Jardim zoológico de distribuições</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/fnaufel/probestr/blob/master/distribs-continuas.Rmd">Ver código-fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/fnaufel/probestr/edit/master/distribs-continuas.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Probabilidade e Estatística com R</strong>" por Fernando Náufel (versão de 03/11/2023)</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Criado com o <a class="text-light" href="https://bookdown.org">pacote bookdown</a> do R.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
