<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 15 Regressão linear | Probabilidade e Estatística com R</title>
<meta name="author" content="Fernando Náufel">
<meta name="description" content="15.1 Vídeo    15.2 Exemplo: altura e peso  Pessoas mais altas tendem a ser mais pesadas? Temos dados de \(68\) pessoas, com alturas em cm e pesos em kg: ...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Capítulo 15 Regressão linear | Probabilidade e Estatística com R">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/640px-Nightingale-mortality.jpg">
<meta property="og:description" content="15.1 Vídeo    15.2 Exemplo: altura e peso  Pessoas mais altas tendem a ser mais pesadas? Temos dados de \(68\) pessoas, com alturas em cm e pesos em kg: ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 15 Regressão linear | Probabilidade e Estatística com R">
<meta name="twitter:description" content="15.1 Vídeo    15.2 Exemplo: altura e peso  Pessoas mais altas tendem a ser mais pesadas? Temos dados de \(68\) pessoas, com alturas em cm e pesos em kg: ...">
<meta name="twitter:image" content="/images/640px-Nightingale-mortality.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lexend-0.4.7/font.css" rel="stylesheet">
<link href="libs/JetBrains_Mono-0.4.7/font.css" rel="stylesheet">
<link href="libs/Roboto-0.4.7/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="html_files/alterar_detalhes.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="html_files/styles_all.css">
<link rel="stylesheet" href="html_files/styles_book.css">
<link rel="stylesheet" href="html_files/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Ir para conteúdo principal</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Probabilidade e Estatística com R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Mostrar sumário</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Conteúdo"><h2>Conteúdo</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Apresentação</a></li>
<li><a class="" href="oque.html"><span class="header-section-number">1</span> O que é estatística?</a></li>
<li><a class="" href="rintro.html"><span class="header-section-number">2</span> Introdução a R</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-ao-tidyverse.html"><span class="header-section-number">3</span> Introdução ao tidyverse</a></li>
<li><a class="" href="viz.html"><span class="header-section-number">4</span> Visualização com ggplot2</a></li>
<li><a class="" href="viz2.html"><span class="header-section-number">5</span> Visualização com ggplot2 (continuação)</a></li>
<li><a class="" href="medidas.html"><span class="header-section-number">6</span> Medidas</a></li>
<li><a class="" href="probs.html"><span class="header-section-number">7</span> Probabilidades</a></li>
<li><a class="" href="variaveis.html"><span class="header-section-number">8</span> Variáveis aleatórias</a></li>
<li><a class="" href="discretas.html"><span class="header-section-number">9</span> Distribuições discretas</a></li>
<li><a class="" href="distribui%C3%A7%C3%B5es-cont%C3%ADnuas.html"><span class="header-section-number">10</span> Distribuições contínuas</a></li>
<li><a class="" href="tcl.html"><span class="header-section-number">11</span> Teorema central do limite</a></li>
<li><a class="" href="ic.html"><span class="header-section-number">12</span> Intervalos de confiança</a></li>
<li><a class="" href="th.html"><span class="header-section-number">13</span> Testes de hipóteses</a></li>
<li><a class="" href="corr.html"><span class="header-section-number">14</span> Covariância e correlação</a></li>
<li><a class="active" href="regr.html"><span class="header-section-number">15</span> Regressão linear</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/fnaufel/probestr">Ver código-fonte do livro <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="regr" class="section level1" number="15">
<h1>
<span class="header-section-number">Capítulo 15</span> Regressão linear<a class="anchor" aria-label="anchor" href="#regr"><i class="fas fa-link"></i></a>
</h1>
<div id="vídeo-7" class="section level2" number="15.1">
<h2>
<span class="header-section-number">15.1</span> Vídeo<a class="anchor" aria-label="anchor" href="#v%C3%ADdeo-7"><i class="fas fa-link"></i></a>
</h2>
<iframe src="https://www.youtube.com/embed/diUFBf0JUC4" width="100%" height="400px" data-external="1" class="center" style="width: 80%;">
</iframe>
</div>
<div id="exemplo-altura-e-peso-1" class="section level2" number="15.2">
<h2>
<span class="header-section-number">15.2</span> Exemplo: altura e peso<a class="anchor" aria-label="anchor" href="#exemplo-altura-e-peso-1"><i class="fas fa-link"></i></a>
</h2>
<div class="rmdbox">
<p>Pessoas mais altas tendem a ser mais pesadas?</p>
<p>Temos dados de <span class="math inline">\(68\)</span> pessoas, com alturas em cm e pesos em kg:</p>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["altura"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["peso"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"162,56","2":"49,50"},{"1":"160,02","2":"55,35"},{"1":"180,34","2":"60,30"},{"1":"162,56","2":"58,05"},{"1":"157,48","2":"58,05"},{"1":"165,10","2":"55,35"},{"1":"163,83","2":"51,75"},{"1":"173,99","2":"54,90"},{"1":"166,37","2":"54,00"},{"1":"162,56","2":"49,95"},{"1":"162,56","2":"51,75"},{"1":"160,02","2":"52,65"},{"1":"157,48","2":"48,15"},{"1":"190,50","2":"76,50"},{"1":"154,94","2":"40,95"},{"1":"157,48","2":"53,10"},{"1":"160,02","2":"58,50"},{"1":"167,64","2":"60,75"},{"1":"160,02","2":"54,00"},{"1":"170,18","2":"56,25"},{"1":"170,18","2":"52,65"},{"1":"162,56","2":"60,75"},{"1":"154,94","2":"39,60"},{"1":"170,18","2":"58,50"},{"1":"157,48","2":"67,50"},{"1":"167,64","2":"58,50"},{"1":"175,26","2":"67,50"},{"1":"177,80","2":"72,00"},{"1":"162,56","2":"54,00"},{"1":"172,72","2":"56,70"},{"1":"175,26","2":"58,50"},{"1":"172,72","2":"63,00"},{"1":"162,56","2":"81,00"},{"1":"172,72","2":"60,75"},{"1":"172,72","2":"65,25"},{"1":"157,48","2":"58,50"},{"1":"167,64","2":"67,50"},{"1":"172,72","2":"67,50"},{"1":"167,64","2":"51,75"},{"1":"177,80","2":"63,00"},{"1":"167,64","2":"83,25"},{"1":"167,64","2":"49,50"},{"1":"177,80","2":"58,50"},{"1":"162,56","2":"56,25"},{"1":"170,18","2":"65,25"},{"1":"160,02","2":"47,25"},{"1":"154,94","2":"54,00"},{"1":"165,10","2":"65,25"},{"1":"195,58","2":"83,25"},{"1":"180,34","2":"77,40"},{"1":"162,56","2":"58,50"},{"1":"167,64","2":"69,75"},{"1":"177,80","2":"67,50"},{"1":"185,42","2":"78,75"},{"1":"182,88","2":"73,80"},{"1":"185,42","2":"94,50"},{"1":"182,88","2":"67,50"},{"1":"182,88","2":"63,00"},{"1":"182,88","2":"72,00"},{"1":"175,26","2":"65,25"},{"1":"187,96","2":"83,25"},{"1":"170,18","2":"54,00"},{"1":"180,34","2":"123,75"},{"1":"177,80","2":"76,50"},{"1":"180,34","2":"67,50"},{"1":"170,18","2":"67,50"},{"1":"180,34","2":"90,00"},{"1":"180,34","2":"65,25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<ul>
<li>
<p>O gráfico de dispersão (<em>scatter plot</em>) é o ideal para visualizar a correlação entre duas variáveis numéricas:</p>
<div class="sourceCode" id="cb890"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grafico_pa</span> <span class="op">&lt;-</span> <span class="va">peso_altura</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">altura</span>, <span class="va">peso</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'altura (cm)'</span>,</span>
<span>      y <span class="op">=</span> <span class="st">'peso\n(kg)'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">200</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grafico_pa</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-435-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Podemos pedir ao R para traçar <span class="hl">uma reta resumindo a variação do peso em função da altura</span>:</p>
<div class="sourceCode" id="cb891"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regressao</span> <span class="op">&lt;-</span> <span class="va">grafico_pa</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regressao</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-436-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Esta é a <span class="hl">reta de regressão</span>, ou <span class="hl">reta de melhor ajuste</span>.</p></li>
<li>
<p>Se tivermos a equação desta reta, podemos</p>
<ol style="list-style-type: decimal">
<li><p><span class="hl">Explicar</span> como o peso varia de acordo com a altura.</p></li>
<li><p><span class="hl">Prever</span> o peso de pessoas cujas alturas conhecemos, mas que não estavam nos dados originais.</p></li>
</ol>
</li>
<li><p>A equação da reta vai ser da forma
<span class="math inline">\(\quad\)</span> <span class="hl"><span class="math inline">\(\widehat{\text{peso}}(x) = \widehat{b_0} + \widehat{b_1} \cdot \text{altura}(x)\)</span>.</span></p></li>
<li><p>Os “chapéus” em <span class="math inline">\(\widehat{\text{peso}}\)</span>, <span class="math inline">\(\widehat{b_0}\)</span>, e em <span class="math inline">\(\widehat{b_1}\)</span> significam que os valores são <span class="hl">estimativas</span> (baseadas na amostra), e não os valores verdadeiros da população.</p></li>
<li><p>Neste exemplo, a equação da reta é <span class="math inline">\(\quad\)</span>
<span class="hl"><span class="math inline">\(\widehat{\text{peso}}(x) = -89{,}81 + 0{,}90 \cdot \text{altura}(x)\)</span>.</span></p></li>
<li>
<p>Dando nomes às coisas:</p>
<ul>
<li><p>Neste exemplo, altura é o <span class="hl">preditor</span>.</p></li>
<li><p>Neste exemplo, peso é a <span class="hl">variável de resposta</span>.</p></li>
<li><p>O <span class="hl">intercepto</span> é o valor de <span class="math inline">\(\widehat{b_0} = -89{,}81\)</span>. Neste exemplo, corresponderia ao peso de uma pessoa com altura zero! Claro que isto não faz sentido na realidade física, mas é um valor que faz parte da definição da reta. <span class="hl">Aliás, serve como aviso de que a reta de regressão só faz sentido dentro da faixa de valores dos dados que temos.</span></p></li>
<li><p>A <span class="hl">inclinação</span> é o valor de <span class="math inline">\(\widehat{b_1} = 0{,}90\)</span>. Neste exemplo, significa que um aumento de <span class="math inline">\(1\)</span>cm na altura corresponde a um aumento de <span class="math inline">\(0{,}90\)</span>kg no peso.</p></li>
<li>
<p>O <span class="hl">resíduo</span> de um indivíduo <span class="math inline">\(x\)</span> do conjunto de dados é a <span class="hl">diferença entre o peso verdadeiro</span> de <span class="math inline">\(x\)</span> e o <span class="hl">peso estimado</span> para <span class="math inline">\(x\)</span> pela equação.</p>
<p>Por exemplo, para as duas pessoas com altura próxima a <span class="math inline">\(1{,}65\)</span>m:</p>
<table class=" lightable-paper lightable-striped lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:right;">
<p>altura</p>
</th>
<th style="text-align:right;">
<p>peso</p>
</th>
<th style="text-align:right;">
<p>peso_estimado</p>
</th>
<th style="text-align:right;">
<p>resíduo</p>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
<p>165,1</p>
</td>
<td style="text-align:right;">
<p>55,35</p>
</td>
<td style="text-align:right;">
<p>58,78</p>
</td>
<td style="text-align:right;">
<p>-3,43</p>
</td>
</tr>
<tr>
<td style="text-align:right;">
<p>165,1</p>
</td>
<td style="text-align:right;">
<p>65,25</p>
</td>
<td style="text-align:right;">
<p>58,78</p>
</td>
<td style="text-align:right;">
<p>6,47</p>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div id="como-achar-a-equação-da-melhor-reta-com-cálculo" class="section level2" number="15.3">
<h2>
<span class="header-section-number">15.3</span> Como achar a equação da melhor reta? Com Cálculo!<a class="anchor" aria-label="anchor" href="#como-achar-a-equa%C3%A7%C3%A3o-da-melhor-reta-com-c%C3%A1lculo"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Qual reta queremos? A que deixe <span class="hl">o mínimo possível de resíduos</span>, de certa forma.</p></li>
<li><p>Mas, em vez de considerar os resíduos, que podem ser negativos ou positivos, vamos considerar os <span class="hl">quadrados dos resíduos</span>, mais ou menos como no <a href="medidas.html#vari%C3%A2ncia">cálculo da variância</a>.</p></li>
<li>
<p>Então, para cada indivíduo <span class="math inline">\(x_i\)</span>, calculamos o resíduo e elevamos ao quadrado; depois, somamos tudo:</p>
<p><span class="math display">\[
S = \sum_i \left[\text{peso}(x_i) - \widehat{\text{peso}}(x_i)\right]^2
\]</span></p>
</li>
<li><p>Esta soma <span class="math inline">\(S\)</span> é a quantidade que queremos minimizar: <span class="hl">a soma dos quadrados dos resíduos</span>.</p></li>
<li>
<p>Eis alguns exemplos de retas diferentes, com seus respectivos valores de S:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-439-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Mas lembre-se de que <span class="math inline">\(\widehat{peso}(x_i) = \widehat{b_0} + \widehat{b_1} \cdot \text{altura}(x_i)\)</span>.</p></li>
<li>
<p>Então, a soma fica</p>
<p><span class="math display">\[
S = \sum_i \left[\;\text{peso}(x_i) - (\widehat{b_0} + \widehat{b_1} \cdot \text{altura}(x_i))\;\right]^2
\]</span></p>
</li>
<li><p>No fim das contas, <span class="hl"><span class="math inline">\(S\)</span> é uma função de duas variáveis: <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span></span> (lembre-se de que os pesos e alturas das pessoas são conhecidos).</p></li>
<li><p>Podemos usar as ferramentas do Cálculo para achar os <span class="hl">valores de <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span> que minimizam esta função.</span></p></li>
<li>
<p>Vamos um passo de cada vez.</p>
<p>Vamos <span class="hl">abreviar “<span class="math inline">\(\text{peso}(x_i)\)</span>” como <span class="math inline">\(x_i\)</span></span> e <span class="hl">“<span class="math inline">\(\text{altura}(x_i)\)</span>” como <span class="math inline">\(y_i\)</span></span>, só para escrever menos.</p>
<p>Para lembrarmos que <span class="math inline">\(S\)</span> é uma função de <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span>, vamos escrever <span class="math inline">\(S\left(\widehat{b_0}, \widehat{b_1}\right)\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
  S\left(\widehat{b_0}, \widehat{b_1}\right) &amp;=
  \sum_i
  \left[\;y_i -
  (\widehat{b_0} +
  \widehat{b_1} x_i)
  \;\right]^2
\end{align*}
\]</span></p>
</li>
<li>
<p>Desenvolvendo o quadrado:</p>
<p><span class="math display">\[
\begin{align*}
  S\left(\widehat{b_0}, \widehat{b_1}\right) &amp;=
  \sum_i
  \left[\;
  y_i^2 -
  2y_i(\widehat{b_0} + \widehat{b_1}x_i)
  + (\widehat{b_0} + \widehat{b_1}x_i)^2
  \;\right]
\end{align*}
\]</span></p>
</li>
<li>
<p>Desenvolvendo o quadrado na última parcela:</p>
<p><span class="math display">\[
\begin{align*}
  S\left(\widehat{b_0}, \widehat{b_1}\right) &amp;=
  \sum_i
  \left[\;
  y_i^2 -
  2y_i(\widehat{b_0} + \widehat{b_1}x_i)
  + \widehat{b_0}^2 +
  2\widehat{b_0}\widehat{b_1}x_i +
  \widehat{b_1}^2x_i^2
  \;\right]
\end{align*}
\]</span></p>
</li>
<li>
<p>Desenvolvendo a parte com parênteses:</p>
<p><span class="math display">\[
\begin{align*}
  S\left(\widehat{b_0}, \widehat{b_1}\right) &amp;=
  \sum_i
  \left[\;
  y_i^2 -
  2y_i\widehat{b_0} -
  2y_i\widehat{b_1}x_i +
  \widehat{b_0}^2 +
  2\widehat{b_0}\widehat{b_1}x_i +
  \widehat{b_1}^2x_i^2
  \;\right]
\end{align*}
\]</span></p>
</li>
<li>
<p>Separando os somatórios:</p>
<p><span class="math display">\[
\begin{align*}
  S\left(\widehat{b_0}, \widehat{b_1}\right) &amp;=
  \sum_i y_i^2 -
  \sum_i 2y_i\widehat{b_0} -
  \sum_i 2y_i\widehat{b_1}x_i +
  \sum_i \widehat{b_0}^2 +
  \sum_i 2\widehat{b_0}\widehat{b_1}x_i +
  \sum_i \widehat{b_1}^2x_i^2
\end{align*}
\]</span></p>
</li>
<li>
<p>Jogando tudo que não depende de <span class="math inline">\(i\)</span> para fora dos somatórios.</p>
<p>Além disso, <span class="math inline">\(\sum_i \widehat{b_0}^2\)</span> é simplesmente <span class="math inline">\(n\widehat{b_0}^2\)</span>, onde <span class="math inline">\(n\)</span> é o total de pessoas.</p>
<p><span class="math display">\[
\begin{align*}
  S\left(\widehat{b_0}, \widehat{b_1}\right) &amp;=
  \sum_i y_i^2 -
  2\widehat{b_0}\sum_i y_i -
  2\widehat{b_1}\sum_i x_iy_i +
  n\widehat{b_0}^2 +
  2\widehat{b_0}\widehat{b_1}\sum_i x_i +
  \widehat{b_1}^2\sum_i x_i^2
\end{align*}
\]</span></p>
</li>
<li>
<p>Pronto. Agora vamos achar as <span class="hl">derivadas parciais desta função</span>:</p>
<p><span class="math display">\[
\begin{align*}
\frac{\partial S}{\partial \widehat{b_0}} &amp;=
-2\sum_i y_i + 2n\widehat{b_0} + 2\widehat{b_1}\sum_i x_i \\
\\
\frac{\partial S}{\partial \widehat{b_1}} &amp;=
-2\sum_i x_i y_i + 2\widehat{b_0}\sum_i x_i + 2\widehat{b_1}\sum_i x_i^2
\end{align*}
\]</span></p>
</li>
<li><p>Os valores de <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span> para os quais estas duas derivadas são <span class="hl">iguais a zero</span> são os valores que estamos procurando.</p></li>
<li>
<p>Para <span class="math inline">\(\frac{\partial S}{\partial \widehat{b_0}}\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp; -2\sum_i y_i + 2n\widehat{b_0} + 2\widehat{b_1}\sum_i x_i  = 0 \\ \\
\iff &amp;
   -2\frac{\sum_i y_i}n +
   \frac{2n\widehat{b_0}}n +
   2\widehat{b_1}\frac{\sum_i x_i}n  = 0
     &amp; \text{(dividimos tudo por }n &gt; 1\text{)} \\ \\
\iff &amp;
   -2\overline y +
   2\widehat{b_0} +
   2\widehat{b_1}\overline x  = 0
     &amp; \text{(apareceram médias!)} \\ \\
\iff &amp;
   \widehat{b_0} =
   \frac{2\overline y - 2\widehat{b_1} \overline x}{2} \\ \\
\iff &amp;
   \widehat{b_0} =
   \overline y - \widehat{b_1} \overline x
\end{align*}
\]</span></p>
</li>
<li>
<p>Para <span class="math inline">\(\frac{\partial S}{\partial \widehat{b_1}}\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp; -2\sum_i x_i y_i + 2\widehat{b_0}\sum_i x_i + 2\widehat{b_1}\sum_i x_i^2
= 0 \\ \\
\iff &amp;
  -\sum_i x_i y_i + \widehat{b_0}\sum_i x_i + \widehat{b_1}\sum_i x_i^2 = 0
     &amp; \text{(dividimos tudo por }2\text{)} \\ \\
\iff &amp;
  -\sum_i x_i y_i + (\overline y - \widehat{b_1} \overline x)\sum_i x_i + \widehat{b_1}\sum_i x_i^2 = 0
     &amp; \text{(substituímos }\widehat{b_0}\text{)} \\ \\
\iff &amp;
  -\sum_i x_i y_i + \overline y\sum_i x_i - \widehat{b_1} \overline x\sum_i x_i + \widehat{b_1}\sum_i x_i^2 = 0 \\ \\
\iff &amp;
  -\sum_i x_i y_i + \frac{\sum_i y_i\sum_i x_i}n - \widehat{b_1} \frac{\left(\sum_i x_i\right)^2}n + \widehat{b_1}\sum_i x_i^2 = 0
     &amp; \text{(expandimos }\overline x\text{ e }\overline y\text) \\ \\
\iff &amp;
  \widehat{b_1}
  \left(\sum_i x_i^2 - \frac{\left(\sum_i x_i\right)^2}n\right)
  =
  \sum_i x_i y_i - \frac{\sum_i y_i\sum_i x_i}n  
     &amp; \text{(isolamos }\widehat{b_1}\text) \\ \\
\iff &amp;
  \widehat{b_1} =
  \frac
  {\sum_i x_i y_i - \frac{\sum_i y_i\sum_i x_i}n}
  {\sum_i x_i^2 - \frac{\left(\sum_i x_i\right)^2}n} \\ \\
\iff &amp;
  \widehat{b_1} =
  \frac
  {n\sum_i x_i y_i - \sum_i y_i\sum_i x_i}
  {n\sum_i x_i^2 - \left(\sum_i x_i\right)^2}
\end{align*}
\]</span></p>
</li>
<li><p>A rigor, precisamos calcular as <span class="hl">segundas derivadas parciais</span> para garantir que achamos um mínimo, e não um máximo ou um ponto de sela, mas vamos pular esta parte.</p></li>
<li><p>A expressão para <span class="math inline">\(\widehat{b_1}\)</span> é bem feia, mas podemos escrevê-la de um jeito mais bonito.</p></li>
<li>
<p>Vamos lembrar as definições:</p>
<ul>
<li>
<p>A <span class="hl">variância <em>amostral</em> da variável aleatória <span class="math inline">\(X\)</span></span> pode ser escrita como</p>
<p><span class="math display">\[
\begin{align*}
  s^2_x  &amp;=
     \frac{n}{n-1}
    \left[
      E(X^2) - [E(X)]^2
    \right] \\ \\
   &amp;=
    \frac{n}{n-1}
    \left[
      \frac{\sum_i x_i^2}{n} - (\overline{x})^2
    \right] \\ \\
   &amp;=
     \frac{\sum_i x_i^2}{n - 1} - \frac{n(\overline{x})^2}{n - 1}
\end{align*}
\]</span></p>
<p>Como a reta de regressão é construída sobre uma <span class="hl">amostra</span>, precisamos usar a variância amostral, com denominador <span class="math inline">\(n - 1\)</span> em vez de denominador <span class="math inline">\(n\)</span>. Isto equivale a multiplicar a variância populacional pela fração <span class="math inline">\(\frac{n}{n-1}\)</span>.</p>
</li>
<li>
<p>A <span class="hl">covariância <em>amostral</em> de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span></span> é:</p>
<p><span class="math display">\[
\begin{align*}
  s_{xy}  &amp;=
     \frac{n}{n-1}
    \left[
      E(XY) - E(X)E(Y)
    \right] \\ \\
   &amp;=
     \frac{n}{n-1}
    \left[
      \frac{\sum_i x_i y _i}{n} - \overline{x}\;\overline{y}
    \right] \\ \\
   &amp;=
      \frac{\sum_i x_i y_i}{n - 1} -
      \frac{n\;\overline{x}\;\overline{y}}{n - 1} \\ \\
   &amp;=
      \frac{\sum_i x_i y_i}{n - 1} -
      \frac{\overline{x}\;\sum_i{y_i}}{n - 1}
\end{align*}
\]</span></p>
<p>O último passo se justifica porque <span class="math inline">\(n\overline{y} = \sum_i y_i\)</span>.</p>
</li>
<li>
<p>A <span class="hl">correlação entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span></span> é:</p>
<p><span class="math display">\[
r = \frac{s_{xy}}{s_x s_y}
\]</span></p>
<p>Lembre-se de que <span class="math inline">\(s_x = \sqrt{s_x^2}\)</span> é o <span class="hl">desvio-padrão amostral de <span class="math inline">\(X\)</span></span>, e <span class="math inline">\(s_y = \sqrt{s_y^2}\)</span> é o <span class="hl">desvio-padrão amostral de <span class="math inline">\(Y\)</span></span>.</p>
</li>
</ul>
</li>
<li><p>Vamos transformar a fórmula que achamos para <span class="math inline">\(\widehat{b_1}\)</span>.</p></li>
<li>
<p>Começamos com</p>
<p><span class="math display">\[
\widehat{b_1} =
  \frac
  {n\sum_i x_i y_i - \sum_i y_i\sum_i x_i}
  {n\sum_i x_i^2 - \left(\sum_i x_i\right)^2}
\]</span></p>
</li>
<li>
<p>Vamos multiplicar em cima e embaixo por <span class="math inline">\(\frac{1}{n(n-1)}\)</span>; lembre-se de que <span class="math inline">\(n &gt; 1\)</span>, o que elimina o perigo de dividir por zero.:</p>
<p><span class="math display">\[
\widehat{b_1} =
  \frac{
    \frac{\sum_i x_i y_i}{n - 1} -
    \frac{\sum_i y_i \sum_i x_i}{n(n - 1)}
  }
  {
    \frac{\sum_i x_i^2}{n - 1} -
    \frac{\left(\sum_i x_i\right)^2}{n(n - 1)}
  }
\]</span></p>
</li>
<li>
<p>Lembrando que</p>
<p><span class="math display">\[
\frac{\sum_i x_i}{n} = \overline{x}
\]</span></p>
<p>e que (o que é equivalente)</p>
<p><span class="math display">\[
n\overline{x} = \sum_i x_i
\]</span></p>
<p>temos que</p>
<p><span class="math display">\[
\widehat{b_1} =
  \frac{
    \frac{\sum_i x_i y_i}{n - 1} -
    \frac{\overline{x}\sum_i y_i}{n - 1}
  }
  {
    \frac{\sum_i x_i^2}{n - 1} -
    \frac{n(\overline{x})^2}{n - 1}
  }
\]</span></p>
</li>
<li>
<p>As definições de <span class="math inline">\(s_{xy}\)</span> e de <span class="math inline">\(s^2_x\)</span> apareceram!</p>
<p><span class="math display">\[
\widehat{b_1} = \frac{s_{xy}}{s_x^2}
\]</span></p>
</li>
<li>
<p>Para ficar mais bonito, multiplicamos em cima e embaixo por <span class="math inline">\(s_y\)</span> — que é maior que zero (senão, todos os <span class="math inline">\(y_i\)</span> teriam o mesmo valor!):</p>
<p><span class="math display">\[
\widehat{b_1} = \frac{s_{xy}}{s_x s_y} \cdot \frac{s_y}{s_x}
\]</span></p>
</li>
<li>
<p>E acabamos com</p>
<p><span class="math display">\[
\widehat{b_1} = r \cdot \frac{s_y}{s_x}
\]</span></p>
</li>
<li>
<p>Agora ficou fácil de entender: a inclinação da reta é a <span class="hl">correlação entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> multiplicada pela razão entre os desvios-padrão de <span class="math inline">\(Y\)</span> e <span class="math inline">\(X\)</span></span>.</p>
<div class="rmdnote">
<h3 id="resumindo" class="unnumbered">Resumindo</h3>
<p>Para construir a reta de regressão, com equação</p>
<p><span class="math display">\[
\widehat{y}(x) = \widehat{b_0} + \widehat{b_1} x
\]</span></p>
<p>basta usar as fórmulas</p>
<p><span class="hl"><span class="math display">\[
\begin{cases}
  \widehat{b_0} =&amp;
   \overline y - \widehat{b_1} \overline x \\
   \\
  \widehat{b_1} =&amp;
    r \cdot \frac{s_y}{s_x}
\end{cases}
\]</span></span></p>
</div>
</li>
<li>
<p>No nosso exemplo de <span class="math inline">\(x=\)</span> alturas e <span class="math inline">\(y=\)</span> pesos:</p>
<div class="sourceCode" id="cb892"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peso</span> <span class="op">&lt;-</span> <span class="va">peso_altura</span><span class="op">$</span><span class="va">peso</span></span>
<span><span class="va">altura</span> <span class="op">&lt;-</span> <span class="va">peso_altura</span><span class="op">$</span><span class="va">altura</span></span>
<span></span>
<span><span class="va">xbarra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">altura</span><span class="op">)</span></span>
<span><span class="va">sx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">altura</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ybarra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">peso</span><span class="op">)</span></span>
<span><span class="va">sy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">peso</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">altura</span>, <span class="va">peso</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="va">sy</span> <span class="op">/</span> <span class="va">sx</span></span>
<span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">ybarra</span> <span class="op">-</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">xbarra</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="st">'b0 ='</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">b0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="st">'\nb1 ='</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">b1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>## b0 = -89,81 
## b1 = 0,9</code></pre>
</li>
</ul>
<div id="exercícios-21" class="section level3" number="15.3.1">
<h3>
<span class="header-section-number">15.3.1</span> Exercícios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-21"><i class="fas fa-link"></i></a>
</h3>
<div id="unidades" class="section level4 unnumbered">
<h4>Unidades<a class="anchor" aria-label="anchor" href="#unidades"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<p>No nosso exemplo de alturas e pesos:</p>
<ul>
<li><p>Qual é a unidade de <span class="math inline">\(\widehat{b_0}\)</span>?</p></li>
<li><p>Qual é a unidade de <span class="math inline">\(\widehat{b_1}\)</span>?</p></li>
<li><p>Por que isto faz sentido no contexto de <span class="math inline">\(\widehat{\text{peso}}(x) = \widehat{b_0} + \widehat{b_1} \cdot \text{altura}(x)\)</span>?</p></li>
</ul>
</li>
</ul>
</div>
<div id="regressão-com-variáveis-padronizadas" class="section level4 unnumbered">
<h4>Regressão com variáveis padronizadas<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-com-vari%C3%A1veis-padronizadas"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Quais são os valores de <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span> quando as variáveis <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> estão <span class="hl">padronizadas</span>? Use as fórmulas para <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span>.</p></li>
<li><p>Quando as variáveis estão padronizadas, qual o valor máximo da inclinação da reta de regressão? E o valor mínimo?</p></li>
<li>
<p>Confirme suas respostas usando o R:</p>
<ol style="list-style-type: decimal">
<li><p>Padronize as variáveis <code>altura</code> e <code>peso</code> do exemplo, usando a função <code>scale</code>.</p></li>
<li>
<p>Compute, sobre as variáveis padronizadas, os valores de</p>
<ul>
<li><p><span class="math inline">\(\overline{\text{peso}}\)</span>,</p></li>
<li><p><span class="math inline">\(\overline{\text{altura}}\)</span>,</p></li>
<li><p><span class="math inline">\(s_{\text{peso}}\)</span>,</p></li>
<li><p><span class="math inline">\(s_{\text{altura}}\)</span>,</p></li>
<li><p><span class="math inline">\(r\)</span>, a correlação entre <code>altura</code> e <code>peso</code>,</p></li>
<li><p>Os valores de <span class="math inline">\(\widehat{b_0}\)</span> e <span class="math inline">\(\widehat{b_1}\)</span> usando as fórmulas.</p></li>
</ul>
</li>
<li><p>Construa o <em>scatter plot</em> das variáveis padronizadas e use <code>geom_smooth</code> (como no exemplo acima) para desenhar a reta de regressão.</p></li>
<li><p>Estime (pelo gráfico) o intercepto da reta e compare com a sua resposta para <span class="math inline">\(\widehat{b_0}\)</span>.</p></li>
<li><p>Estime (pelo gráfico) a inclinação da reta e compare com a sua resposta para <span class="math inline">\(\widehat{b_1}\)</span>.</p></li>
</ol>
</li>
</ul>
</div>
<div id="altura-média-corresponde-a-peso-médio" class="section level4 unnumbered">
<h4>Altura média corresponde a peso médio<a class="anchor" aria-label="anchor" href="#altura-m%C3%A9dia-corresponde-a-peso-m%C3%A9dio"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<p>Usando somente as fórmulas</p>
<p><span class="math display">\[
\begin{cases}
  \widehat{b_0} =&amp;
   \overline y - \widehat{b_1} \overline x \\
   \\
  \widehat{b_1} =&amp;
    r \cdot \frac{s_y}{s_x}
\end{cases}
\]</span></p>
<p>e a equação</p>
<p><span class="math display">\[
\widehat{y}(x) = \widehat{b_0} + \widehat{b_1} \cdot x
\]</span></p>
<p>mostre que <span class="hl">a altura média corresponde ao peso médio</span>, ou seja, que</p>
<p><span class="math display">\[
\widehat{y}(\overline{x}) = \overline{y}
\]</span></p>
</li>
</ul>
</div>
<div id="soma-dos-resíduos" class="section level4 unnumbered">
<h4>Soma dos resíduos<a class="anchor" aria-label="anchor" href="#soma-dos-res%C3%ADduos"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Uma das consequências da maneira como achamos a reta de melhor ajuste é que <span class="hl">a soma de todos os resíduos é zero.</span></p></li>
<li>
<p>Confira isto no nosso exemplo de alturas e pesos:</p>
<ul>
<li>
<p>Acrescente duas colunas ao <em>data frame</em> <code>peso_altura</code>:</p>
<ul>
<li><p><code>peso_chapeu</code>, com os valores de <span class="math inline">\(\widehat{\text{peso}}(x)\)</span> para cada pessoa <span class="math inline">\(x\)</span>.</p></li>
<li><p><code>residuo</code>, com os valores de <code>peso - peso_chapeu</code>.</p></li>
</ul>
</li>
<li><p>Use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> para obter a soma dos resíduos.</p></li>
</ul>
</li>
<li>
<p>Em símbolos:</p>
<p><span class="math display">\[
\sum_i \left(y_i - \widehat{y}(x_i) \right) \;=\; 0
\]</span></p>
</li>
<li><p>Usando as definições de <span class="math inline">\(\widehat{y}(x_i)\)</span>, de <span class="math inline">\(\widehat{b_0}\)</span>, e de <span class="math inline">\(\widehat{b_1}\)</span>, prove esta igualdade.</p></li>
</ul>
</div>
</div>
</div>
<div id="em-r-20" class="section level2" number="15.4">
<h2>
<span class="header-section-number">15.4</span> Em R<a class="anchor" aria-label="anchor" href="#em-r-20"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>A função <code>lm</code> (<em>linear model</em>) acha a reta de regressão e retorna muitas informações sobre o modelo.</p></li>
<li>
<p>No nosso exemplo:</p>
<div class="sourceCode" id="cb894"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">peso</span> <span class="op">~</span> <span class="va">altura</span>, data <span class="op">=</span> <span class="va">peso_altura</span><span class="op">)</span></span></code></pre></div>
</li>
<li><p>O argumento <code>peso ~ altura</code> é uma <span class="hl">fórmula</span>, um tipo de expressão que faz parte da sintaxe de R.</p></li>
<li>
<p>O objeto retornado por <code>lm</code> é uma lista com muitos elementos:</p>
<div class="sourceCode" id="cb895"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>## List of 12
##  $ coefficients : Named num [1:2] -89,806 0,899
##   ..- attr(*, "names")= chr [1:2] "(Intercept)" "altura"
##  $ residuals    : Named num [1:68] -6,8 1,33 -11,99 1,75 ...
##   ..- attr(*, "names")= chr [1:68] "1" "2" "3" ...
##  $ effects      : Named num [1:68] -521,75 70,83 -11 2,32 ...
##   ..- attr(*, "names")= chr [1:68] "(Intercept)" "altura" "" ...
##  $ rank         : int 2
##  $ fitted.values: Named num [1:68] 56,3 54 72,3 56,3 ...
##   ..- attr(*, "names")= chr [1:68] "1" "2" "3" ...
##  $ assign       : int [1:2] 0 1
##  $ qr           :List of 5
##   ..$ qr   : num [1:68, 1:2] -8,246 0,121 0,121 0,121 ...
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:68] "1" "2" "3" ...
##   .. .. ..$ : chr [1:2] "(Intercept)" "altura"
##   .. ..- attr(*, "assign")= int [1:2] 0 1
##   ..$ qraux: num [1:2] 1,12 1,12
##   ..$ pivot: int [1:2] 1 2
##   ..$ tol  : num 0,0000001
##   ..$ rank : int 2
##   ..- attr(*, "class")= chr "qr"
##  $ df.residual  : int 66
##  $ xlevels      : Named list()
##  $ call         : language lm(formula = peso ~ altura, data = peso_altura)
##  $ terms        :Classes 'terms', 'formula'  language peso ~ altura
##   .. ..- attr(*, "variables")= language list(peso, altura)
##   .. ..- attr(*, "factors")= int [1:2, 1] 0 1
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:2] "peso" "altura"
##   .. .. .. ..$ : chr "altura"
##   .. ..- attr(*, "term.labels")= chr "altura"
##   .. ..- attr(*, "order")= int 1
##   .. ..- attr(*, "intercept")= int 1
##   .. ..- attr(*, "response")= int 1
##   .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, "predvars")= language list(peso, altura)
##   .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
##   .. .. ..- attr(*, "names")= chr [1:2] "peso" "altura"
##  $ model        :'data.frame':   68 obs. of  2 variables:
##   ..$ peso  : num [1:68] 49,5 55,4 60,3 58,1 ...
##   ..$ altura: num [1:68] 163 160 180 163 ...
##   ..- attr(*, "terms")=Classes 'terms', 'formula'  language peso ~ altura
##   .. .. ..- attr(*, "variables")= language list(peso, altura)
##   .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. ..$ : chr [1:2] "peso" "altura"
##   .. .. .. .. ..$ : chr "altura"
##   .. .. ..- attr(*, "term.labels")= chr "altura"
##   .. .. ..- attr(*, "order")= int 1
##   .. .. ..- attr(*, "intercept")= int 1
##   .. .. ..- attr(*, "response")= int 1
##   .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
##   .. .. ..- attr(*, "predvars")= language list(peso, altura)
##   .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
##   .. .. .. ..- attr(*, "names")= chr [1:2] "peso" "altura"
##  - attr(*, "class")= chr "lm"</code></pre>
</li>
<li>
<p>Vamos ver os mais importantes, usando funções auxiliares para acessá-los:</p>
<ul>
<li>
<p>Os coeficientes da reta:</p>
<div class="sourceCode" id="cb897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>## (Intercept)      altura 
## -89,8056787   0,8988101</code></pre>
</li>
<li>
<p>Os valores de <span class="math inline">\(\widehat{y}(x)\)</span> para todas as observações <span class="math inline">\(x\)</span>:</p>
<div class="sourceCode" id="cb899"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8        9 
## 56,30488 54,02191 72,28573 56,30488 51,73893 58,58786 57,44637 66,57828 59,72935 
##       10       11       12       13       14       15       16       17       18 
## 56,30488 56,30488 54,02191 51,73893 81,41764 49,45595 51,73893 54,02191 60,87084 
##       19       20       21       22       23       24       25       26       27 
## 54,02191 63,15382 63,15382 56,30488 49,45595 63,15382 51,73893 60,87084 67,71977 
##       28       29       30       31       32       33       34       35       36 
## 70,00275 56,30488 65,43679 67,71977 65,43679 56,30488 65,43679 65,43679 51,73893 
##       37       38       39       40       41       42       43       44       45 
## 60,87084 65,43679 60,87084 70,00275 60,87084 60,87084 70,00275 56,30488 63,15382 
##       46       47       48       49       50       51       52       53       54 
## 54,02191 49,45595 58,58786 85,98359 72,28573 56,30488 60,87084 70,00275 76,85168 
##       55       56       57       58       59       60       61       62       63 
## 74,56871 76,85168 74,56871 74,56871 74,56871 67,71977 79,13466 63,15382 72,28573 
##       64       65       66       67       68 
## 70,00275 72,28573 63,15382 72,28573 72,28573</code></pre>
</li>
<li>
<p>Os resíduos de todas as observações:</p>
<div class="sourceCode" id="cb901"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>##            1            2            3            4            5            6 
##  -6,80488467   1,32809288 -11,98572754   1,74511533   6,31107043  -3,23786223 
##            7            8            9           10           11           12 
##  -5,69637345 -11,67828366  -5,72935100  -6,35488467  -4,55488467  -1,37190712 
##           13           14           15           16           17           18 
##  -3,58892957  -4,91763776  -8,50595201   1,36107043   4,47809288  -0,12083978 
##           19           20           21           22           23           24 
##  -0,02190712  -6,90381733 -10,50381733   4,44511533  -9,85595201  -4,65381733 
##           25           26           27           28           29           30 
##  15,76107043  -2,37083978  -0,21977244   1,99725001  -2,30488467  -8,73679489 
##           31           32           33           34           35           36 
##  -9,21977244  -2,43679489  24,69511533  -4,68679489  -0,18679489   6,76107043 
##           37           38           39           40           41           42 
##   6,62916022   2,06320511  -9,12083978  -7,00274999  22,37916022 -11,37083978 
##           43           44           45           46           47           48 
## -11,50274999  -0,05488467   2,09618267  -6,77190712   4,54404799   6,66213777 
##           49           50           51           52           53           54 
##  -2,73359286   5,11427246   2,19511533   8,87916022  -2,50274999   1,89831735 
##           55           56           57           58           59           60 
##  -0,76870510  17,64831735  -7,06870510 -11,56870510  -2,56870510  -2,46977244 
##           61           62           63           64           65           66 
##   4,11533980  -9,15381733  51,46427246   6,49725001  -4,78572754   4,34618267 
##           67           68 
##  17,71427246  -7,03572754</code></pre>
</li>
<li>
<p>Aliás, como prometido, a soma dos resíduos é zero, salvo erro de arredondamento:</p>
<div class="sourceCode" id="cb903"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0,00000000000002731149</code></pre>
</li>
</ul>
</li>
<li>
<p>Outra maneira de ver os coeficientes é simplesmente imprimir o objeto retornado por <code>lm</code>:</p>
<div class="sourceCode" id="cb905"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = peso ~ altura, data = peso_altura)
## 
## Coefficients:
## (Intercept)       altura  
##    -89,8057       0,8988</code></pre>
</li>
<li>
<p>Ou usar a função <code>summary</code>, que mostra estatísticas sobre os resíduos, os valores dos coeficientes, os resultados de testes estatísticos sobre eles, e informações sobre o modelo como um todo.</p>
<p>Vamos falar sobre estes testes e estas informações depois.</p>
<div class="sourceCode" id="cb907"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = peso ~ altura, data = peso_altura)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11,986  -6,780  -2,338   4,173  51,464 
## 
## Coefficients:
##             Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept) -89,8057    22,1905  -4,047      0,000139 ***
## altura        0,8988     0,1301   6,909 0,00000000235 ***
## ---
## Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1
## 
## Residual standard error: 10,25 on 66 degrees of freedom
## Multiple R-squared:  0,4197, Adjusted R-squared:  0,4109 
## F-statistic: 47,74 on 1 and 66 DF,  p-value: 0,000000002349</code></pre>
</li>
<li>
<p>Para <span class="hl">prever</span> os pesos de novas alturas observadas, use <code>predict</code>:</p>
<div class="sourceCode" id="cb909"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">novas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  altura <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">156</span>, <span class="fl">177</span>, <span class="fl">192</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modelo</span>, newdata <span class="op">=</span> <span class="va">novas</span><span class="op">)</span></span></code></pre></div>
<pre><code>##        1        2        3 
## 50,40869 69,28370 82,76585</code></pre>
</li>
</ul>
<div id="no-tidyverse" class="section level3" number="15.4.1">
<h3>
<span class="header-section-number">15.4.1</span> No Tidyverse<a class="anchor" aria-label="anchor" href="#no-tidyverse"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>O pacote <code>broom</code> recolhe em <em>tibbles</em> as informações retornadas por <code>lm</code>.</p>
<div class="sourceCode" id="cb911"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Use a função <code>tidy</code> para informações sobre os coeficientes:</p>
<div class="sourceCode" id="cb912"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-89,8056787","3":"22,1905243","4":"-4,047028","5":"0,000138547904800"},{"1":"altura","2":"0,8988101","3":"0,1300897","4":"6,909156","5":"0,000000002348969"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li>
<p>Use a função <code>glance</code> para outras informações sobre o modelo:</p>
<div class="sourceCode" id="cb913"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0,419711","2":"0,4109188","3":"10,25163","4":"47,73644","5":"0,000000002348969","6":"1","7":"-253,7385","8":"513,477","9":"520,1355","10":"6936,325","11":"66","12":"68"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li>
<p>Para ver os valores computados pelo modelo para as observações, use <code>augment</code>, passando o modelo e, opcionalmente, os dados originais:</p>
<div class="sourceCode" id="cb914"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">modelo</span>, data <span class="op">=</span> <span class="va">peso_altura</span><span class="op">)</span></span>
<span><span class="va">dados_aumentados</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["altura"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["peso"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"162,56","2":"49,50","3":"56,30488","4":"-6,80488467","5":"0,02437944","6":"10,294780","7":"0,00564271100883","8":"-0,672028254"},{"1":"160,02","2":"55,35","3":"54,02191","4":"1,32809288","5":"0,03175858","6":"10,328827","7":"0,00028427269923","8":"0,131656970"},{"1":"180,34","2":"60,30","3":"72,28573","4":"-11,98572754","5":"0,03090303","6":"10,219203","7":"0,02248950239576","8":"-1,187648757"},{"1":"162,56","2":"58,05","3":"56,30488","4":"1,74511533","5":"0,02437944","6":"10,327859","7":"0,00037110306052","8":"0,172341908"},{"1":"157,48","2":"58,05","3":"51,73893","4":"6,31107043","5":"0,04121550","6":"10,299204","7":"0,00849589330678","8":"0,628709119"},{"1":"165,10","2":"55,35","3":"58,58786","4":"-3,23786223","5":"0,01907807","6":"10,322222","7":"0,00098893249221","8":"-0,318895490"},{"1":"163,83","2":"51,75","3":"57,44637","4":"-5,69637345","5":"0,02146903","6":"10,305462","7":"0,00346134315489","8":"-0,561718078"},{"1":"173,99","2":"54,90","3":"66,57828","4":"-11,67828366","5":"0,01688571","6":"10,226362","7":"0,01133584381450","8":"-1,148905348"},{"1":"166,37","2":"54,00","3":"59,72935","4":"-5,72935100","5":"0,01720654","6":"10,305283","7":"0,00278204696628","8":"-0,563743486"},{"1":"162,56","2":"49,95","3":"56,30488","4":"-6,35488467","5":"0,02437944","6":"10,299314","7":"0,00492109350175","8":"-0,627587719"},{"1":"162,56","2":"51,75","3":"56,30488","4":"-4,55488467","5":"0,02437944","6":"10,314337","7":"0,00252813953695","8":"-0,449825580"},{"1":"160,02","2":"52,65","3":"54,02191","4":"-1,37190712","5":"0,03175858","6":"10,328736","7":"0,00030333859805","8":"-0,136000378"},{"1":"157,48","2":"48,15","3":"51,73893","4":"-3,58892957","5":"0,04121550","6":"10,320175","7":"0,00274746941183","8":"-0,357529324"},{"1":"190,50","2":"76,50","3":"81,41764","4":"-4,91763776","5":"0,08034176","6":"10,310584","7":"0,01092913953867","8":"-0,500207890"},{"1":"154,94","2":"40,95","3":"49,45595","4":"-8,50595201","5":"0,05275018","6":"10,273150","7":"0,02023602636595","8":"-0,852506892"},{"1":"157,48","2":"53,10","3":"51,73893","4":"1,36107043","5":"0,04121550","6":"10,328745","7":"0,00039515201042","8":"0,135589898"},{"1":"160,02","2":"58,50","3":"54,02191","4":"4,47809288","5":"0,03175858","6":"10,314750","7":"0,00323194863541","8":"0,443923877"},{"1":"167,64","2":"60,75","3":"60,87084","4":"-0,12083978","5":"0,01585446","6":"10,330173","7":"0,00000113720101","8":"-0,011881944"},{"1":"160,02","2":"54,00","3":"54,02191","4":"-0,02190712","5":"0,03175858","6":"10,330184","7":"0,00000007734795","8":"-0,002171704"},{"1":"170,18","2":"56,25","3":"63,15382","4":"-6,90381733","5":"0,01470863","6":"10,294099","7":"0,00343562745035","8":"-0,678444286"},{"1":"170,18","2":"52,65","3":"63,15382","4":"-10,50381733","5":"0,01470863","6":"10,246462","7":"0,00795283187253","8":"-1,032219496"},{"1":"162,56","2":"60,75","3":"56,30488","4":"4,44511533","5":"0,02437944","6":"10,315092","7":"0,00240775523745","8":"0,438985117"},{"1":"154,94","2":"39,60","3":"49,45595","4":"-9,85595201","5":"0,05275018","6":"10,253537","7":"0,02716918060116","8":"-0,987810301"},{"1":"170,18","2":"58,50","3":"63,15382","4":"-4,65381733","5":"0,01470863","6":"10,313803","7":"0,00156115543630","8":"-0,457334779"},{"1":"157,48","2":"67,50","3":"51,73893","4":"15,76107043","5":"0,04121550","6":"10,135418","7":"0,05298762026466","8":"1,570118541"},{"1":"167,64","2":"58,50","3":"60,87084","4":"-2,37083978","5":"0,01585446","6":"10,325930","7":"0,00043774561671","8":"-0,233120130"},{"1":"175,26","2":"67,50","3":"67,71977","4":"-0,21977244","5":"0,01865029","6":"10,330147","7":"0,00000445009103","8":"-0,021640563"},{"1":"177,80","2":"72,00","3":"70,00275","4":"1,99725001","5":"0,02373777","6":"10,327141","7":"0,00047266815058","8":"0,197177077"},{"1":"162,56","2":"54,00","3":"56,30488","4":"-2,30488467","5":"0,02437944","6":"10,326128","7":"0,00064735822388","8":"-0,227622906"},{"1":"172,72","2":"56,70","3":"65,43679","4":"-8,73679489","5":"0,01564058","6":"10,272279","7":"0,00586184181251","8":"-0,858978955"},{"1":"175,26","2":"58,50","3":"67,71977","4":"-9,21977244","5":"0,01865029","6":"10,265480","7":"0,00783182267507","8":"-0,907853010"},{"1":"172,72","2":"63,00","3":"65,43679","4":"-2,43679489","5":"0,01564058","6":"10,325691","7":"0,00045600306682","8":"-0,239579337"},{"1":"162,56","2":"81,00","3":"56,30488","4":"24,69511533","5":"0,02437944","6":"9,853728","7":"0,07431361485333","8":"2,438809183"},{"1":"172,72","2":"60,75","3":"65,43679","4":"-4,68679489","5":"0,01564058","6":"10,313554","7":"0,00168687036768","8":"-0,460793486"},{"1":"172,72","2":"65,25","3":"65,43679","4":"-0,18679489","5":"0,01564058","6":"10,330158","7":"0,00000267953710","8":"-0,018365187"},{"1":"157,48","2":"58,50","3":"51,73893","4":"6,76107043","5":"0,04121550","6":"10,294620","7":"0,00975065782286","8":"0,673538139"},{"1":"167,64","2":"67,50","3":"60,87084","4":"6,62916022","5":"0,01585446","6":"10,296879","7":"0,00342242883832","8":"0,651832616"},{"1":"172,72","2":"67,50","3":"65,43679","4":"2,06320511","5":"0,01564058","6":"10,326963","7":"0,00032689977853","8":"0,202848962"},{"1":"167,64","2":"51,75","3":"60,87084","4":"-9,12083978","5":"0,01585446","6":"10,267046","7":"0,00647868774821","8":"-0,896834690"},{"1":"177,80","2":"63,00","3":"70,00275","4":"-7,00274999","5":"0,02373777","6":"10,292712","7":"0,00581070355399","8":"-0,691341478"},{"1":"167,64","2":"83,25","3":"60,87084","4":"22,37916022","5":"0,01585446","6":"9,944021","7":"0,03900362448442","8":"2,200499923"},{"1":"167,64","2":"49,50","3":"60,87084","4":"-11,37083978","5":"0,01585446","6":"10,231886","7":"0,01006937408684","8":"-1,118072877"},{"1":"177,80","2":"58,50","3":"70,00275","4":"-11,50274999","5":"0,02373777","6":"10,228764","7":"0,01567815080254","8":"-1,135600756"},{"1":"162,56","2":"56,25","3":"56,30488","4":"-0,05488467","5":"0,02437944","6":"10,330182","7":"0,00000036706960","8":"-0,005420232"},{"1":"170,18","2":"65,25","3":"63,15382","4":"2,09618267","5":"0,01470863","6":"10,326863","7":"0,00031672747019","8":"0,205993740"},{"1":"160,02","2":"47,25","3":"54,02191","4":"-6,77190712","5":"0,03175858","6":"10,294855","7":"0,00739094961230","8":"-0,671315075"},{"1":"154,94","2":"54,00","3":"49,45595","4":"4,54404799","5":"0,05275018","6":"10,313939","7":"0,00577517565743","8":"0,455426062"},{"1":"165,10","2":"65,25","3":"58,58786","4":"6,66213777","5":"0,01907807","6":"10,296436","7":"0,00418675102718","8":"0,656150739"},{"1":"195,58","2":"83,25","3":"85,98359","4":"-2,73359286","5":"0,11752776","6":"10,323877","7":"0,00536525641210","8":"-0,283851073"},{"1":"180,34","2":"77,40","3":"72,28573","4":"5,11427246","5":"0,03090303","6":"10,310067","7":"0,00409466866737","8":"0,506766010"},{"1":"162,56","2":"58,50","3":"56,30488","4":"2,19511533","5":"0,02437944","6":"10,326506","7":"0,00058716607412","8":"0,216782443"},{"1":"167,64","2":"69,75","3":"60,87084","4":"8,87916022","5":"0,01585446","6":"10,270358","7":"0,00613989834556","8":"0,873070803"},{"1":"177,80","2":"67,50","3":"70,00275","4":"-2,50274999","5":"0,02373777","6":"10,325405","7":"0,00074220933667","8":"-0,247082201"},{"1":"185,42","2":"78,75","3":"76,85168","4":"1,89831735","5":"0,05146685","6":"10,327355","7":"0,00098071924740","8":"0,190129627"},{"1":"182,88","2":"73,80","3":"74,56871","4":"-0,76870510","5":"0,04014606","6":"10,329725","7":"0,00012250013453","8":"-0,076535764"},{"1":"185,42","2":"94,50","3":"76,85168","4":"17,64831735","5":"0,05146685","6":"10,082706","7":"0,08476443552197","8":"1,767601185"},{"1":"182,88","2":"67,50","3":"74,56871","4":"-7,06870510","5":"0,04014606","6":"10,291347","7":"0,01035849761391","8":"-0,703792318"},{"1":"182,88","2":"63,00","3":"74,56871","4":"-11,56870510","5":"0,04014606","6":"10,225829","7":"0,02774511595406","8":"-1,151832713"},{"1":"182,88","2":"72,00","3":"74,56871","4":"-2,56870510","5":"0,04014606","6":"10,325064","7":"0,00136787224806","8":"-0,255751922"},{"1":"175,26","2":"65,25","3":"67,71977","4":"-2,46977244","5":"0,01865029","6":"10,325554","7":"0,00056200000749","8":"-0,243193675"},{"1":"187,96","2":"83,25","3":"79,13466","4":"4,11533980","5":"0,06486542","6":"10,316689","7":"0,00597669224078","8":"0,415122122"},{"1":"170,18","2":"54,00","3":"63,15382","4":"-9,15381733","5":"0,01470863","6":"10,266662","7":"0,00603993081041","8":"-0,899553792"},{"1":"180,34","2":"123,75","3":"72,28573","4":"51,46427246","5":"0,03090303","6":"8,041522","7":"0,41463190687316","8":"5,099521825"},{"1":"177,80","2":"76,50","3":"70,00275","4":"6,49725001","5":"0,02373777","6":"10,297935","7":"0,00500207999572","8":"0,641436355"},{"1":"180,34","2":"67,50","3":"72,28573","4":"-4,78572754","5":"0,03090303","6":"10,312570","7":"0,00358547735799","8":"-0,474210960"},{"1":"170,18","2":"67,50","3":"63,15382","4":"4,34618267","5":"0,01470863","6":"10,315898","7":"0,00136158084017","8":"0,427103246"},{"1":"180,34","2":"90,00","3":"72,28573","4":"17,71427246","5":"0,03090303","6":"10,086185","7":"0,04912444807411","8":"1,755282154"},{"1":"180,34","2":"65,25","3":"72,28573","4":"-7,03572754","5":"0,03090303","6":"10,292077","7":"0,00774941769964","8":"-0,697160272"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li>
<p>Para <span class="hl">prever</span> os pesos de novas alturas observadas, use <code>augment</code> com as novas observações no argumento <code>newdata</code>:</p>
<div class="sourceCode" id="cb915"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">novas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  altura <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">156</span>, <span class="fl">177</span>, <span class="fl">192</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">modelo</span>, newdata <span class="op">=</span> <span class="va">novas</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["altura"],"name":[1],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"156","2":"50,40869"},{"1":"177","2":"69,28370"},{"1":"192","2":"82,76585"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li><p>Como não passamos os pesos verdadeiros destas observações, a função não calculou resíduos.</p></li>
<li>
<p>Se passarmos os pesos verdadeiros (como se quiséssemos testar o modelo com observações que não foram usadas para construir a regressão), a função calcula os resíduos:</p>
<div class="sourceCode" id="cb916"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">novas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  altura <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">156</span>, <span class="fl">177</span>, <span class="fl">192</span><span class="op">)</span>,</span>
<span>  peso   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">55</span>,  <span class="fl">70</span>,  <span class="fl">80</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">modelo</span>, newdata <span class="op">=</span> <span class="va">novas</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["altura"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["peso"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"156","2":"55","3":"50,40869","4":"4,5913093"},{"1":"177","2":"70","3":"69,28370","4":"0,7162981"},{"1":"192","2":"80","3":"82,76585","4":"-2,7658528"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
</ul>
</div>
</div>
<div id="avaliando-o-modelo-através-dos-resíduos" class="section level2" number="15.5">
<h2>
<span class="header-section-number">15.5</span> Avaliando o modelo através dos resíduos<a class="anchor" aria-label="anchor" href="#avaliando-o-modelo-atrav%C3%A9s-dos-res%C3%ADduos"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<p>Vamos repetir o <em>scatter plot</em> com a reta de regressão:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-456-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Lembre-se de que, neste exemplo, os resíduos são as diferenças, para cada observação, entre o peso verdadeiro e o peso estimado pela reta de regressão.</p></li>
<li><p>No gráfico acima, o resíduo de uma observação é a <span class="hl">distância vertical da reta até o ponto</span>. O resíduo é positivo se o ponto está acima da reta, negativo se abaixo.</p></li>
<li><p><span class="hl">Os resíduos são usados para verificar se o modelo é adequado</span>.</p></li>
<li>
<p>O pacote <code>gglm</code> (<a href="http://graysonwhite.com/gglm/" class="uri">http://graysonwhite.com/gglm/</a>) tem funções para produzir gráficos úteis sobre os resíduos:</p>
<div class="sourceCode" id="cb917"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/graysonwhite/gglm">gglm</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb918"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_fitted_resid.html">stat_fitted_resid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'resíduos\n(kg)'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'pesos estimados (kg)'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Resíduos por pesos estimados'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-458-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb919"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_normal_qq.html">stat_normal_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'quantis da distribuição normal\n(desvios padrão)'</span>,</span>
<span>      y <span class="op">=</span> <span class="st">'resíduos\npadronizados'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'QQ Normal'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-459-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Ou, se você não se importar com a feiúra dos gráficos do R base, pode usar a função <code>plot</code> com o objeto retornado pela função <code>lm</code>:</p>
<div class="sourceCode" id="cb920"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modelo</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-460-1.png" width="100%" style="display: block; margin: auto;"><img src="_main_files/figure-html/unnamed-chunk-460-2.png" width="100%" style="display: block; margin: auto;"></p>
</li>
<li>
<p>Que condições devemos verificar sobre os resíduos?</p>
<ol style="list-style-type: decimal">
<li>
<p>Devemos confirmar que <span class="hl">os resíduos seguem uma distribuição normal</span>.</p>
<p>Fazendo um histograma dos resíduos:</p>
<div class="sourceCode" id="cb921"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="st">'resíduo'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-461-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Pelo histograma e pelo gráfico QQ mais acima, os resíduos parecem <span class="hl">não ter distribuição normal</span>. O problema são os <em>outliers</em>, observações com resíduos altos:</p>
<div class="sourceCode" id="cb922"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">.resid</span>, n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">altura</span>, <span class="va">peso</span>, <span class="va">.fitted</span>, <span class="va">.resid</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["altura"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["peso"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"180,34","2":"123,75","3":"72,28573","4":"51,46427"},{"1":"162,56","2":"81,00","3":"56,30488","4":"24,69512"},{"1":"167,64","2":"83,25","3":"60,87084","4":"22,37916"},{"1":"180,34","2":"90,00","3":"72,28573","4":"17,71427"},{"1":"185,42","2":"94,50","3":"76,85168","4":"17,64832"},{"1":"157,48","2":"67,50","3":"51,73893","4":"15,76107"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Podemos fazer um <a href="th.html#teste-de-normalidade-de-shapiro-wilk">teste estatístico de normalidade</a>:</p>
<div class="sourceCode" id="cb923"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##     Shapiro-Wilk normality test
## 
## data:  .
## W = 0,8076, p-value = 0,00000005328</code></pre>
<p>Este resultado confirma que <span class="hl">não devemos considerar estes resíduos como sendo normais.</span> Se ignorarmos todos os resíduos maiores que <span class="math inline">\(10\)</span>kg, o teste retorna um resultado mais compatível com a normalidade (mas não muito):</p>
<div class="sourceCode" id="cb925"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">.resid</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##     Shapiro-Wilk normality test
## 
## data:  .
## W = 0,96643, p-value = 0,08763</code></pre>
<div class="rmdimportant">
<p>Quando a distribuição dos resíduos não for normal, o que fazer?</p>
<ul>
<li>
<p>No nosso exemplo, a causa é a presença de alguns <span class="hl"><em>outliers</em> com resíduos maiores que <span class="math inline">\(10\)</span></span>. São pessoas que têm pesos altos demais para as suas alturas. Se estes <em>outliers</em> estiverem muito próximos da borda esquerda ou da borda direita do <em>scatter plot</em>, eles podem afetar muito a inclinação da reta (tecnicamente, dizemos que eles têm <em>leverage</em> alto). Podemos refazer a regressão sem estes <em>outliers</em> e verificar se isto altera muito a reta. <span class="hl">Faça isto como exercício neste exemplo</span>.</p>
<p>Leia mais sobre este problema <a href="https://stats.stackexchange.com/questions/100214/assumptions-of-linear-models-and-what-to-do-if-the-residuals-are-not-normally-di">nesta discussão <em>online</em></a> e <a href="https://discovery.ucl.ac.uk/id/eprint/10070182/1/Schmidt_UCL_depos_JCE2018.pdf">neste artigo</a>.</p>
</li>
<li><p>Em outros casos, isto pode ser um sinal de que a correlação entre as variáveis <span class="hl">não é linear</span>. Nesta situação, você pode tentar transformar uma das variáveis, como mostrado no <a href="corr.html#transforma%C3%A7%C3%B5es">capítulo sobre correlação</a>.</p></li>
</ul>
</div>
</li>
<li>
<p>Devemos confirmar que <span class="hl">os resíduos não dependem dos valores estimados</span>.</p>
<p>A idéia é que o <em>scatter plot</em> dos resíduos pelos valores estimados <span class="hl">não deve apresentar nenhum padrão</span>. A nuvem de pontos deve se distribuir de maneira uniforme em torno da reta horizontal <span class="math inline">\(y = 0\)</span> (a média dos resíduos), sem <em>outliers</em> e sem alterações significativas da variância (a “altura” da nuvem).</p>
<p>Repetindo o gráfico de resíduos por pesos estimados:</p>
<div class="sourceCode" id="cb927"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_fitted_resid.html">stat_fitted_resid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'resíduos\n(kg)'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'pesos estimados (kg)'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Resíduos por pesos estimados'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-465-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>De novo, os <em>outliers</em> são o problema. Refaça a regressão sem os <em>outliers</em> e gere os gráficos novamente.</p>
<div class="rmdimportant">
<p>Quando a variância dos resíduos não for constante, o que fazer?</p>
<p>Observe o gráfico abaixo, feito a partir de outros dados:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-466-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Perceba como a variância dos resíduos muda à medida que o valor estimado aumenta. Este fenômeno tem o nome de <span class="hl">heterocedasticidade</span>.</p>
<p>Quando isto acontece, podemos refazer a regressão com a variável de resposta transformada por <span class="math inline">\(\log\)</span> ou por <span class="math inline">\(\sqrt{\,\,}\)</span> e verificar se a variância dos resíduos ficou mais bem comportada.</p>
<p>Alternativamente, em algumas situações, podemos usar uma variante de regressão linear chamada <a href="https://en.wikipedia.org/wiki/Weighted_least_squares"><span class="hl">regressão linear com pesos</span></a>, que não vamos abordar aqui.</p>
</div>
</li>
</ol>
</li>
</ul>
</div>
<div id="condições-para-usar-regressão-linear" class="section level2" number="15.6">
<h2>
<span class="header-section-number">15.6</span> Condições para usar regressão linear<a class="anchor" aria-label="anchor" href="#condi%C3%A7%C3%B5es-para-usar-regress%C3%A3o-linear"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>As duas variáveis devem ser <span class="hl">quantitativas</span>.</p></li>
<li><p>Como a equação da reta de regressão usa a correlação <span class="hl">linear</span>, devemos verificar que este é o tipo de correlação entre as duas variáveis. Um <em>scatter plot</em> é uma boa maneira de visualizar isto.</p></li>
<li><p>Não deve haver <span class="hl"><em>outliers</em></span> extremos.</p></li>
<li><p>Uma vez definida a reta de regressão, devemos <span class="hl">examinar os resíduos</span>. No <em>scatter plot</em> de resíduos pelos valores estimados, a nuvem de pontos deve estar espalhada em torno da reta <span class="math inline">\(y = 0\)</span>, sem padrões óbvios, sem curvatura, sem alterações na variância à medida que percorremos a reta horizontal.</p></li>
</ul>
</div>
<div id="exemplo-furacões" class="section level2" number="15.7">
<h2>
<span class="header-section-number">15.7</span> Exemplo: furacões<a class="anchor" aria-label="anchor" href="#exemplo-furac%C3%B5es"><i class="fas fa-link"></i></a>
</h2>
<div class="rmdbox">
<ul>
<li><p>A <span class="hl">pressão do ar</span> no centro de um furacão está relacionada com a <span class="hl">velocidade máxima dos ventos</span>.</p></li>
<li>
<p>Vamos usar o seguinte conjunto de dados para contruir um modelo linear:</p>
<div class="sourceCode" id="cb928"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">furacoes</span> <span class="op">&lt;-</span> <span class="va">hurricNamed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html">transmute</a></span><span class="op">(</span></span>
<span>    nome <span class="op">=</span> <span class="va">Name</span>,</span>
<span>    ano <span class="op">=</span> <span class="va">Year</span>,</span>
<span>    velocidade <span class="op">=</span> <span class="va">LF.WindsMPH</span> <span class="op">*</span> <span class="fl">1.8</span>,      <span class="co"># convertido para km/h</span></span>
<span>    pressao <span class="op">=</span> <span class="va">LF.PressureMB</span>              <span class="co"># em mbar</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">furacoes</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["nome"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ano"],"name":[2],"type":["int"],"align":["right"]},{"label":["velocidade"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["pressao"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Easy","2":"1950","3":"216","4":"958"},{"1":"King","2":"1950","3":"234","4":"955"},{"1":"Able","2":"1952","3":"153","4":"985"},{"1":"Barbara","2":"1953","3":"153","4":"987"},{"1":"Florence","2":"1953","3":"153","4":"985"},{"1":"Carol","2":"1954","3":"216","4":"960"},{"1":"Edna","2":"1954","3":"216","4":"954"},{"1":"Hazel","2":"1954","3":"261","4":"938"},{"1":"Connie","2":"1955","3":"216","4":"962"},{"1":"Diane","2":"1955","3":"153","4":"987"},{"1":"Ione","2":"1955","3":"216","4":"960"},{"1":"Flossy","2":"1956","3":"189","4":"975"},{"1":"Audrey","2":"1957","3":"261","4":"945"},{"1":"Helene","2":"1958","3":"216","4":"946"},{"1":"Debra","2":"1959","3":"153","4":"984"},{"1":"Gracie","2":"1959","3":"216","4":"950"},{"1":"Donna","2":"1960","3":"261","4":"930"},{"1":"Ethel","2":"1960","3":"153","4":"981"},{"1":"Carla","2":"1961","3":"261","4":"931"},{"1":"Cindy","2":"1963","3":"153","4":"996"},{"1":"Cleo","2":"1964","3":"189","4":"968"},{"1":"Dora","2":"1964","3":"189","4":"966"},{"1":"Hilda","2":"1964","3":"216","4":"950"},{"1":"Isbell","2":"1964","3":"189","4":"974"},{"1":"Betsy","2":"1965","3":"216","4":"941"},{"1":"Alma","2":"1966","3":"189","4":"982"},{"1":"Inez","2":"1966","3":"153","4":"983"},{"1":"Beulah","2":"1967","3":"216","4":"950"},{"1":"Gladys","2":"1968","3":"189","4":"977"},{"1":"Camille","2":"1969","3":"342","4":"909"},{"1":"Celia","2":"1970","3":"216","4":"945"},{"1":"Fern","2":"1971","3":"153","4":"979"},{"1":"Edith","2":"1971","3":"189","4":"978"},{"1":"Ginger","2":"1971","3":"153","4":"995"},{"1":"Agnes","2":"1972","3":"153","4":"980"},{"1":"Carmen","2":"1974","3":"216","4":"952"},{"1":"Eloise","2":"1975","3":"216","4":"955"},{"1":"Belle","2":"1976","3":"153","4":"980"},{"1":"Babe","2":"1977","3":"153","4":"995"},{"1":"Bob","2":"1979","3":"153","4":"986"},{"1":"David","2":"1979","3":"189","4":"970"},{"1":"Frederic","2":"1979","3":"216","4":"946"},{"1":"Allen","2":"1980","3":"207","4":"945"},{"1":"Alicia","2":"1983","3":"207","4":"962"},{"1":"Diana","2":"1984","3":"198","4":"949"},{"1":"Bob","2":"1985","3":"135","4":"1003"},{"1":"Danny","2":"1985","3":"162","4":"987"},{"1":"Elena","2":"1985","3":"207","4":"959"},{"1":"Gloria","2":"1985","3":"216","4":"942"},{"1":"Juan","2":"1985","3":"153","4":"971"},{"1":"Kate","2":"1985","3":"180","4":"967"},{"1":"Bonnie","2":"1986","3":"153","4":"990"},{"1":"Charley","2":"1986","3":"135","4":"990"},{"1":"Floyd","2":"1987","3":"135","4":"993"},{"1":"Florence","2":"1988","3":"144","4":"984"},{"1":"Chantal","2":"1989","3":"144","4":"986"},{"1":"Hugo","2":"1989","3":"252","4":"934"},{"1":"Jerry","2":"1989","3":"153","4":"983"},{"1":"Bob","2":"1991","3":"189","4":"962"},{"1":"Andrew","2":"1992","3":"306","4":"922"},{"1":"Emily","2":"1993","3":"207","4":"961"},{"1":"Erin","2":"1995","3":"180","4":"973"},{"1":"Opal","2":"1995","3":"207","4":"942"},{"1":"Bertha","2":"1996","3":"189","4":"974"},{"1":"Fran","2":"1996","3":"207","4":"954"},{"1":"Danny","2":"1997","3":"144","4":"984"},{"1":"Bonnie","2":"1998","3":"198","4":"964"},{"1":"Earl","2":"1998","3":"144","4":"987"},{"1":"Georges","2":"1998","3":"189","4":"964"},{"1":"Bret","2":"1999","3":"207","4":"951"},{"1":"Floyd","2":"1999","3":"189","4":"956"},{"1":"Irene","2":"1999","3":"144","4":"987"},{"1":"Lili","2":"2002","3":"162","4":"963"},{"1":"Claudette","2":"2003","3":"162","4":"979"},{"1":"Isabel","2":"2003","3":"189","4":"957"},{"1":"Alex","2":"2004","3":"144","4":"972"},{"1":"Charley","2":"2004","3":"270","4":"941"},{"1":"Gaston","2":"2004","3":"135","4":"985"},{"1":"Frances","2":"2004","3":"189","4":"960"},{"1":"Ivan","2":"2004","3":"216","4":"946"},{"1":"Jeanne","2":"2004","3":"216","4":"950"},{"1":"Cindy","2":"2005","3":"135","4":"991"},{"1":"Dennis","2":"2005","3":"216","4":"946"},{"1":"Katrina","2":"2005","3":"225","4":"920"},{"1":"Ophelia","2":"2005","3":"135","4":"982"},{"1":"Rita","2":"2005","3":"207","4":"937"},{"1":"Wilma","2":"2005","3":"216","4":"950"},{"1":"Humberto","2":"2007","3":"162","4":"985"},{"1":"Dolly","2":"2008","3":"153","4":"967"},{"1":"Gustav","2":"2008","3":"189","4":"954"},{"1":"Ike","2":"2008","3":"198","4":"950"},{"1":"Irene","2":"2011","3":"135","4":"952"},{"1":"Isaac","2":"2012","3":"144","4":"966"},{"1":"Sandy","2":"2012","3":"135","4":"942"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
</ul>
</div>
<div id="examinar-o-scatter-plot" class="section level3" number="15.7.1">
<h3>
<span class="header-section-number">15.7.1</span> Examinar o <em>scatter plot</em><a class="anchor" aria-label="anchor" href="#examinar-o-scatter-plot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb929"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grafico</span> <span class="op">&lt;-</span> <span class="va">furacoes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">pressao</span>, <span class="va">velocidade</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'pressão (mbar)'</span>,</span>
<span>      y <span class="op">=</span> <span class="st">'velocidade\nmáxima\n(km/h)'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Furacões'</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">grafico</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-469-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li><p>As duas variáveis são quantitativas.</p></li>
<li><p>A relação entre velocidade e pressão é aproximadamente linear.</p></li>
<li><p>Quanto maior a pressão, menor a velocidade. A correlação é negativa.</p></li>
<li><p>Há <span class="math inline">\(3\)</span> potenciais <em>outliers</em>, mas vamos prosseguir mesmo assim.</p></li>
<li><p>Os pontos parecem estar dispostos em filas horizontais. Isto é causado pela (falta de) precisão das velocidades, que são valores inteiros no conjunto de dados.</p></li>
</ul>
</div>
<div id="construir-o-modelo" class="section level3" number="15.7.2">
<h3>
<span class="header-section-number">15.7.2</span> Construir o modelo<a class="anchor" aria-label="anchor" href="#construir-o-modelo"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb930"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">velocidade</span> <span class="op">~</span> <span class="va">pressao</span>, data <span class="op">=</span> <span class="va">furacoes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = velocidade ~ pressao, data = furacoes)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -92,201  -8,841   0,326  12,777  57,604 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept) 1859,852    109,928   16,92 &lt;0,0000000000000002 ***
## pressao       -1,733      0,114  -15,21 &lt;0,0000000000000002 ***
## ---
## Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1
## 
## Residual standard error: 21,7 on 92 degrees of freedom
## Multiple R-squared:  0,7154, Adjusted R-squared:  0,7123 
## F-statistic: 231,3 on 1 and 92 DF,  p-value: &lt; 0,00000000000000022</code></pre>
<ul>
<li>
<p>A equação é</p>
<p><span class="math display">\[
\widehat{\text{velocidade}} = 1.859{,}85 + (-1{,}73) \cdot \text{pressão}
\]</span></p>
</li>
<li><p>A cada mbar de aumento na pressão está associada uma mudança de <span class="math inline">\(-1{,}73\)</span>km/h na velocidade.</p></li>
<li>
<p>Gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-472-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
</ul>
</div>
<div id="examinar-os-resíduos" class="section level3" number="15.7.3">
<h3>
<span class="header-section-number">15.7.3</span> Examinar os resíduos<a class="anchor" aria-label="anchor" href="#examinar-os-res%C3%ADduos"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>Histograma dos resíduos:</p>
<div class="sourceCode" id="cb932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_resid_hist.html">stat_resid_hist</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'resíduos (km/h)'</span>,</span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Histograma dos resíduos'</span></span>
<span>    <span class="op">)</span>      </span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-473-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Ignorando os <em>outliers</em> à esquerda, a distribuição dos resíduos é aproximadamente normal.</p></li>
<li>
<p>Incluindo todos os resíduos, o teste de normalidade é horrível:</p>
<div class="sourceCode" id="cb933"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://broom.tidymodels.org/reference/augment_columns.html">augment_columns</a></span><span class="op">(</span><span class="va">modelo</span>, data <span class="op">=</span> <span class="va">furacoes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0,92879, p-value = 0,00007165</code></pre>
</li>
<li>
<p>Eliminando os resíduos extremos à esquerda, o resultado é bom:</p>
<div class="sourceCode" id="cb935"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">.resid</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0,98682, p-value = 0,487</code></pre>
</li>
<li>
<p>Gráfico QQ dos resíduos:</p>
<div class="sourceCode" id="cb937"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_normal_qq.html">stat_normal_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'quantis da distribuição normal\n(desvios-padrão)'</span>,</span>
<span>      y <span class="op">=</span> <span class="st">'resíduos\npadronizados'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'QQ Normal'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-476-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Resíduos por valores estimados:</p>
<div class="sourceCode" id="cb938"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_fitted_resid.html">stat_fitted_resid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'resíduos\n(km/h)'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'velocidades estimadas (km/h)'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Resíduos por velocidades estimadas'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-477-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>As filas de pontos aparecem porque as velocidades são valores inteiros no conjunto de dados.</p></li>
<li><p>Quase todos os resíduos têm valor absoluto menor que <span class="math inline">\(50\)</span>km/h.</p></li>
<li>
<p>Vamos ver as exceções:</p>
<div class="sourceCode" id="cb939"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">nome</span>, <span class="va">ano</span>, <span class="va">pressao</span>, <span class="va">velocidade</span>, <span class="va">.fitted</span>, <span class="va">.resid</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["nome"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ano"],"name":[2],"type":["int"],"align":["right"]},{"label":["pressao"],"name":[3],"type":["int"],"align":["right"]},{"label":["velocidade"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Camille","2":"1969","3":"909","4":"342","5":"284,3955","6":"57,60448"},{"1":"Irene","2":"2011","3":"952","4":"135","5":"209,8690","6":"-74,86897"},{"1":"Sandy","2":"2012","3":"942","4":"135","5":"227,2007","6":"-92,20073"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li><p>A variância dos resíduos é menor para velocidades estimadas menores (no lado esquerdo do gráfico). À medida que a velocidade estimada aumenta, a variância aumenta também.</p></li>
<li><p>Esta variância não-constante afeta os resultados dos testes estatísticos sobre os coeficientes, um assunto que vamos abordar depois.</p></li>
</ul>
</div>
<div id="exercícios-22" class="section level3" number="15.7.4">
<h3>
<span class="header-section-number">15.7.4</span> Exercícios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-22"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>O que significa o intercepto de <span class="math inline">\(1.859{,}85\)</span>km/h?</p></li>
<li><p>Qual a previsão do modelo para a velocidade máxima de um furacão com pressão de <span class="math inline">\(925\)</span>mbar?</p></li>
<li>
<p>Na <em>tibble</em> <code>furacoes</code>, crie uma coluna <code>faixa</code> com os seguintes valores:</p>
<p><span class="math display">\[
\text{faixa} =
\begin{cases}
  \text{A} &amp;\text{ se velocidade estimada } &lt; 150  \\
  \text{B} &amp;\text{ se } 150 \leq \text{velocidade estimada } &lt; 200  \\
  \text{C} &amp;\text{ se velocidade estimada } \geq 200
\end{cases}
\]</span></p>
<p>Usando <code>group_by</code> e <code>summarize</code>, calcule a variância das velocidades estimadas de cada faixa. É verdade que, à medida que a velocidade estimada aumenta, a variância aumenta também?</p>
</li>
</ul>
</div>
</div>
<div id="exemplo-a-lei-de-moore" class="section level2" number="15.8">
<h2>
<span class="header-section-number">15.8</span> Exemplo: a lei de Moore<a class="anchor" aria-label="anchor" href="#exemplo-a-lei-de-moore"><i class="fas fa-link"></i></a>
</h2>
<div class="rmdbox">
<ul>
<li><p>A <a href="https://pt.wikipedia.org/wiki/Lei_de_Moore">lei de Moore</a> estima que, a cada dois anos, o número de transistores em um circuito integrado dobra.</p></li>
<li>
<p>Vamos usar o <em>dataset</em> em <a href="https://raw.githubusercontent.com/egarpor/handy/master/datasets/cpus.txt" class="uri">https://raw.githubusercontent.com/egarpor/handy/master/datasets/cpus.txt</a>, salvo localmente.</p>
<div class="sourceCode" id="cb940"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2</a></span><span class="op">(</span></span>
<span>  <span class="st">'data/cpus.csv'</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    processador <span class="op">=</span> <span class="va">Processor</span>,</span>
<span>    transistores <span class="op">=</span> <span class="st">'Transistor count'</span>,</span>
<span>    ano <span class="op">=</span> <span class="st">'Date of introduction'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">moore</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["processador"],"name":[1],"type":["chr"],"align":["left"]},{"label":["transistores"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ano"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"TMS 1000","2":"8000","3":"1971"},{"1":"Intel 4004","2":"2300","3":"1971"},{"1":"Intel 8008","2":"3500","3":"1972"},{"1":"MOS Technology 6502","2":"3510","3":"1975"},{"1":"Motorola 6800","2":"4100","3":"1974"},{"1":"Intel 8080","2":"4500","3":"1974"},{"1":"RCA 1802","2":"5000","3":"1974"},{"1":"Intel 8085","2":"6500","3":"1976"},{"1":"Zilog Z80","2":"8500","3":"1976"},{"1":"Motorola 6809","2":"9000","3":"1978"},{"1":"Intel 8086","2":"29000","3":"1978"},{"1":"Intel 8088","2":"29000","3":"1979"},{"1":"WDC 65C02","2":"11500","3":"1981"},{"1":"Intel 80186","2":"55000","3":"1982"},{"1":"Motorola 68000","2":"68000","3":"1979"},{"1":"Intel 80286","2":"134000","3":"1982"},{"1":"WDC 65C816","2":"22000","3":"1983"},{"1":"Motorola 68020","2":"190000","3":"1984"},{"1":"Intel 80386","2":"275000","3":"1985"},{"1":"ARM 1","2":"25000","3":"1985"},{"1":"Novix NC4016","2":"16000","3":"1985"},{"1":"ARM 2","2":"30000","3":"1986"},{"1":"TI Explorers 32-bit Lisp machine chip","2":"553000","3":"1987"},{"1":"DEC WRL MultiTitan","2":"180000","3":"1988"},{"1":"Intel i960","2":"250000","3":"1988"},{"1":"Intel 80486","2":"1180235","3":"1989"},{"1":"ARM 3","2":"300000","3":"1989"},{"1":"R4000","2":"1350000","3":"1991"},{"1":"ARM 6","2":"35000","3":"1991"},{"1":"Pentium","2":"3100000","3":"1993"},{"1":"ARM700","2":"578977","3":"1994"},{"1":"SA-110","2":"2500000","3":"1995"},{"1":"ARM 9TDMI","2":"111000","3":"1999"},{"1":"Pentium Pro","2":"5500000","3":"1995"},{"1":"AMD K5","2":"4300000","3":"1996"},{"1":"Pentium II Klamath","2":"7500000","3":"1997"},{"1":"Pentium II Deschutes","2":"7500000","3":"1998"},{"1":"AMD K6","2":"8800000","3":"1997"},{"1":"Pentium III Katmai","2":"9500000","3":"1999"},{"1":"Pentium III Coppermine","2":"21000000","3":"2000"},{"1":"Pentium II Mobile Dixon","2":"27400000","3":"1999"},{"1":"Pentium III Tualatin","2":"45000000","3":"2001"},{"1":"AMD K6-III","2":"21300000","3":"1999"},{"1":"AMD K7","2":"22000000","3":"1999"},{"1":"Pentium 4 Willamette","2":"42000000","3":"2000"},{"1":"Pentium 4 Northwood","2":"55000000","3":"2002"},{"1":"Pentium 4 Prescott","2":"112000000","3":"2004"},{"1":"Pentium 4 Prescott-2M","2":"169000000","3":"2005"},{"1":"Pentium 4 Cedar Mill","2":"184000000","3":"2006"},{"1":"Pentium D Smithfield","2":"228000000","3":"2005"},{"1":"Pentium D Presler","2":"362000000","3":"2006"},{"1":"Atom","2":"47000000","3":"2008"},{"1":"Barton","2":"54300000","3":"2003"},{"1":"AMD K8","2":"105900000","3":"2003"},{"1":"Itanium 2 McKinley","2":"220000000","3":"2002"},{"1":"Cell","2":"241000000","3":"2006"},{"1":"Core 2 Duo Conroe","2":"291000000","3":"2006"},{"1":"Core 2 Duo Allendale","2":"169000000","3":"2007"},{"1":"Itanium 2 Madison 6M","2":"410000000","3":"2003"},{"1":"AMD K10 quad-core 2M L3","2":"463000000","3":"2007"},{"1":"ARM Cortex-A9","2":"26000000","3":"2007"},{"1":"Core 2 Duo Wolfdale 3M","2":"230000000","3":"2008"},{"1":"Itanium 2 with 9 MB cache","2":"592000000","3":"2004"},{"1":"Core 2 Duo Wolfdale","2":"411000000","3":"2007"},{"1":"Core i7 (Quad)","2":"731000000","3":"2008"},{"1":"AMD K10 quad-core 6M L3","2":"758000000","3":"2008"},{"1":"POWER6","2":"789000000","3":"2007"},{"1":"Six-core Opteron 2400","2":"904000000","3":"2009"},{"1":"16-core SPARC T3","2":"1000000000","3":"2010"},{"1":"Apple A7 (dual-core ARM64 \"mobile SoC\")","2":"1000000000","3":"2013"},{"1":"Quad-core + GPU Core i7","2":"1160000000","3":"2011"},{"1":"Six-core Core i7 (Gulftown)","2":"1170000000","3":"2010"},{"1":"8-core POWER7 32M L3","2":"1200000000","3":"2010"},{"1":"8-core AMD Bulldozer","2":"1200000000","3":"2012"},{"1":"Quad-core + GPU AMD Trinity","2":"1303000000","3":"2012"},{"1":"Quad-core z196","2":"1400000000","3":"2010"},{"1":"Quad-core + GPU Core i7 Ivy Bridge","2":"1400000000","3":"2012"},{"1":"Quad-core + GPU Core i7 Haswell","2":"1400000000","3":"2014"},{"1":"Dual-core Itanium 2","2":"1700000000","3":"2006"},{"1":"Quad-core + GPU GT2 Core i7 Skylake K","2":"1750000000","3":"2015"},{"1":"Six-core Core i7 Ivy Bridge E","2":"1860000000","3":"2013"},{"1":"Duo-core + GPU Iris Core i7 Broadwell-U","2":"1900000000","3":"2015"},{"1":"Six-core Xeon 7400","2":"1900000000","3":"2008"},{"1":"Quad-core Itanium Tukwila","2":"2000000000","3":"2010"},{"1":"Apple A8 (dual-core ARM64 mobile SoC)","2":"2000000000","3":"2014"},{"1":"8-core POWER7+ 80 MB L3 cache","2":"2100000000","3":"2012"},{"1":"Six-core Core i7/8-core Xeon E5 (Sandy Bridge-E/EP)","2":"2270000000","3":"2011"},{"1":"8-core Xeon Nehalem-EX","2":"2300000000","3":"2010"},{"1":"8-core Core i7 Haswell-E","2":"2600000000","3":"2014"},{"1":"10-core Xeon Westmere-EX","2":"2600000000","3":"2011"},{"1":"Six-core zEC12","2":"2750000000","3":"2012"},{"1":"Apple A8X (tri-core ARM64 \"mobile SoC\")","2":"3000000000","3":"2014"},{"1":"8-core Itanium Poulson","2":"3100000000","3":"2012"},{"1":"IBM z13","2":"3990000000","3":"2015"},{"1":"12-core POWER8","2":"4200000000","3":"2013"},{"1":"15-core Xeon Ivy Bridge-EX","2":"4310000000","3":"2014"},{"1":"61-core Xeon Phi","2":"5000000000","3":"2012"},{"1":"Xbox One main SoC","2":"5000000000","3":"2013"},{"1":"18-core Xeon Haswell-E5","2":"5560000000","3":"2014"},{"1":"IBM z13 Storage Controller","2":"7100000000","3":"2015"},{"1":"22-core Xeon Broadwell-E5","2":"7200000000","3":"2016"},{"1":"SPARC M7","2":"10000000000","3":"2015"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li><p>Usando regressão linear, <span class="hl">podemos confirmar a lei de Moore para estes dados?</span></p></li>
</ul>
</div>
<div id="examinar-o-scatter-plot-1" class="section level3" number="15.8.1">
<h3>
<span class="header-section-number">15.8.1</span> Examinar o <em>scatter plot</em><a class="anchor" aria-label="anchor" href="#examinar-o-scatter-plot-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb941"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb942"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ano</span>, <span class="va">transistores</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1e-9</span>, decimal.mark <span class="op">=</span> <span class="st">','</span>, suffix <span class="op">=</span> <span class="st">'M'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-481-1.png" width="100%" style="display: block; margin: auto;"></div>
<ul>
<li><p>Como já era de se esperar (pelo próprio enunciado da lei!) <span class="hl">a relação não é linear, mas sim exponencial.</span></p></li>
<li>
<p>Então, vamos usar o <span class="hl">logaritmo</span> do número de transistores:</p>
<div class="sourceCode" id="cb943"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moore</span> <span class="op">&lt;-</span> <span class="va">moore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ltransistores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">transistores</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb944"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grafico</span> <span class="op">&lt;-</span> <span class="va">moore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ano</span>, <span class="va">ltransistores</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\log_{10}$ (transistores)'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">grafico</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-483-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Agora, sim. Bem melhor.</p></li>
</ul>
</div>
<div id="construir-o-modelo-1" class="section level3" number="15.8.2">
<h3>
<span class="header-section-number">15.8.2</span> Construir o modelo<a class="anchor" aria-label="anchor" href="#construir-o-modelo-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb945"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ltransistores</span> <span class="op">~</span> <span class="va">ano</span>, data <span class="op">=</span> <span class="va">moore</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ltransistores ~ ano, data = moore)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2,22795 -0,14242  0,07515  0,22671  0,89568 
## 
## Coefficients:
##                Estimate  Std. Error t value            Pr(&gt;|t|)    
## (Intercept) -295,858219    6,843549  -43,23 &lt;0,0000000000000002 ***
## ano            0,151642    0,003422   44,31 &lt;0,0000000000000002 ***
## ---
## Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1
## 
## Residual standard error: 0,4556 on 100 degrees of freedom
## Multiple R-squared:  0,9515, Adjusted R-squared:  0,9511 
## F-statistic:  1963 on 1 and 100 DF,  p-value: &lt; 0,00000000000000022</code></pre>
<ul>
<li>
<p>A equação é</p>
<p><span class="math display">\[
\widehat{\text{log(transistores)}} = -295{,}86 + 0{,}15 \cdot \text{ano}
\]</span></p>
</li>
<li><p>A equação diz que, a cada <span class="math inline">\(2\)</span> anos, o <span class="hl">logaritmo do número de transistores</span> (na base <span class="math inline">\(10\)</span>) aumenta de <span class="math inline">\(0{,}30\)</span>.</p></li>
<li>
<p>Chamando de <span class="math inline">\(t(n)\)</span> o número de transistores no ano <span class="math inline">\(n\)</span>, a equação diz que:</p>
<p><span class="math display">\[
\begin{align*}
  \log t(n + 2) = \log t(n) + 0{,}30
  &amp; \implies
    t(n + 2) = t(n) \cdot 10^{0{,}30}
  &amp; \text{(elevando }10\text{ a cada lado)} \\
  &amp; \implies
    t(n + 2) = 2{,}01 \cdot t(n)
\end{align*}
\]</span></p>
</li>
<li><p>Isto corresponde ao que a lei de Moore diz: a cada <span class="math inline">\(2\)</span> anos, o número de transistores aproximadamente dobra.</p></li>
<li>
<p>O gráfico fica:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-487-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
</ul>
</div>
<div id="examinar-os-resíduos-1" class="section level3" number="15.8.3">
<h3>
<span class="header-section-number">15.8.3</span> Examinar os resíduos<a class="anchor" aria-label="anchor" href="#examinar-os-res%C3%ADduos-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>Histograma dos resíduos:</p>
<div class="sourceCode" id="cb948"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_resid_hist.html">stat_resid_hist</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'resíduos'</span>,</span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Histograma dos resíduos'</span></span>
<span>    <span class="op">)</span>      </span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-488-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Ignorando os <em>outliers</em> à esquerda, a distribuição dos resíduos é aproximadamente normal.</p></li>
<li><p>Um resíduo de <span class="math inline">\(-1\)</span> no logaritmo (na base <span class="math inline">\(10\)</span>) do número de transistores equivale a <span class="math inline">\(\frac{1}{10}\)</span> do número de transistores estimado pela regressão.</p></li>
<li><p>Um resíduo de <span class="math inline">\(-2\)</span> no logaritmo (na base <span class="math inline">\(10\)</span>) do número de transistores equivale a <span class="math inline">\(\frac{1}{100}\)</span> do número de transistores estimado pela regressão.</p></li>
<li>
<p>Teste de normalidade com todos os resíduos:</p>
<div class="sourceCode" id="cb949"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://broom.tidymodels.org/reference/augment_columns.html">augment_columns</a></span><span class="op">(</span><span class="va">modelo</span>, data <span class="op">=</span> <span class="va">moore</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0,87608, p-value = 0,0000000991</code></pre>
</li>
<li>
<p>Sem os <em>outliers</em>:</p>
<div class="sourceCode" id="cb951"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">.resid</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0,97828, p-value = 0,1236</code></pre>
</li>
<li>
<p>Gráfico QQ dos resíduos:</p>
<div class="sourceCode" id="cb953"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_normal_qq.html">stat_normal_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">'quantis da distribuição normal\n(desvios-padrão)'</span>,</span>
<span>      y <span class="op">=</span> <span class="st">'resíduos\npadronizados'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'QQ Normal'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-491-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li><p>Aqui também ficam nítidos os <em>outliers</em> à esquerda.</p></li>
<li>
<p>Resíduos por valores estimados:</p>
<div class="sourceCode" id="cb954"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gglm/man/stat_fitted_resid.html">stat_fitted_resid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">'resíduos'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'log(transistores) estimado'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Resíduos por valores estimados'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-492-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>De novo, os <em>outliers</em> são óbvios. Vamos listar as CPUs com resíduo menor que <span class="math inline">\(-0{,}5\)</span>:</p>
<div class="sourceCode" id="cb955"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dados_aumentados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">.resid</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">processador</span>, <span class="va">transistores</span>, <span class="va">ano</span>, <span class="va">ltransistores</span>, <span class="va">.fitted</span>, <span class="va">.resid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["processador"],"name":[1],"type":["chr"],"align":["left"]},{"label":["transistores"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ano"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ltransistores"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"ARM 9TDMI","2":"111000","3":"1999","4":"5,045323","5":"7,273277","6":"-2,2279540"},{"1":"ARM 6","2":"35000","3":"1991","4":"4,544068","5":"6,060144","6":"-1,5160763"},{"1":"ARM Cortex-A9","2":"26000000","3":"2007","4":"7,414973","5":"8,486409","6":"-1,0714361"},{"1":"Atom","2":"47000000","3":"2008","4":"7,672098","5":"8,638051","6":"-0,9659532"},{"1":"Novix NC4016","2":"16000","3":"1985","4":"4,204120","5":"5,150295","6":"-0,9461750"},{"1":"ARM 2","2":"30000","3":"1986","4":"4,477121","5":"5,301937","6":"-0,8248153"},{"1":"ARM700","2":"578977","3":"1994","4":"5,762661","5":"6,515069","6":"-0,7524078"},{"1":"ARM 1","2":"25000","3":"1985","4":"4,397940","5":"5,150295","6":"-0,7523550"},{"1":"WDC 65C816","2":"22000","3":"1983","4":"4,342423","5":"4,847012","6":"-0,5045892"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
<li><p>Além disso, parece haver uma certa curvatura na nuvem de pontos, e os resíduos parecem não ter variância constante.</p></li>
</ul>
</div>
<div id="exercícios-23" class="section level3" number="15.8.4">
<h3>
<span class="header-section-number">15.8.4</span> Exercícios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-23"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Faça uma pesquisa <em>online</em> e tente descobrir se há algum motivo específico para a maioria dos <em>outliers</em> ser de processadores ARM.</p></li>
<li><p>Faça uma pesquisa <em>online</em> sobre processadores lançados nos anos de <span class="math inline">\(2017\)</span>, <span class="math inline">\(2018\)</span>, <span class="math inline">\(2019\)</span>, <span class="math inline">\(2020\)</span> e <span class="math inline">\(2021\)</span> (no mínimo um processador de cada ano); compare as quantidades de transistores dos processadores que você achou com as quantidades de transistores previstas para eles pelo modelo linear.</p></li>
<li>
<p>A lei de Moore vale para estas <span class="hl">GPUs</span>?</p>
<div class="sourceCode" id="cb956"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpus</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2</a></span><span class="op">(</span><span class="st">'data/gpus.csv'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    processador <span class="op">=</span> <span class="va">Processor</span>,</span>
<span>    transistores <span class="op">=</span> <span class="st">'Transistor count'</span>,</span>
<span>    ano <span class="op">=</span> <span class="st">'Date of introduction'</span>,</span>
<span>    fabricante <span class="op">=</span> <span class="va">Manufacturer</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">gpus</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["processador"],"name":[1],"type":["chr"],"align":["left"]},{"label":["transistores"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ano"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["fabricante"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"NV3","2":"3500000","3":"1997","4":"NVIDIA"},{"1":"Rage 128","2":"8000000","3":"1999","4":"AMD"},{"1":"NV5","2":"15000000","3":"1999","4":"Nvidia"},{"1":"NV10","2":"23000000","3":"1999","4":"Nvidia"},{"1":"NV11","2":"20000000","3":"2000","4":"Nvidia"},{"1":"NV15","2":"25000000","3":"2000","4":"Nvidia"},{"1":"R100","2":"30000000","3":"2000","4":"AMD"},{"1":"NV20","2":"57000000","3":"2001","4":"Nvidia"},{"1":"R200","2":"60000000","3":"2001","4":"AMD"},{"1":"NV25","2":"63000000","3":"2002","4":"Nvidia"},{"1":"R300","2":"107000000","3":"2002","4":"AMD"},{"1":"R360","2":"117000000","3":"2003","4":"AMD"},{"1":"NV38","2":"135000000","3":"2003","4":"Nvidia"},{"1":"R480","2":"160000000","3":"2004","4":"AMD"},{"1":"NV40","2":"222000000","3":"2004","4":"Nvidia"},{"1":"G70","2":"303000000","3":"2005","4":"Nvidia"},{"1":"R520","2":"321000000","3":"2005","4":"AMD"},{"1":"R580","2":"384000000","3":"2006","4":"AMD"},{"1":"G80","2":"681000000","3":"2006","4":"Nvidia"},{"1":"R600","2":"700000000","3":"2007","4":"AMD"},{"1":"G92","2":"754000000","3":"2007","4":"Nvidia"},{"1":"RV790","2":"959000000","3":"2008","4":"AMD"},{"1":"GT200 Tesla","2":"1400000000","3":"2008","4":"Nvidia"},{"1":"Cypress RV870","2":"2154000000","3":"2009","4":"AMD"},{"1":"Cayman RV970","2":"2640000000","3":"2010","4":"AMD"},{"1":"GF100 Fermi","2":"3200000000","3":"2010","4":"Nvidia"},{"1":"GF110 Fermi","2":"3000000000","3":"2010","4":"Nvidia"},{"1":"GK104 Kepler","2":"3540000000","3":"2012","4":"Nvidia"},{"1":"Tahiti","2":"4312711873","3":"2011","4":"AMD"},{"1":"GK110 Kepler","2":"7080000000","3":"2012","4":"Nvidia"},{"1":"Hawaii","2":"6300000000","3":"2013","4":"AMD"},{"1":"GM204 Maxwell","2":"5200000000","3":"2014","4":"Nvidia"},{"1":"GM200 Maxwell","2":"8100000000","3":"2015","4":"Nvidia"},{"1":"Fiji","2":"8900000000","3":"2015","4":"AMD"},{"1":"GP100 Pascal","2":"15300000000","3":"2016","4":"Nvidia"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</li>
</ul>
</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

init_exercises = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

$(init_exercises)

</script><div class="chapter-nav">
<div class="prev"><a href="corr.html"><span class="header-section-number">14</span> Covariância e correlação</a></div>
<div class="next"><a href="refer%C3%AAncias.html">Referências</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta página"><h2>Nesta página</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#regr"><span class="header-section-number">15</span> Regressão linear</a></li>
<li><a class="nav-link" href="#v%C3%ADdeo-7"><span class="header-section-number">15.1</span> Vídeo</a></li>
<li><a class="nav-link" href="#exemplo-altura-e-peso-1"><span class="header-section-number">15.2</span> Exemplo: altura e peso</a></li>
<li>
<a class="nav-link" href="#como-achar-a-equa%C3%A7%C3%A3o-da-melhor-reta-com-c%C3%A1lculo"><span class="header-section-number">15.3</span> Como achar a equação da melhor reta? Com Cálculo!</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#exerc%C3%ADcios-21"><span class="header-section-number">15.3.1</span> Exercícios</a></li></ul>
</li>
<li>
<a class="nav-link" href="#em-r-20"><span class="header-section-number">15.4</span> Em R</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#no-tidyverse"><span class="header-section-number">15.4.1</span> No Tidyverse</a></li></ul>
</li>
<li><a class="nav-link" href="#avaliando-o-modelo-atrav%C3%A9s-dos-res%C3%ADduos"><span class="header-section-number">15.5</span> Avaliando o modelo através dos resíduos</a></li>
<li><a class="nav-link" href="#condi%C3%A7%C3%B5es-para-usar-regress%C3%A3o-linear"><span class="header-section-number">15.6</span> Condições para usar regressão linear</a></li>
<li>
<a class="nav-link" href="#exemplo-furac%C3%B5es"><span class="header-section-number">15.7</span> Exemplo: furacões</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#examinar-o-scatter-plot"><span class="header-section-number">15.7.1</span> Examinar o scatter plot</a></li>
<li><a class="nav-link" href="#construir-o-modelo"><span class="header-section-number">15.7.2</span> Construir o modelo</a></li>
<li><a class="nav-link" href="#examinar-os-res%C3%ADduos"><span class="header-section-number">15.7.3</span> Examinar os resíduos</a></li>
<li><a class="nav-link" href="#exerc%C3%ADcios-22"><span class="header-section-number">15.7.4</span> Exercícios</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exemplo-a-lei-de-moore"><span class="header-section-number">15.8</span> Exemplo: a lei de Moore</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#examinar-o-scatter-plot-1"><span class="header-section-number">15.8.1</span> Examinar o scatter plot</a></li>
<li><a class="nav-link" href="#construir-o-modelo-1"><span class="header-section-number">15.8.2</span> Construir o modelo</a></li>
<li><a class="nav-link" href="#examinar-os-res%C3%ADduos-1"><span class="header-section-number">15.8.3</span> Examinar os resíduos</a></li>
<li><a class="nav-link" href="#exerc%C3%ADcios-23"><span class="header-section-number">15.8.4</span> Exercícios</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/fnaufel/probestr/blob/master/regr.Rmd">Ver código-fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/fnaufel/probestr/edit/master/regr.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Probabilidade e Estatística com R</strong>" por Fernando Náufel (versão de 22/11/2023)</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Criado com o <a class="text-light" href="https://bookdown.org">pacote bookdown</a> do R.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
