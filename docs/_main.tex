% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  11pt]{report}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Probabilidade e Estatística com R},
  pdfauthor={Fernando Náufel},
  pdflang={pt-br},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
\ifLuaTeX
\usepackage[bidi=basic]{babel}
\else
\usepackage[bidi=default]{babel}
\fi
\babelprovide[main,import]{brazilian}
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}

% A command to save the path to the resources of bd.format (fnaufel)
\newcommand{\dir}{/ssd/R/x86_64-pc-linux-gnu-library/4.3/fnaufelRmd/rmarkdown/resources}



\hypersetup{
  colorlinks,
  breaklinks,
  linkcolor=magenta,
  urlcolor=blue
}

% Lexend font
\usepackage{lexend}


% Para bibliografia em português
\usepackage{babelbib}

% Para títulos de capítulos e seções:
\usepackage[nobottomtitles*]{titlesec}

%%%%%%%%%%%%%%%
%
% Titulos de capítulos e seções

\titleformat{\chapter}[display]%
{\bfseries\Large}%
{\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}%
{4ex}%
{\titlerule%
  \vspace{2ex}%
  \filright}%
[\vspace{2ex}%
\titlerule%
\vspace{10ex}]

\titleformat{\section}[block]%
{\bfseries\Large}%
{\thesection}{.5em}{\titlerule\\[.8ex]\bfseries}

\titleformat{\subsection}[block]%
{\bfseries}%
{\thesubsection}{.5em}{\titlerule\\[.8ex]\bfseries}%
[\vspace{1ex}]

\titleformat{\subsubsection}[block]%
{\itshape}%
{\thesubsubsection}{.5em}{\titlerule\\[.8ex]\itshape}%
[\vspace{1ex}]

\titleformat{\paragraph}[block]%
{\itshape}%
{\theparagraph}{.5em}{\\[.8ex]\itshape}%
[\vspace{1ex}]


%%%%%%%%%%%%%%%
%
% Caixas

\usepackage{tcolorbox}
\tcbuselibrary{breakable}
\tcbuselibrary{skins}

\tcbset{
  enhanced,
  rounded corners,
  boxrule=0.3mm,
  colback=black!.5!white,
  parbox=false,
  /tcb/breakable=true
}

\newtcolorbox{rmdbox}{
  colframe=black!40!white,
}


\newtcolorbox{mycaution}{
  colframe=red!75!black,
  sidebyside,
  lower separated=false,
  lefthand width=1cm,
  sidebyside gap=4mm
}

\newenvironment{rmdcaution}
{
  \begin{mycaution}
    \includegraphics[width=.8cm]{\dir/images/caution.png}
    \tcblower
  }
  {
  \end{mycaution}
}

\newtcolorbox{myimportant}{
  colframe=green!75!black,
  sidebyside,
  lower separated=false,
  lefthand width=1cm,
  sidebyside gap=4mm
}

\newenvironment{rmdimportant}
{
  \begin{myimportant}
    \includegraphics[width=.8cm]{\dir/images/important.png}
    \tcblower
  }
  {
  \end{myimportant}
}

\newtcolorbox{mywarning}{
  colframe=yellow!80!black,
  sidebyside,
  lower separated=false,
  lefthand width=1cm,
  sidebyside gap=4mm
}

\newenvironment{rmdwarning}
{
  \begin{mywarning}
    \includegraphics[width=.8cm]{\dir/images/warning.png}
    \tcblower
  }
  {
  \end{mywarning}
}

\newtcolorbox{mynote}{
  colframe=yellow!70!black,
  sidebyside,
  lower separated=false,
  lefthand width=1cm,
  sidebyside gap=4mm
}

\newenvironment{rmdnote}
{
  \begin{mynote}
    \includegraphics[width=.8cm]{\dir/images/note.png}
    \tcblower
  }
  {
  \end{mynote}
}

\newtcolorbox{mytip}{
  colframe=blue!50!white,
  sidebyside,
  lower separated=false,
  lefthand width=1cm,
  sidebyside gap=4mm
}

\newenvironment{rmdtip}
{
  \begin{mytip}
    \includegraphics[width=.8cm]{\dir/images/tip.png}
    \tcblower
  }
  {
  \end{mytip}
}

% For highlighting using \hl{}
\usepackage{soul}


\makeatletter
\@ifundefined{Shaded}{}{
  % Code chunks and output
  \usepackage[framemethod=pgf]{mdframed}
  \renewenvironment{Shaded}{
    \begin{mdframed}[%
      roundcorner=2pt,%
      innerleftmargin=5pt,%
      innerrightmargin=5pt,%
      topline=true,%
      leftline=true,%
      rightline=true,%
      bottomline=true,%
      linewidth=0.5pt,%
      linecolor=black!20,%
      backgroundcolor=black!2,%
      skipabove=2ex,%
      skipbelow=2.5ex%
    ]%
  }
  {
    \end{mdframed}
  }
}
\makeatother

% Use tt in tables
\usepackage{longtable}
\let\oldlongtable\longtable
\let\endoldlongtable\endlongtable
\renewenvironment{longtable}{\tt\oldlongtable}{\endoldlongtable}


% End of preamble for bookdowntemplate01

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{caption}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Probabilidade e Estatística com R}
\author{Fernando Náufel}
\date{(versão de 12/05/2023)}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{apresentacao}{%
\chapter*{Apresentação}\label{apresentacao}}
\addcontentsline{toc}{chapter}{Apresentação}

\begin{rmdcaution}
\textbf{Atenção}

Este material ainda está em construção.

Pode haver mudanças a qualquer momento.

Verifique, no rodapé da página \emph{web} ou na capa do arquivo pdf, a data desta versão.

\end{rmdcaution}

\newpage

\includegraphics{images/640px-Nightingale-mortality.jpg}

\vspace{2cm}

Este livro/\emph{site} foi iniciado em 2020, durante a pandemia de COVID-19, quando a Universidade Federal Fluminense (UFF) funcionou em regime de ensino remoto durante mais de um ano.

Para atender os alunos do curso de Probabilidade e Estatística do curso de graduação em Ciência da Computação da UFF, decidi gravar aulas em vídeo e disponibilizar os arquivos usados nelas. Foram esses arquivos que deram origem a este livro/\emph{site}.

Este livro/\emph{site} foi construído para pessoas que já saibam programar, embora não necessariamente em R.

Para tirar o máximo proveito deste material, você deve fazer o seguinte:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Assistir aos vídeos contidos em cada capítulo. A \emph{playlist} completa está em \url{https://www.youtube.com/playlist?list=PL7SRLwLs7ocaV-Y1vrVU3W7mZnnS0qkWV}.
\item
  Instalar o R no seu computador ou abrir uma conta no RStudio Cloud, para poder usar o R \emph{online}. Você encontra instruções para fazer isto no \protect\hyperlink{rintro}{capítulo de introdução a R}.
\item
  Baixar, \href{https://github.com/fnaufel/probestr}{neste repositório do Github}, o código-fonte deste livro/\emph{site}, para poder rodar e alterar os exemplos.
\item
  Seguir os \emph{links} para outras fontes \emph{online} que abordam assuntos que não são cobertos em detalhes neste curso.
\item
  Fazer os exercícios. Ao longo do tempo, acrescentarei \emph{links} para vídeos explicando as soluções.
\end{enumerate}

\begin{rmdimportant}
{\hl{Se você estiver lendo este material na \emph{web}, você pode clicar nos comandos e funções que aparecem nos blocos de código em R}} para abrir páginas da documentação sobre eles.

Se você preferir ler este livro em pdf, ou se quiser imprimi-lo, \href{https://github.com/fnaufel/probestr/blob/master/docs/probestr.pdf}{faça o \emph{download} do arquivo aqui}.

\end{rmdimportant}

\hypertarget{refrec}{%
\section*{Referências recomendadas}\label{refrec}}
\addcontentsline{toc}{section}{Referências recomendadas}

\hypertarget{em-portuguuxeas}{%
\subsection*{Em português}\label{em-portuguuxeas}}
\addcontentsline{toc}{subsection}{Em português}

\begin{itemize}
\item
  Sillas Gonzaga, \emph{Introdução a R para Visualização e Apresentação de Dados},
  \url{http://sillasgonzaga.com/material/curso_visualizacao/index.html}
\item
  Allan Vieira de Castro Quadros, \emph{Introdução à Análise de Dados em R utilizando Tidyverse}, \url{https://allanvc.github.io/book_IADR-T/}
\item
  Paulo Felipe de Oliveira, Saulo Guerra, Robert McDonnel, \emph{Ciência de Dados com R -- Introdução}, \url{https://cdr.ibpad.com.br/index.html}
\item
  Curso R, \emph{Ciência de Dados em R}, \url{https://livro.curso-r.com/}
\end{itemize}

\hypertarget{em-ingluxeas}{%
\subsection*{Em inglês}\label{em-ingluxeas}}
\addcontentsline{toc}{subsection}{Em inglês}

\begin{itemize}
\item
  Garrett Grolemund, Hadley Wickham, \emph{R for Data Science}, \url{https://r4ds.had.co.nz/}
\item
  Chester Ismay, Albert Y. Kim, \emph{A ModernDive into R and the Tidyverse}, \url{https://moderndive.com/}
\end{itemize}

\hypertarget{exercuxedcio}{%
\section*{Exercício}\label{exercuxedcio}}
\addcontentsline{toc}{section}{Exercício}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Pesquise sobre a imagem do início deste capítulo. Ela foi criada em 1858 por Florence Nightingale.
\end{enumerate}

\hypertarget{oque}{%
\chapter{O Que É Estatística?}\label{oque}}

\hypertarget{vuxeddeo-1}{%
\section{Vídeo 1}\label{vuxeddeo-1}}

\begin{center} \url{https://youtu.be/6Q_XSoLCIpc} \end{center}

\hypertarget{exercuxedcios}{%
\section{Exercícios}\label{exercuxedcios}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Você está interessado em estimar a altura de todos os homens da sua faculdade. Para isso, você decide medir as alturas de todos os homens da sua turma de Estatística.

  \begin{itemize}
  \tightlist
  \item
    Qual é a amostra?
  \item
    Qual é a população?
  \end{itemize}
\item
  Um instituto de pesquisa entrevista um grupo de $1000$ pessoas, perguntando a cada uma se ela vai votar a favor do candidato $A$ na próxima eleição. Dos entrevistados, $600$ responderam que sim. A proporção $0{,}6$ (ou $60\%$) é uma estatística ou um parâmetro?
\item
  Você vê alguma diferença entre as cinco situações abaixo? Quais das situações são equivalentes em termos da probabilidade de conseguir $10$ cartas do mesmo naipe?

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    Usando um baralho normal, você retira $10$ cartas e registra as cartas retiradas.
  \item
    Usando um baralho normal, você repete a seguinte sequência de ações $10$ vezes: retirar uma carta do baralho, registrar a carta retirada e repor a carta no baralho.
  \item
    Usando uma caixa contendo todas as cartas de $1$ milhão de baralhos reunidos, você retira $10$ cartas e registra as cartas retiradas.
  \item
    Usando uma caixa contendo todas as cartas de $1$ milhão de baralhos reunidos, você repete a seguinte sequência de ações $10$ vezes: retirar uma carta da caixa, registrar a carta retirada e repor a carta na caixa.
  \item
    Usando um baralho \emph{infinito}, você retira $10$ cartas e registra as cartas retiradas.
  \item
    Usando um baralho \emph{infinito}, você repete a seguinte sequência de ações $10$ vezes: retirar uma carta do baralho, registrar a carta retirada e repor a carta no baralho.
  \end{enumerate}
\item
  Qual a graça dos quadrinhos na Figura \ref{fig:xkcd-cor}, que também \href{https://youtu.be/6Q_XSoLCIpc?t=1385}{aparecem no vídeo}?

  \begin{figure}

   {\centering \includegraphics[width=0.9\linewidth]{images/correlation-pt-600} 

   }

   \caption{\url{http://xkcd.com/552/}}\label{fig:xkcd-cor}
   \end{figure}
\item
  Qual a graça dos quadrinhos na Figura \ref{fig:xkcd-blind}?

  \begin{figure}

   {\centering \includegraphics[width=0.5\linewidth]{images/double-blind} 

   }

   \caption{\url{http://xkcd.com/1462/}}\label{fig:xkcd-blind}
   \end{figure}
\item
  Veja este vídeo sobre o cavalo Hans:

  \begin{center} \url{https://youtu.be/G3VkCmdUfZE} \end{center}

  Qual a relação entre esta história e a necessidade de duplo cegamento?
\end{enumerate}





\hypertarget{niveis-de-dados}{%
\section{Vídeo 2}\label{niveis-de-dados}}

\begin{center} \url{https://youtu.be/492VASxlDRo} \end{center}

\hypertarget{exercuxedcios-1}{%
\section{Exercícios}\label{exercuxedcios-1}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Por que não faz sentido calcular a média dos CEPs de um grupo de pessoas?
\item
  Uma temperatura de $-40$ graus Celsius é igual a uma temperatura de $-40$ graus Fahrenheit?
\item
  Uma temperatura de zero graus Celsius é igual a uma temperatura de zero graus Fahrenheit?
\item
  Uma variação de temperatura de $1$ grau Celsius é igual a uma variação de temperatura de $1$ grau Fahrenheit?
\item
  Um saldo bancário de zero reais é igual a um saldo bancário de zero dólares?
\item
  Um produto de $1$ milhão de reais custa o mesmo que um produto de $1$ milhão de dólares?
\item
  Meses representados por números de $1$ a $12$ são dados de que nível?
\end{enumerate}

\hypertarget{rintro}{%
\chapter{Introdução a R}\label{rintro}}

\hypertarget{vuxeddeo-1-1}{%
\section{Vídeo 1}\label{vuxeddeo-1-1}}

\begin{center} \url{https://youtu.be/1kXQDNqm41c} \end{center}

\hypertarget{usando-o-rstudio}{%
\section{Usando o RStudio}\label{usando-o-rstudio}}

Leia uma introdução ao R e ao RStudio no livro \href{https://www.ibpad.com.br/o-que-fazemos/publicacoes/introducao-ciencia-de-dados-com-r}{Ciência de Dados com R}.

Ali, você vai encontrar \emph{exemplos} e \textbf{exercícios}.

\hypertarget{rmarkdown}{%
\section{RMarkdown}\label{rmarkdown}}

Para ver uma referência sobre a sintaxe do RMarkdown, vá ao menu \texttt{Help} do RStudio, escolha \texttt{Cheatsheets} e, a seguir, \texttt{R\ Markdown\ Cheat\ Sheet} ou \texttt{R\ Markdown\ Reference\ Guide}.

\hypertarget{apresentauxe7uxe3o}{%
\section{Apresentação}\label{apresentauxe7uxe3o}}

R é várias linguagens em uma:

\begin{itemize}
\item
  R base,
\item
  OO (S3),
\item
  OO (S4),
\item
  Tidyverse (pacote usado para Ciência de Dados e gráficos).
\end{itemize}

\hypertarget{tudo-uxe9-vetor}{%
\section{Tudo é vetor}\label{tudo-uxe9-vetor}}

\begin{itemize}
\item
  Usamos a função \texttt{c()} (\emph{concatenate}) para criar vetores:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vetor }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{0}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\NormalTok{vetor}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  1  2  4  7  0 -1
\end{verbatim}
\item
  Em um vetor, todos os elementos precisam ser do mesmo tipo.
\item
  Mesmo que você use \texttt{c(c(...),\ c(...))}, o vetor criado vai ter um único nível. {\hl{Não existem vetores aninhados.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{v2 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\NormalTok{v3 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(v1, v2)}
\NormalTok{v3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4 5
\end{verbatim}
\item
  Mais adiante, veremos como criar {\hl{listas}}, que podem ter elementos de tipos diferentes e sublistas aninhadas.
\item
  Outras maneiras de criar vetores:

  \begin{itemize}
  \item
    O operador \texttt{:} constrói sequências:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{10}\SpecialCharTok{:}\DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 10  9  8  7  6  5  4  3  2  1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.5}\SpecialCharTok{:}\FloatTok{10.5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  0,5  1,5  2,5  3,5  4,5  5,5  6,5  7,5  8,5  9,5 10,5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.5}\SpecialCharTok{:}\DecValTok{10}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 0,5 1,5 2,5 3,5 4,5 5,5 6,5 7,5 8,5 9,5
\end{verbatim}
  \item
    A função \texttt{seq} permite especificar um incremento diferente de $1$ e $-1$:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 10  9  8  7  6  5  4  3  2  1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{, }\FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1,0  1,5  2,0  2,5  3,0  3,5  4,0  4,5  5,0  5,5  6,0  6,5  7,0
## [14]  7,5  8,0  8,5  9,0  9,5 10,0
\end{verbatim}
  \item
    A função \texttt{rep} cria vetores com elementos repetidos:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1 1 1 1 1 1 1 1 1 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{each =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 1 1 2 2 2 2
\end{verbatim}
  \end{itemize}
\item
  O número que aparece na saída, entre colchetes, é o índice do primeiro elemento daquela linha:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##   [33] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##   [65] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##   [97] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [129] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [161] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [193] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [225] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [257] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [289] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [321] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [353] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [385] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [417] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [449] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [481] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [513] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [545] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [577] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [609] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [641] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [673] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [705] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [737] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [769] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [801] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [833] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [865] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [897] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [929] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [961] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [993] 1 1 1 1 1 1 1 1
\end{verbatim}
\item
  Vetores começam no índice 1!!!!
\item
  Tudo é vetor:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{10}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.vector}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
\end{verbatim}
\item
  O valor \texttt{NA} significa {\hl{ausência de informação}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{notas }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{8}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{notas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10  8 NA  7 10
\end{verbatim}
\end{itemize}

\hypertarget{operauxe7uxf5es-com-vetores}{%
\section{Operações com vetores}\label{operauxe7uxf5es-com-vetores}}

\begin{itemize}
\item
  Adição e outras operações aritméticas::

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v3 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 4 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10 20
\end{verbatim}

  \begin{itemize}
  \item
    R {\hl{recicla}} o vetor mais curto, mas {\hl{avisa quando o comprimento do maior vetor não é múltiplo inteiro do comprimento do menor vetor}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\SpecialCharTok{+}\NormalTok{ v3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 11 22
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\SpecialCharTok{+}\NormalTok{ v2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in v1 + v2: longer object length is not a multiple of shorter
## object length
\end{verbatim}

\begin{verbatim}
## [1] 4 6 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{v4 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{)}
\NormalTok{v1 }\SpecialCharTok{+}\NormalTok{ v4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  4  6  6  8  8 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\SpecialCharTok{{-}}\NormalTok{ v4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -2 -2 -4 -4 -6 -6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\SpecialCharTok{*}\NormalTok{ v4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  3  8  5 12  7 16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v1 }\SpecialCharTok{/}\NormalTok{ v4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,3333333 0,5000000 0,2000000 0,3333333 0,1428571 0,2500000
\end{verbatim}
  \end{itemize}
\item
  Funções úteis para vetores:

  \begin{itemize}
  \item
    Somar todos os elementos:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(v4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 33
\end{verbatim}
  \item
    O valor \texttt{NA} se propaga em operações aritméticas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{notas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10  8 NA  7 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(notas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] NA
\end{verbatim}
  \item
    Para ignorar os valores \texttt{NA}, use o argumento \texttt{na.rm}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(notas, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 35
\end{verbatim}
  \item
    Média de todos os elementos:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(notas, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 8,75
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(notas, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{/} \DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 8,75
\end{verbatim}
  \end{itemize}
\end{itemize}

\hypertarget{indexauxe7uxe3o}{%
\section{Indexação}\label{indexauxe7uxe3o}}

\begin{itemize}
\item
  Com um valor inteiro:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5 }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{50} \SpecialCharTok{*} \DecValTok{4}
\NormalTok{v5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]   4   8  12  16  20  24  28  32  36  40  44  48  52  56  60  64
## [17]  68  72  76  80  84  88  92  96 100 104 108 112 116 120 124 128
## [33] 132 136 140 144 148 152 156 160 164 168 172 176 180 184 188 192
## [49] 196 200
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5[}\DecValTok{10}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 40
\end{verbatim}
\item
  Com um vetor de inteiros:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  4  8 12 16 20 24 28 32 36 40
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{30}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]   8  40  52 120
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5[}\FunctionTok{seq}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{2}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]   8  16  24  32  40  48  56  64  72  80  88  96 104 112 120 128
## [17] 136 144 152 160 168 176 184 192 200
\end{verbatim}
\item
  {\hl{Com um vetor de booleanos, os elementos indexados por {\mbox{\texttt{TRUE}}} são selecionados:}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 4 5 6 7 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v4[}\FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 4 7
\end{verbatim}
\item
  Uma condição produz um vetor de booleanos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v4 }\SpecialCharTok{\textgreater{}} \DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE
\end{verbatim}
\item
  Logo, podemos indexar com uma condição:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v4[ v4 }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{ ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6 7 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v4[ v4 }\SpecialCharTok{\%\%} \DecValTok{2} \SpecialCharTok{!=} \DecValTok{0}\NormalTok{ ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 5 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{notas[}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(notas)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10  8  7 10
\end{verbatim}
\item
  Para especificar os elementos a {\hl{não}} selecionar, use {\hl{índices negativos}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]   4   8  12  16  20  24  28  32  36  40  44  48  52  56  60  64
## [17]  68  72  76  80  84  88  92  96 100 104 108 112 116 120 124 128
## [33] 132 136 140 144 148 152 156 160 164 168 172 176 180 184 188 192
## [49] 196 200
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]   8  12  16  20  24  28  32  36  40  44  48  52  56  60  64  68
## [17]  72  76  80  84  88  92  96 100 104 108 112 116 120 124 128 132
## [33] 136 140 144 148 152 156 160 164 168 172 176 180 184 188 192 196
## [49] 200
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v5[}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{20}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]   8  12  20  24  28  32  36  40  44  48  52  56  60  64  68  72
## [17]  76  84  88  92  96 100 104 108 112 116 120 124 128 132 136 140
## [33] 144 148 152 156 160 164 168 172 176 180 184 188 192 196 200
\end{verbatim}
\end{itemize}

\hypertarget{vuxeddeo-2}{%
\section{Vídeo 2}\label{vuxeddeo-2}}

\begin{center} \url{https://youtu.be/3GEc1oiKDrU} \end{center}

\hypertarget{simular-lanuxe7amentos-de-dados}{%
\section{Simular lançamentos de dados}\label{simular-lanuxe7amentos-de-dados}}

\begin{itemize}
\item
  Vamos criar um dado de $6$ lados. Basta um vetor:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dado }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4 5 6
\end{verbatim}
\item
  Para lançar este dado uma vez, usamos \texttt{sample}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sample}\NormalTok{(dado, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6
\end{verbatim}
\item
  Para lançar o dado várias vezes:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{6}
\FunctionTok{sample}\NormalTok{(dado, n, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 3 2 4 2 6
\end{verbatim}
\item
  Observe que, para permitir que o mesmo valor apareça mais de uma vez, precisamos usar \texttt{replace\ =\ TRUE} --- a amostragem será feita com reposição.
\item
  Uma função para retornar a soma de 2 dados:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lancar2 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{() \{}

\NormalTok{  dado }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}
\NormalTok{  lancamentos }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(dado, }\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
  \FunctionTok{sum}\NormalTok{(lancamentos)}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{lancar2}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7
\end{verbatim}
\item
  Vamos generalizar a função:

  \begin{itemize}
  \item
    O número de lados do dado é passado como argumento.
  \item
    A quantidade de dados é passada como argumento.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lancar }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{n =} \DecValTok{2}\NormalTok{, }\AttributeTok{k =} \DecValTok{6}\NormalTok{) \{}

\NormalTok{  dado }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\NormalTok{k}
\NormalTok{  lancamentos }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(dado, }\AttributeTok{size =}\NormalTok{ n, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
  \FunctionTok{sum}\NormalTok{(lancamentos)}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{lancar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{lancar}\NormalTok{(}\AttributeTok{n =} \DecValTok{4}\NormalTok{, }\AttributeTok{k =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 14
\end{verbatim}
  \end{itemize}
\item
  Vamos lançar os $2$ dados $10$ mil vezes, usando a função \texttt{replicate}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{resultados }\OtherTok{\textless{}{-}} \FunctionTok{replicate}\NormalTok{(}\FloatTok{1e4}\NormalTok{, }\FunctionTok{lancar}\NormalTok{())}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{visualizauxe7uxe3o}{%
\section{Visualização}\label{visualizauxe7uxe3o}}

\begin{itemize}
\item
  A função \texttt{qplot}, do pacote \texttt{tidyverse}, produz um gráfico adequado aos argumentos recebidos --- aqui, um histograma:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(resultados, }\AttributeTok{bins =} \DecValTok{11}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `qplot()` was deprecated in ggplot2 3.4.0.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/qplot-1} \end{center}
\item
  Em um \protect\hyperlink{viz}{capítulo sobre visualização}, você vai aprender a configurar melhor a aparência de gráficos como este.
\end{itemize}

\hypertarget{dados-viciados}{%
\section{Dados viciados}\label{dados-viciados}}

\begin{itemize}
\item
  Vamos modificar a função \texttt{lancar} para receber um {\hl{vetor com as probabilidades dos lados}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lancar }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}
  \AttributeTok{qtde =} \DecValTok{2}\NormalTok{, }
  \AttributeTok{lados =} \DecValTok{6}\NormalTok{, }
  \AttributeTok{probs =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{lados, lados)}
\NormalTok{) \{}

\NormalTok{  dado }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\NormalTok{lados}
\NormalTok{  resultados }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}
\NormalTok{    dado, }
    \AttributeTok{size =}\NormalTok{ qtde, }
    \AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{, }
    \AttributeTok{prob =}\NormalTok{ probs}
\NormalTok{  )}
  \FunctionTok{sum}\NormalTok{(resultados)}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}
\item
  Lançando dados viciados:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{resultados }\OtherTok{\textless{}{-}} \FunctionTok{replicate}\NormalTok{(}\FloatTok{1e4}\NormalTok{, }\FunctionTok{lancar}\NormalTok{(}\AttributeTok{probs =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\DecValTok{10}\NormalTok{, }\DecValTok{5}\NormalTok{))))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(resultados, }\AttributeTok{bins =} \DecValTok{11}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/plot-viciados-1} \end{center}
\end{itemize}

\hypertarget{exercuxedcios-2}{%
\section{Exercícios}\label{exercuxedcios-2}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Para criar sua conta no RStudio Cloud, acesse \url{https://rstudio.cloud/}.
\item
  Se você preferir instalar o R no seu computador, acesse

  \begin{itemize}
  \item
    \url{https://cran.r-project.org/} para baixar e instalar o R, e
  \item
    \url{https://rstudio.com/products/rstudio/download/} para baixar e instalar o RStudio, um IDE específico para R.
  \end{itemize}
\item
  Abra o RStudio Cloud ou o seu RStudio instalado localmente.
\item
  Crie um novo projeto. {\hl{Sempre trabalhe em projetos para ter seus arquivos organizados.}}
\item
  Para instalar o \href{https://swirlstats.com/}{\texttt{swirl} (pacote do R para exercícios interativos)}, execute o seguinte comando no console do RStudio:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"swirl"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Para instalar os exercícios de introdução a R, execute os seguintes comandos no console do RStudio:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(swirl)}
\FunctionTok{install\_course\_github}\NormalTok{(}\StringTok{\textquotesingle{}fnaufel\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}introR\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Mude o idioma para português e execute o \texttt{swirl}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{select\_language}\NormalTok{(}\StringTok{\textquotesingle{}portuguese\textquotesingle{}}\NormalTok{, }\AttributeTok{append\_rprofile =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{swirl}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\item
  Na primeira execução, você vai precisar se identificar (qualquer nome serve). Com essa identificação, o \texttt{swirl} vai registrar o seu progresso nas lições.
\item
  No \texttt{swirl}, as perguntas são mostradas no console. Você também deve responder no console.
\item
  Às vezes, um \emph{script} será aberto no editor de textos para que você complete um programa. Quando seu programa estiver pronto, salve o arquivo e digite \texttt{submit()} no console para o \texttt{swirl} processar o \emph{script}.
\item
  O \texttt{swirl} dá instruções claras no console. Na dúvida, digite \texttt{info()} no \emph{prompt} do R (\texttt{\textgreater{}}).
\item
  Se, em vez do \emph{prompt} do R, o console mostrar reticências (\texttt{...}), tecle \emph{Enter}.
\item
  Se nada funcionar, tecle \emph{ESC}.
\item
  Para sair do \texttt{swirl()}, digite \texttt{bye()} no \emph{prompt} do R.
\item
  Para voltar para os exercícios, digite

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(swirl)}
\FunctionTok{swirl}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\item
  Se, quando você tentar instalar os exercícios, acontecer um erro, desinstale todos os cursos com os comandos

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(swirl)}
\FunctionTok{uninstall\_all\_courses}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  e tente instalar os exercícios novamente.
\end{enumerate}

\hypertarget{introduuxe7uxe3o-ao-tidyverse}{%
\chapter{\texorpdfstring{Introdução ao \texttt{tidyverse}}{Introdução ao tidyverse}}\label{introduuxe7uxe3o-ao-tidyverse}}

\begin{rmdtip}
Busque mais informações sobre os pacotes que compõem o \texttt{tidyverse} \protect\hyperlink{refrec}{nas referências recomendadas}.

\end{rmdtip}

\hypertarget{criando-uma-tibble}{%
\section{\texorpdfstring{Criando uma \emph{tibble}}{Criando uma tibble}}\label{criando-uma-tibble}}

\begin{itemize}
\item
  Uma \emph{tibble} é uma tabela retangular.
\item
  {\hl{Cada coluna é um vetor}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{pessoa =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}João\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Maria\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Pedro\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Ana\textquotesingle{}}\NormalTok{),}
  \StringTok{\textquotesingle{}cor favorita\textquotesingle{}} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}azul\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}rosa\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}preto\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}branco\textquotesingle{}}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   pessoa `cor favorita`
##   <chr>  <chr>         
## 1 João   azul          
## 2 Maria  rosa          
## 3 Pedro  preto         
## 4 Ana    branco
\end{verbatim}
\item
  Isto é um pouco diferente da maneira como estamos acostumados a ver tabelas (como uma coleção de linhas, em vez de uma coleção de colunas).
\item
  A função \texttt{tribble} permite a entrada de forma mais natural, linha a linha. {\hl{Lembre-se de usar {\mbox{\texttt{\textasciitilde{}}}} antes dos nomes das colunas.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{pessoa, }\SpecialCharTok{\textasciitilde{}}\StringTok{\textquotesingle{}cor favorita\textquotesingle{}}\NormalTok{,}
   \StringTok{"João"}\NormalTok{,          }\StringTok{"azul"}\NormalTok{,}
  \StringTok{"Maria"}\NormalTok{,          }\StringTok{"rosa"}\NormalTok{,}
  \StringTok{"Pedro"}\NormalTok{,         }\StringTok{"preto"}\NormalTok{,}
    \StringTok{"Ana"}\NormalTok{,        }\StringTok{"branco"}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   pessoa `cor favorita`
##   <chr>  <chr>         
## 1 João   azul          
## 2 Maria  rosa          
## 3 Pedro  preto         
## 4 Ana    branco
\end{verbatim}

  \begin{rmdcaution}
  Mesmo que você crie uma \emph{tibble} linha a linha, o R vai continuar tratando sua \emph{tibble} como uma coleção de colunas.

  É importante lembrar disto para entender a forma como R manipula estas tabelas.

  \end{rmdcaution}
\item
  Se uma coluna não puder ser armazenada em um vetor, a coluna será uma lista (com vetores como elementos):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{pessoa =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}João\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Maria\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Pedro\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Ana\textquotesingle{}}\NormalTok{),}
  \StringTok{\textquotesingle{}cor favorita\textquotesingle{}} \OtherTok{=} \FunctionTok{list}\NormalTok{(}
    \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}azul\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}roxo\textquotesingle{}}\NormalTok{),}
    \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}rosa\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}magenta\textquotesingle{}}\NormalTok{),}
    \ConstantTok{NA}\NormalTok{,}
    \StringTok{\textquotesingle{}branco\textquotesingle{}}
\NormalTok{  )}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   pessoa `cor favorita`
##   <chr>  <list>        
## 1 João   <chr [2]>     
## 2 Maria  <chr [2]>     
## 3 Pedro  <lgl [1]>     
## 4 Ana    <chr [1]>
\end{verbatim}
\item
  Use \texttt{View()} para examinar interativamente o conteúdo de uma coluna-lista:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{View}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{operador-de-pipe}{%
\section{\texorpdfstring{Operador de \emph{pipe} (\texttt{\%\textgreater{}\%})}{Operador de pipe (\%\textgreater\%)}}\label{operador-de-pipe}}

\begin{itemize}
\tightlist
\item
  O \texttt{tidyverse} inclui o pacote \texttt{magrittr}, que contém o operador \texttt{\%\textgreater{}\%}, chamado \emph{pipe}.\footnote{Por que o nome do pacote e o nome do operador formam um trocadilho?}
\end{itemize}

\begin{itemize}
\item
  A idéia é facilitar a leitura de {\hl{composições de funções}}. O código

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{h}\NormalTok{(}\FunctionTok{g}\NormalTok{(}\FunctionTok{f}\NormalTok{(x)))}
\end{Highlighting}
\end{Shaded}

  pode ser escrito como

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{f}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{g}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{h}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\item
  Esta segunda versão é mais fiel à ordem em que as operações acontecem.
\item
  Na verdade, R tem um operador de {\hl{atribuição para a direita}}, mas poucas pessoas recomendam usá-lo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{f}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{g}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{h}\NormalTok{() }\OtherTok{{-}\textgreater{}}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}
\item
  Se \texttt{f}, \texttt{g} e \texttt{h} forem funções de um argumento só, os parênteses podem ser omitidos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ f }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ g }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ h}
\end{Highlighting}
\end{Shaded}
\item
  Se a função \texttt{f} tiver outros argumentos, escreva-os normalmente na chamada a \texttt{f}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mean}\NormalTok{(}\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  O \emph{pipe} \texttt{EXP\ \%\textgreater{}\%\ f(...)} sempre insere o resultado da expressão \texttt{EXP} como o {\hl{primeiro argumento da função {\mbox{\texttt{f}}}}}.
\item
  Se você precisar que o resultado da expressão \texttt{EXP} seja inserido em outra posição na lista de argumentos de \texttt{f}, use um ponto ``\texttt{.}'' para isso:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{consultar}\NormalTok{(df, .)}
\end{Highlighting}
\end{Shaded}

  equivale a

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{consultar}\NormalTok{(df, x)}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{formato-tidy}{%
\section{\texorpdfstring{Formato \emph{tidy}}{Formato tidy}}\label{formato-tidy}}

\begin{itemize}
\item
  Nossa última versão da \emph{tibble} \texttt{cores} é um pouco mais complexa do que deveria ser:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   pessoa `cor favorita`
##   <chr>  <list>        
## 1 João   <chr [2]>     
## 2 Maria  <chr [2]>     
## 3 Pedro  <lgl [1]>     
## 4 Ana    <chr [1]>
\end{verbatim}
\item
  O formato \emph{tidy} exige que

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    {\hl{Cada linha}} da \emph{tibble} corresponda a uma {\hl{observação}} sobre um indivíduo,
  \item
    {\hl{Cada coluna}} corresponda a {\hl{uma variável observada}}, e
  \item
    {\hl{Cada célula}} contenha {\hl{um valor}} da variável.
  \end{enumerate}
\item
  Na \emph{tibble} \texttt{cores}, a primeira e a segunda exigências são satisfeitas, mas a terceira não, pois algumas células contém valores múltiplos.
\item
  A \emph{tibble} não está no formato \emph{tidy}.
\item
  Podemos ``extrair'' estes vetores ``aninhados'' usando o comando \texttt{unnest}, do pacote \texttt{tidyr}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores }\OtherTok{\textless{}{-}}\NormalTok{ cores }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{unnest}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{cor favorita}\StringTok{\textasciigrave{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cores}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 2
##   pessoa `cor favorita`
##   <chr>  <chr>         
## 1 João   azul          
## 2 João   roxo          
## 3 Maria  rosa          
## 4 Maria  magenta       
## 5 Pedro  <NA>          
## 6 Ana    branco
\end{verbatim}
\item
  {\hl{A maioria das funções do {\mbox{\texttt{tidyverse}}} exige que as \emph{tibbles} estejam neste formato \emph{tidy}.}}
\item
  Um exemplo mais complexo é o \emph{dataset} \texttt{billboard}, com as seguintes colunas (para cada música que estava no \emph{top 100} da Billboard no ano de $2000$):

  \begin{itemize}
  \item
    Nome do artista ou banda;
  \item
    Nome da música;
  \item
    Data em que a música entrou no \emph{top 100} da Billboard;
  \item
    Para cada uma das $76$ semanas seguintes, a posição da música no \emph{top 100}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{billboard }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{glimpse}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 317
## Columns: 79
## $ artist       <chr> "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Dow~
## $ track        <chr> "Baby Don't Cry (Keep...", "The Hardest Part Of ~
## $ date.entered <date> 2000-02-26, 2000-09-02, 2000-04-08, 2000-10-21,~
## $ wk1          <dbl> 87, 91, 81, 76, 57, 51, 97, 84, 59, 76, 84, 57, ~
## $ wk2          <dbl> 82, 87, 70, 76, 34, 39, 97, 62, 53, 76, 84, 47, ~
## $ wk3          <dbl> 72, 92, 68, 72, 25, 34, 96, 51, 38, 74, 75, 45, ~
## $ wk4          <dbl> 77, NA, 67, 69, 17, 26, 95, 41, 28, 69, 73, 29, ~
## $ wk5          <dbl> 87, NA, 66, 67, 17, 26, 100, 38, 21, 68, 73, 23,~
## $ wk6          <dbl> 94, NA, 57, 65, 31, 19, NA, 35, 18, 67, 69, 18, ~
## $ wk7          <dbl> 99, NA, 54, 55, 36, 2, NA, 35, 16, 61, 68, 11, 2~
## $ wk8          <dbl> NA, NA, 53, 59, 49, 2, NA, 38, 14, 58, 65, 9, 17~
## $ wk9          <dbl> NA, NA, 51, 62, 53, 3, NA, 38, 12, 57, 73, 9, 17~
## $ wk10         <dbl> NA, NA, 51, 61, 57, 6, NA, 36, 10, 59, 83, 11, 1~
## $ wk11         <dbl> NA, NA, 51, 61, 64, 7, NA, 37, 9, 66, 92, 1, 17,~
## $ wk12         <dbl> NA, NA, 51, 59, 70, 22, NA, 37, 8, 68, NA, 1, 3,~
## $ wk13         <dbl> NA, NA, 47, 61, 75, 29, NA, 38, 6, 61, NA, 1, 3,~
## $ wk14         <dbl> NA, NA, 44, 66, 76, 36, NA, 49, 1, 67, NA, 1, 7,~
## $ wk15         <dbl> NA, NA, 38, 72, 78, 47, NA, 61, 2, 59, NA, 4, 10~
## $ wk16         <dbl> NA, NA, 28, 76, 85, 67, NA, 63, 2, 63, NA, 8, 17~
## $ wk17         <dbl> NA, NA, 22, 75, 92, 66, NA, 62, 2, 67, NA, 12, 2~
## $ wk18         <dbl> NA, NA, 18, 67, 96, 84, NA, 67, 2, 71, NA, 22, 2~
## $ wk19         <dbl> NA, NA, 18, 73, NA, 93, NA, 83, 3, 79, NA, 23, 2~
## $ wk20         <dbl> NA, NA, 14, 70, NA, 94, NA, 86, 4, 89, NA, 43, 4~
## $ wk21         <dbl> NA, NA, 12, NA, NA, NA, NA, NA, 5, NA, NA, 44, 4~
## $ wk22         <dbl> NA, NA, 7, NA, NA, NA, NA, NA, 5, NA, NA, NA, 50~
## $ wk23         <dbl> NA, NA, 6, NA, NA, NA, NA, NA, 6, NA, NA, NA, NA~
## $ wk24         <dbl> NA, NA, 6, NA, NA, NA, NA, NA, 9, NA, NA, NA, NA~
## $ wk25         <dbl> NA, NA, 6, NA, NA, NA, NA, NA, 13, NA, NA, NA, N~
## $ wk26         <dbl> NA, NA, 5, NA, NA, NA, NA, NA, 14, NA, NA, NA, N~
## $ wk27         <dbl> NA, NA, 5, NA, NA, NA, NA, NA, 16, NA, NA, NA, N~
## $ wk28         <dbl> NA, NA, 4, NA, NA, NA, NA, NA, 23, NA, NA, NA, N~
## $ wk29         <dbl> NA, NA, 4, NA, NA, NA, NA, NA, 22, NA, NA, NA, N~
## $ wk30         <dbl> NA, NA, 4, NA, NA, NA, NA, NA, 33, NA, NA, NA, N~
## $ wk31         <dbl> NA, NA, 4, NA, NA, NA, NA, NA, 36, NA, NA, NA, N~
## $ wk32         <dbl> NA, NA, 3, NA, NA, NA, NA, NA, 43, NA, NA, NA, N~
## $ wk33         <dbl> NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk34         <dbl> NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk35         <dbl> NA, NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk36         <dbl> NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk37         <dbl> NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk38         <dbl> NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk39         <dbl> NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ wk40         <dbl> NA, NA, 15, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk41         <dbl> NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk42         <dbl> NA, NA, 13, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk43         <dbl> NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk44         <dbl> NA, NA, 16, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk45         <dbl> NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk46         <dbl> NA, NA, 21, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk47         <dbl> NA, NA, 22, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk48         <dbl> NA, NA, 24, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk49         <dbl> NA, NA, 28, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk50         <dbl> NA, NA, 33, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk51         <dbl> NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk52         <dbl> NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk53         <dbl> NA, NA, 49, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk54         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk55         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk56         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk57         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk58         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk59         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk60         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk61         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk62         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk63         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk64         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk65         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk66         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk67         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk68         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk69         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk70         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk71         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk72         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk73         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk74         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk75         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
## $ wk76         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ~
\end{verbatim}
  \end{itemize}
\item
  Vamos renomear as colunas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb }\OtherTok{\textless{}{-}}\NormalTok{ billboard }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}
    \AttributeTok{artista =}\NormalTok{ artist,}
    \AttributeTok{musica =}\NormalTok{ track,}
    \AttributeTok{entrou =}\NormalTok{ date.entered}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{head}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 79
##   artista   musica entrou       wk1   wk2   wk3   wk4   wk5   wk6   wk7
##   <chr>     <chr>  <date>     <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
## 1 2 Pac     Baby ~ 2000-02-26    87    82    72    77    87    94    99
## 2 2Ge+her   The H~ 2000-09-02    91    87    92    NA    NA    NA    NA
## 3 3 Doors ~ Krypt~ 2000-04-08    81    70    68    67    66    57    54
## 4 3 Doors ~ Loser  2000-10-21    76    76    72    69    67    65    55
## 5 504 Boyz  Wobbl~ 2000-04-15    57    34    25    17    17    31    36
## 6 98^0      Give ~ 2000-08-19    51    39    34    26    26    19     2
## # i 69 more variables: wk8 <dbl>, wk9 <dbl>, wk10 <dbl>, wk11 <dbl>,
## #   wk12 <dbl>, wk13 <dbl>, wk14 <dbl>, wk15 <dbl>, wk16 <dbl>,
## #   wk17 <dbl>, wk18 <dbl>, wk19 <dbl>, wk20 <dbl>, wk21 <dbl>,
## #   wk22 <dbl>, wk23 <dbl>, wk24 <dbl>, wk25 <dbl>, wk26 <dbl>,
## #   wk27 <dbl>, wk28 <dbl>, wk29 <dbl>, wk30 <dbl>, wk31 <dbl>,
## #   wk32 <dbl>, wk33 <dbl>, wk34 <dbl>, wk35 <dbl>, wk36 <dbl>,
## #   wk37 <dbl>, wk38 <dbl>, wk39 <dbl>, wk40 <dbl>, wk41 <dbl>, ...
\end{verbatim}
\item
  {\hl{O que é uma observação}} neste conjunto de dados?

  {\hl{A posição, em uma semana, de uma música}} que esteve no \emph{top} $100$ da \emph{Billboard} durante o ano \emph{2000}.
\item
  {\hl{Quais são as variáveis}} que qualificam cada observação?

  \begin{itemize}
  \item
    O artista,
  \item
    O título da música,
  \item
    A posiçao da música no \emph{top} $100$ da \emph{Billboard} em cada uma das $76$ semanas depois que ela entrou na lista.
  \end{itemize}
\item
  Este último item é complexo, e o criador da \emph{tibble} decidiu criar uma coluna por semana.
\item
  {\hl{Uma decisão ruim, pois existe informação embutida nos nomes das colunas.}} A coluna \texttt{wk68} corresponde à posição da música na semana $68$ após ela entrar na lista, {\hl{mas o número da semana só aparece no nome da coluna}}!
\item
  Isto {\hl{nunca}} deve acontecer. {\hl{A informação deve sempre estar nas células.}}
\item
  Vamos simplificar as coisas criando duas colunas:

  \begin{itemize}
  \item
    \texttt{semana}, com o número da semana; perceba que esta informação vem dos nomes das colunas,
  \item
    \texttt{pos}, com a posição da música naquela semana; esta informação vem das células.
  \end{itemize}
\item
  A \emph{tibble}, que antes era larga, {\hl{vai ser mais estreita e mais longa}}.
\item
  A função \texttt{pivot\_longer}, do pacote \texttt{tidyr}, vai fazer o trabalho --- inclusive extraindo os números das semanas dos nomes das colunas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\OtherTok{\textless{}{-}}\NormalTok{ bb }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
\NormalTok{    wk1}\SpecialCharTok{:}\NormalTok{wk76,}
    \AttributeTok{names\_to =} \StringTok{\textquotesingle{}semana\textquotesingle{}}\NormalTok{,}
    \AttributeTok{names\_prefix =} \StringTok{\textquotesingle{}wk\textquotesingle{}}\NormalTok{,}
    \AttributeTok{names\_transform =} \FunctionTok{list}\NormalTok{(}
      \AttributeTok{semana =}\NormalTok{ as.integer}
\NormalTok{    ),}
    \AttributeTok{values\_to =} \StringTok{\textquotesingle{}pos\textquotesingle{}}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 24.092 x 5
##   artista musica                  entrou     semana   pos
##   <chr>   <chr>                   <date>      <int> <dbl>
## 1 2 Pac   Baby Don't Cry (Keep... 2000-02-26      1    87
## 2 2 Pac   Baby Don't Cry (Keep... 2000-02-26      2    82
## 3 2 Pac   Baby Don't Cry (Keep... 2000-02-26      3    72
## 4 2 Pac   Baby Don't Cry (Keep... 2000-02-26      4    77
## 5 2 Pac   Baby Don't Cry (Keep... 2000-02-26      5    87
## 6 2 Pac   Baby Don't Cry (Keep... 2000-02-26      6    94
## # i 24.086 more rows
\end{verbatim}
\item
  O R só mostra, por \emph{default}, as $1000$ primeiras linhas de uma \emph{tibble}.
\item
  Na verdade, o número de linhas da tabela original era

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 317
\end{verbatim}
\item
  O número de linhas, depois de \texttt{pivot\_longer}, ficou:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 24092
\end{verbatim}
\item
  Existem linhas onde \texttt{pos} tem o valor \texttt{NA}. São resultado da organização original dos dados, onde o \texttt{NA} indicava que a música não estava no \emph{top} $100$ naquela semana.
\item
  No novo formato, a ausência da linha com aquele número de semana já basta para indicar isto. Então, vamos eliminar as linhas onde \texttt{pos} é \texttt{NA}.
\item
  A função \texttt{filter} {\hl{mantém}} as linhas que {\hl{satisfazem}} a condição dada; por isso, a condição é ``\texttt{pos} não é \texttt{NA}'':

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\OtherTok{\textless{}{-}}\NormalTok{ bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(pos))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5.307 x 5
##   artista musica                  entrou     semana   pos
##   <chr>   <chr>                   <date>      <int> <dbl>
## 1 2 Pac   Baby Don't Cry (Keep... 2000-02-26      1    87
## 2 2 Pac   Baby Don't Cry (Keep... 2000-02-26      2    82
## 3 2 Pac   Baby Don't Cry (Keep... 2000-02-26      3    72
## 4 2 Pac   Baby Don't Cry (Keep... 2000-02-26      4    77
## 5 2 Pac   Baby Don't Cry (Keep... 2000-02-26      5    87
## 6 2 Pac   Baby Don't Cry (Keep... 2000-02-26      6    94
## # i 5.301 more rows
\end{verbatim}
\item
  O número de linhas ficou

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5307
\end{verbatim}
\end{itemize}

\hypertarget{exercuxedcios-3}{%
\subsection{Exercícios}\label{exercuxedcios-3}}

\begin{itemize}
\item
  Todas as semanas deste conjunto de dados são do ano $2000$?
\item
  Qual é o tipo do {\hl{primeiro}} argumento da função \texttt{filter()}?
\end{itemize}

\hypertarget{manipulando-os-dados}{%
\section{Manipulando os dados}\label{manipulando-os-dados}}

\hypertarget{criando-novas-colunas-mutate-transmute}{%
\subsection{\texorpdfstring{Criando novas colunas: \texttt{mutate}, \texttt{transmute}}{Criando novas colunas: mutate, transmute}}\label{criando-novas-colunas-mutate-transmute}}

\begin{itemize}
\item
  O \emph{data frame}\footnote{Considere \emph{data frame} como sinônimo de \emph{tibble}. Na verdade, \emph{tibbles} formam um superconjunto de \emph{data frames}: todo \emph{data frame} é uma \emph{tibble}, mas nem toda \emph{tibble} é um \emph{data frame}.} \texttt{cars} tem dados (de $1920$!) sobre as distâncias de frenagem (em pés) de um carro viajando a diversas velocidades (em milhas por hora):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cars}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 2
##   speed  dist
##   <dbl> <dbl>
## 1     4     2
## 2     4    10
## 3     7     4
## 4     7    22
## 5     8    16
## 6     9    10
## # i 44 more rows
\end{verbatim}
\item
  Vamos criar colunas novas com os valores convertidos para km/h e metros; além disso, uma coluna com a taxa de frenagem:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cars }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{velocidade =}\NormalTok{ speed }\SpecialCharTok{*} \FloatTok{1.6}\NormalTok{,}
    \AttributeTok{distancia =}\NormalTok{ dist }\SpecialCharTok{*}\NormalTok{ .}\DecValTok{33}\NormalTok{,}
    \AttributeTok{taxa =}\NormalTok{ velocidade }\SpecialCharTok{/}\NormalTok{ distancia}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 5
##   speed  dist velocidade distancia  taxa
##   <dbl> <dbl>      <dbl>     <dbl> <dbl>
## 1     4     2        6.4      0.66  9.70
## 2     4    10        6.4      3.3   1.94
## 3     7     4       11.2      1.32  8.48
## 4     7    22       11.2      7.26  1.54
## 5     8    16       12.8      5.28  2.42
## 6     9    10       14.4      3.3   4.36
## # i 44 more rows
\end{verbatim}
\item
  Perceba que as colunas antigas continuam lá. {\hl{Se quiser manter apenas as colunas novas, use {\mbox{\texttt{transmute}}}}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cars }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{transmute}\NormalTok{(}
    \AttributeTok{velocidade =}\NormalTok{ speed }\SpecialCharTok{*} \FloatTok{1.6}\NormalTok{,}
    \AttributeTok{distancia =}\NormalTok{ dist }\SpecialCharTok{*}\NormalTok{ .}\DecValTok{33}\NormalTok{,}
    \AttributeTok{taxa =}\NormalTok{ velocidade }\SpecialCharTok{/}\NormalTok{ distancia}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 3
##   velocidade distancia  taxa
##        <dbl>     <dbl> <dbl>
## 1        6.4      0.66  9.70
## 2        6.4      3.3   1.94
## 3       11.2      1.32  8.48
## 4       11.2      7.26  1.54
## 5       12.8      5.28  2.42
## 6       14.4      3.3   4.36
## # i 44 more rows
\end{verbatim}
\item
  Ou use o argumento \texttt{.keep} de \texttt{mutate} para escolher com mais precisão. Veja a ajuda de \texttt{mutate}.
\end{itemize}

\hypertarget{selecionando-colunas-select-distinct-pull}{%
\subsection{\texorpdfstring{Selecionando colunas: \texttt{select}, \texttt{distinct}, \texttt{pull}}{Selecionando colunas: select, distinct, pull}}\label{selecionando-colunas-select-distinct-pull}}

\begin{itemize}
\item
  Vamos voltar à nossa \emph{tibble} dos \emph{top} $100$ da \emph{Billboard}.
\item
  Para ver só a coluna de artistas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(artista)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5.307 x 1
##   artista
##   <chr>  
## 1 2 Pac  
## 2 2 Pac  
## 3 2 Pac  
## 4 2 Pac  
## 5 2 Pac  
## 6 2 Pac  
## # i 5.301 more rows
\end{verbatim}
\item
  Para eliminar as repetições:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(artista) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{distinct}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 228 x 1
##   artista     
##   <chr>       
## 1 2 Pac       
## 2 2Ge+her     
## 3 3 Doors Down
## 4 504 Boyz    
## 5 98^0        
## 6 A*Teens     
## # i 222 more rows
\end{verbatim}
\item
  Para ver artistas e músicas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(artista, musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{distinct}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 317 x 2
##   artista      musica                 
##   <chr>        <chr>                  
## 1 2 Pac        Baby Don't Cry (Keep...
## 2 2Ge+her      The Hardest Part Of ...
## 3 3 Doors Down Kryptonite             
## 4 3 Doors Down Loser                  
## 5 504 Boyz     Wobble Wobble          
## 6 98^0         Give Me Just One Nig...
## # i 311 more rows
\end{verbatim}
\item
  Para especificar colunas {\hl{a não mostrar}}, use o sinal de menos ``\texttt{-}'':

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(entrou, semana, pos))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5.307 x 2
##   artista musica                 
##   <chr>   <chr>                  
## 1 2 Pac   Baby Don't Cry (Keep...
## 2 2 Pac   Baby Don't Cry (Keep...
## 3 2 Pac   Baby Don't Cry (Keep...
## 4 2 Pac   Baby Don't Cry (Keep...
## 5 2 Pac   Baby Don't Cry (Keep...
## 6 2 Pac   Baby Don't Cry (Keep...
## # i 5.301 more rows
\end{verbatim}
\item
  Para {\hl{extrair uma coluna na forma de vetor}} (\texttt{unique} é uma função do R base, aplicável a vetores):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(artista) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{unique}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] "2 Pac"                          "2Ge+her"                       
##   [3] "3 Doors Down"                   "504 Boyz"                      
##   [5] "98^0"                           "A*Teens"                       
##   [7] "Aaliyah"                        "Adams, Yolanda"                
##   [9] "Adkins, Trace"                  "Aguilera, Christina"           
##  [11] "Alice Deejay"                   "Allan, Gary"                   
##  [13] "Amber"                          "Anastacia"                     
##  [15] "Anthony, Marc"                  "Avant"                         
##  [17] "BBMak"                          "Backstreet Boys, The"          
##  [19] "Badu, Erkyah"                   "Baha Men"                      
##  [21] "Barenaked Ladies"               "Beenie Man"                    
##  [23] "Before Dark"                    "Bega, Lou"                     
##  [25] "Big Punisher"                   "Black Rob"                     
##  [27] "Black, Clint"                   "Blaque"                        
##  [29] "Blige, Mary J."                 "Blink-182"                     
##  [31] "Bloodhound Gang"                "Bon Jovi"                      
##  [33] "Braxton, Toni"                  "Brock, Chad"                   
##  [35] "Brooks & Dunn"                  "Brooks, Garth"                 
##  [37] "Byrd, Tracy"                    "Cagle, Chris"                  
##  [39] "Cam'ron"                        "Carey, Mariah"                 
##  [41] "Carter, Aaron"                  "Carter, Torrey"                
##  [43] "Changing Faces"                 "Chesney, Kenny"                
##  [45] "Clark Family Experience"        "Clark, Terri"                  
##  [47] "Common"                         "Counting Crows"                
##  [49] "Creed"                          "Cyrus, Billy Ray"              
##  [51] "D'Angelo"                       "DMX"                           
##  [53] "Da Brat"                        "Davidson, Clay"                
##  [55] "De La Soul"                     "Destiny's Child"               
##  [57] "Diffie, Joe"                    "Dion, Celine"                  
##  [59] "Dixie Chicks, The"              "Dr. Dre"                       
##  [61] "Drama"                          "Dream"                         
##  [63] "Eastsidaz, The"                 "Eiffel 65"                     
##  [65] "Elliott, Missy \"Misdemeanor\"" "Eminem"                        
##  [67] "En Vogue"                       "Estefan, Gloria"               
##  [69] "Evans, Sara"                    "Eve"                           
##  [71] "Everclear"                      "Fabian, Lara"                  
##  [73] "Fatboy Slim"                    "Filter"                        
##  [75] "Foo Fighters"                   "Fragma"                        
##  [77] "Funkmaster Flex"                "Ghostface Killah"              
##  [79] "Gill, Vince"                    "Gilman, Billy"                 
##  [81] "Ginuwine"                       "Goo Goo Dolls"                 
##  [83] "Gray, Macy"                     "Griggs, Andy"                  
##  [85] "Guy"                            "Hanson"                        
##  [87] "Hart, Beth"                     "Heatherly, Eric"               
##  [89] "Henley, Don"                    "Herndon, Ty"                   
##  [91] "Hill, Faith"                    "Hoku"                          
##  [93] "Hollister, Dave"                "Hot Boys"                      
##  [95] "Houston, Whitney"               "IMx"                           
##  [97] "Ice Cube"                       "Ideal"                         
##  [99] "Iglesias, Enrique"              "J-Shin"                        
## [101] "Ja Rule"                        "Jackson, Alan"                 
## [103] "Jagged Edge"                    "Janet"                         
## [105] "Jay-Z"                          "Jean, Wyclef"                  
## [107] "Joe"                            "John, Elton"                   
## [109] "Jones, Donell"                  "Jordan, Montell"               
## [111] "Juvenile"                       "Kandi"                         
## [113] "Keith, Toby"                    "Kelis"                         
## [115] "Kenny G"                        "Kid Rock"                      
## [117] "Kravitz, Lenny"                 "Kumbia Kings"                  
## [119] "LFO"                            "LL Cool J"                     
## [121] "Larrieux, Amel"                 "Lawrence, Tracy"               
## [123] "Levert, Gerald"                 "Lil Bow Wow"                   
## [125] "Lil Wayne"                      "Lil' Kim"                      
## [127] "Lil' Mo"                        "Lil' Zane"                     
## [129] "Limp Bizkit"                    "Lonestar"                      
## [131] "Lopez, Jennifer"                "Loveless, Patty"               
## [133] "Lox"                            "Lucy Pearl"                    
## [135] "Ludacris"                       "M2M"                           
## [137] "Madison Avenue"                 "Madonna"                       
## [139] "Martin, Ricky"                  "Mary Mary"                     
## [141] "Master P"                       "McBride, Martina"              
## [143] "McEntire, Reba"                 "McGraw, Tim"                   
## [145] "McKnight, Brian"                "Messina, Jo Dee"               
## [147] "Metallica"                      "Montgomery Gentry"             
## [149] "Montgomery, John Michael"       "Moore, Chante"                 
## [151] "Moore, Mandy"                   "Mumba, Samantha"               
## [153] "Musiq"                          "Mya"                           
## [155] "Mystikal"                       "N'Sync"                        
## [157] "Nas"                            "Nelly"                         
## [159] "Next"                           "Nine Days"                     
## [161] "No Doubt"                       "Nu Flavor"                     
## [163] "Offspring, The"                 "Paisley, Brad"                 
## [165] "Papa Roach"                     "Pearl Jam"                     
## [167] "Pink"                           "Price, Kelly"                  
## [169] "Profyle"                        "Puff Daddy"                    
## [171] "Q-Tip"                          "R.E.M."                        
## [173] "Rascal Flatts"                  "Raye, Collin"                  
## [175] "Red Hot Chili Peppers"          "Rimes, LeAnn"                  
## [177] "Rogers, Kenny"                  "Ruff Endz"                     
## [179] "Sammie"                         "Santana"                       
## [181] "Savage Garden"                  "SheDaisy"                      
## [183] "Sheist, Shade"                  "Shyne"                         
## [185] "Simpson, Jessica"               "Sisqo"                         
## [187] "Sister Hazel"                   "Smash Mouth"                   
## [189] "Smith, Will"                    "Son By Four"                   
## [191] "Sonique"                        "SoulDecision"                  
## [193] "Spears, Britney"                "Spencer, Tracie"               
## [195] "Splender"                       "Sting"                         
## [197] "Stone Temple Pilots"            "Stone, Angie"                  
## [199] "Strait, George"                 "Sugar Ray"                     
## [201] "TLC"                            "Tamar"                         
## [203] "Tamia"                          "Third Eye Blind"               
## [205] "Thomas, Carl"                   "Tippin, Aaron"                 
## [207] "Train"                          "Trick Daddy"                   
## [209] "Trina"                          "Tritt, Travis"                 
## [211] "Tuesday"                        "Urban, Keith"                  
## [213] "Usher"                          "Vassar, Phil"                  
## [215] "Vertical Horizon"               "Vitamin C"                     
## [217] "Walker, Clay"                   "Wallflowers, The"              
## [219] "Westlife"                       "Williams, Robbie"              
## [221] "Wills, Mark"                    "Worley, Darryl"                
## [223] "Wright, Chely"                  "Yankee Grey"                   
## [225] "Yearwood, Trisha"               "Ying Yang Twins"               
## [227] "Zombie Nation"                  "matchbox twenty"
\end{verbatim}
\end{itemize}

\hypertarget{filtrando-linhas-filter-slice}{%
\subsection{\texorpdfstring{Filtrando linhas: \texttt{filter}, \texttt{slice}}{Filtrando linhas: filter, slice}}\label{filtrando-linhas-filter-slice}}

\begin{itemize}
\item
  Apenas as músicas da Britney Spears:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(artista }\SpecialCharTok{==} \StringTok{\textquotesingle{}Spears, Britney\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 51 x 5
##   artista         musica                  entrou     semana   pos
##   <chr>           <chr>                   <date>      <int> <dbl>
## 1 Spears, Britney From The Bottom Of M... 2000-01-29      1    76
## 2 Spears, Britney From The Bottom Of M... 2000-01-29      2    59
## 3 Spears, Britney From The Bottom Of M... 2000-01-29      3    52
## 4 Spears, Britney From The Bottom Of M... 2000-01-29      4    52
## 5 Spears, Britney From The Bottom Of M... 2000-01-29      5    14
## 6 Spears, Britney From The Bottom Of M... 2000-01-29      6    14
## # i 45 more rows
\end{verbatim}
\item
  Apenas músicas que chegaram à posição $1$, sem mostrar a coluna \texttt{pos}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(pos }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pos)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 55 x 4
##   artista             musica                  entrou     semana
##   <chr>               <chr>                   <date>      <int>
## 1 Aaliyah             Try Again               2000-03-18     14
## 2 Aguilera, Christina Come On Over Baby (A... 2000-08-05     11
## 3 Aguilera, Christina Come On Over Baby (A... 2000-08-05     12
## 4 Aguilera, Christina Come On Over Baby (A... 2000-08-05     13
## 5 Aguilera, Christina Come On Over Baby (A... 2000-08-05     14
## 6 Aguilera, Christina What A Girl Wants       1999-11-27      8
## # i 49 more rows
\end{verbatim}
\item
  Apenas músicas que chegaram à posição $1$ em menos de $10$ semanas, mostrando apenas artista e música:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(pos }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, semana }\SpecialCharTok{\textless{}} \DecValTok{10}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{distinct}\NormalTok{(artista, musica)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 2
##   artista             musica                 
##   <chr>               <chr>                  
## 1 Aguilera, Christina What A Girl Wants      
## 2 Destiny's Child     Independent Women Pa...
## 3 Madonna             Music                  
## 4 Santana             Maria, Maria           
## 5 Sisqo               Incomplete
\end{verbatim}
\item
  As funções da família \texttt{slice} filtram linhas de diversas maneiras.
\item
  De acordo com seus índices (números de linha):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DecValTok{5000}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 5
##   artista                 musica                entrou     semana   pos
##   <chr>                   <chr>                 <date>      <int> <dbl>
## 1 2 Pac                   Baby Don't Cry (Keep~ 2000-02-26      1    87
## 2 Clark Family Experience Meanwhile Back At Th~ 2000-11-18      3    81
## 3 Vassar, Phil            Carlene               2000-03-04      3    64
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice\_head}\NormalTok{(}\AttributeTok{n =} \DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 5
##   artista musica                  entrou     semana   pos
##   <chr>   <chr>                   <date>      <int> <dbl>
## 1 2 Pac   Baby Don't Cry (Keep... 2000-02-26      1    87
## 2 2 Pac   Baby Don't Cry (Keep... 2000-02-26      2    82
## 3 2 Pac   Baby Don't Cry (Keep... 2000-02-26      3    72
## 4 2 Pac   Baby Don't Cry (Keep... 2000-02-26      4    77
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice\_tail}\NormalTok{(}\AttributeTok{n =} \DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 5
##   artista         musica entrou     semana   pos
##   <chr>           <chr>  <date>      <int> <dbl>
## 1 matchbox twenty Bent   2000-04-29     36    37
## 2 matchbox twenty Bent   2000-04-29     37    38
## 3 matchbox twenty Bent   2000-04-29     38    38
## 4 matchbox twenty Bent   2000-04-29     39    48
\end{verbatim}
\item
  De acordo com a {\hl{ordenação de uma coluna}} ou {\hl{de uma função das colunas}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice\_min}\NormalTok{(pos)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 55 x 5
##   artista             musica                  entrou     semana   pos
##   <chr>               <chr>                   <date>      <int> <dbl>
## 1 Aaliyah             Try Again               2000-03-18     14     1
## 2 Aguilera, Christina Come On Over Baby (A... 2000-08-05     11     1
## 3 Aguilera, Christina Come On Over Baby (A... 2000-08-05     12     1
## 4 Aguilera, Christina Come On Over Baby (A... 2000-08-05     13     1
## 5 Aguilera, Christina Come On Over Baby (A... 2000-08-05     14     1
## 6 Aguilera, Christina What A Girl Wants       1999-11-27      8     1
## # i 49 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice\_max}\NormalTok{(semana)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 5
##   artista musica entrou     semana   pos
##   <chr>   <chr>  <date>      <int> <dbl>
## 1 Creed   Higher 1999-09-11     65    49
\end{verbatim}
\item
  Aleatoriamente, criando uma amostra:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice\_sample}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 5
##   artista              musica             entrou     semana   pos
##   <chr>                <chr>              <date>      <int> <dbl>
## 1 Backstreet Boys, The Shape Of My Heart  2000-10-14     16    31
## 2 Madison Avenue       Don't Call Me Baby 2000-07-08     12    88
## 3 Jagged Edge          He Can't Love U    1999-12-11     20    77
## 4 Clark, Terri         A Little Gasoline  2000-12-16      6    99
## 5 Chesney, Kenny       I Lost It          2000-10-21      3    61
\end{verbatim}
\item
  Veja a ajuda de \texttt{slice} para saber mais sobre estas funções. Por exemplo:

  \begin{itemize}
  \item
    \texttt{slice\_min} e \texttt{slice\_max} podem considerar ou não empates.
  \item
    Você pode especificar uma proporção de linhas (usando \texttt{prop}) em vez da quantidade de linhas (\texttt{n}).
  \item
    Você pode fazer amostragem com reposição, ou com probabilidades diferentes para cada linha.
  \end{itemize}
\end{itemize}

\hypertarget{ordenando-linhas-arrange}{%
\subsection{\texorpdfstring{Ordenando linhas: \texttt{arrange}}{Ordenando linhas: arrange}}\label{ordenando-linhas-arrange}}

\begin{itemize}
\item
  Por título, sem repetições:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{distinct}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(musica)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 316 x 1
##   musica                 
##   <chr>                  
## 1 (Hot S**t) Country G...
## 2 3 Little Words         
## 3 911                    
## 4 A Country Boy Can Su...
## 5 A Little Gasoline      
## 6 A Puro Dolor (Purest...
## # i 310 more rows
\end{verbatim}
\item
  Por título, sem repetições, em ordem inversa:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{distinct}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(musica))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 316 x 1
##   musica                 
##   <chr>                  
## 1 www.memory             
## 2 Your Everything        
## 3 You're A God           
## 4 You'll Always Be Lov...
## 5 You Won't Be Lonely ...
## 6 You Should've Told M...
## # i 310 more rows
\end{verbatim}
\end{itemize}

\hypertarget{contando-linhas-count}{%
\subsection{\texorpdfstring{Contando linhas: \texttt{count}}{Contando linhas: count}}\label{contando-linhas-count}}

\begin{itemize}
\item
  Quantas semanas cada artista ficou nos \emph{top} $100$? Duas músicas na mesma semana contam como duas semanas.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(artista, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 228 x 2
##   artista             n
##   <chr>           <int>
## 1 Creed             104
## 2 Lonestar           95
## 3 Destiny's Child    92
## 4 N'Sync             74
## 5 Sisqo              74
## 6 3 Doors Down       73
## # i 222 more rows
\end{verbatim}
\item
  Quantas semanas cada música ficou nos \emph{top} $100$?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(musica, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 316 x 2
##   musica                  n
##   <chr>               <int>
## 1 Higher                 57
## 2 Amazed                 55
## 3 Breathe                53
## 4 Kryptonite             53
## 5 With Arms Wide Open    47
## 6 I Wanna Know           44
## # i 310 more rows
\end{verbatim}
\item
  Se houve músicas com o mesmo nome, mas de artistas diferentes, {\hl{o código acima está errado}}. O certo é

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(musica, artista, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 317 x 3
##   musica              artista          n
##   <chr>               <chr>        <int>
## 1 Higher              Creed           57
## 2 Amazed              Lonestar        55
## 3 Breathe             Hill, Faith     53
## 4 Kryptonite          3 Doors Down    53
## 5 With Arms Wide Open Creed           47
## 6 I Wanna Know        Joe             44
## # i 311 more rows
\end{verbatim}

  De fato, há uma diferença de uma linha.
\end{itemize}

\hypertarget{exercuxedcio-1}{%
\subsubsection{Exercício}\label{exercuxedcio-1}}

\begin{itemize}
\item
  Ache o título da música que tem dois artistas diferentes.

  \textbf{Sugestão:} conte por música e artista primeiro, depois só por música.
\end{itemize}

\hypertarget{agrupando-linhas-group_by-e-summarize}{%
\subsection{\texorpdfstring{Agrupando linhas: \texttt{group\_by} e \texttt{summarize}}{Agrupando linhas: group\_by e summarize}}\label{agrupando-linhas-group_by-e-summarize}}

\begin{itemize}
\item
  Qual foi a melhor posição que cada artista alcançou?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{melhor =} \FunctionTok{min}\NormalTok{(pos)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(melhor)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 228 x 2
##   artista             melhor
##   <chr>                <dbl>
## 1 Aaliyah                  1
## 2 Aguilera, Christina      1
## 3 Carey, Mariah            1
## 4 Creed                    1
## 5 Destiny's Child          1
## 6 Iglesias, Enrique        1
## # i 222 more rows
\end{verbatim}
\item
  Qual foi a melhor posição que cada música alcançou?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista, musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{melhor =} \FunctionTok{min}\NormalTok{(pos)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(melhor)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'artista'. You can override using
## the `.groups` argument.
\end{verbatim}

\begin{verbatim}
## # A tibble: 317 x 3
##   artista             musica                  melhor
##   <chr>               <chr>                    <dbl>
## 1 Aaliyah             Try Again                    1
## 2 Aguilera, Christina Come On Over Baby (A...      1
## 3 Aguilera, Christina What A Girl Wants            1
## 4 Carey, Mariah       Thank God I Found Yo...      1
## 5 Creed               With Arms Wide Open          1
## 6 Destiny's Child     Independent Women Pa...      1
## # i 311 more rows
\end{verbatim}
\item
  Quando usamos \texttt{summarize}, só o agrupamento {\hl{mais interno}} é desfeito. Isto significa que {\hl{o resultado acima ainda está agrupado por {\mbox{\texttt{artista}}}}}.
\item
  Quantas semanas cada artista ficou na posição $1$?

  A função \texttt{n()} é uma maneira conveniente de {\hl{obter o número de linhas de um grupo}} (ou, se não houver agrupamento, de toda a \emph{tibble}); mas {\hl{{\mbox{\texttt{n()}}} só pode ser chamada em certos contextos}}, como \texttt{summarise()} ou \texttt{mutate()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(pos }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{semanas =} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(semanas))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 15 x 2
##   artista             semanas
##   <chr>                 <int>
## 1 Destiny's Child          14
## 2 Santana                  10
## 3 Aguilera, Christina       6
## 4 Madonna                   4
## 5 Savage Garden             4
## 6 Iglesias, Enrique         3
## # i 9 more rows
\end{verbatim}
\item
  Perceba que \texttt{count}, que vimos mais acima, faz agrupamentos do mesmo modo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(pos }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(artista, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 15 x 2
##   artista                 n
##   <chr>               <int>
## 1 Destiny's Child        14
## 2 Santana                10
## 3 Aguilera, Christina     6
## 4 Madonna                 4
## 5 Savage Garden           4
## 6 Iglesias, Enrique       3
## # i 9 more rows
\end{verbatim}
\item
  Uma pergunta diferente: quais são os artistas cujas músicas apareceram no \emph{top} $100$ mais tempo depois do lançamento da música?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{semanas =} \FunctionTok{max}\NormalTok{(semana)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(semanas))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 228 x 2
##   artista          semanas
##   <chr>              <int>
## 1 Creed                 65
## 2 Lonestar              64
## 3 3 Doors Down          53
## 4 Hill, Faith           53
## 5 Joe                   44
## 6 Vertical Horizon      41
## # i 222 more rows
\end{verbatim}
\item
  Qual a posição média de cada música? Lembre-se de que eliminamos as linhas com \texttt{NA}; logo, {\hl{a média vai ser sobre a quantidade de semanas em que a música esteve na lista}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{media1 }\OtherTok{\textless{}{-}}\NormalTok{ bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista, musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{media =} \FunctionTok{mean}\NormalTok{(pos), }\AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(media)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{media1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 317 x 3
##   artista                          musica                  media
##   <chr>                            <chr>                   <dbl>
## 1 "Santana"                        Maria, Maria             10.5
## 2 "Madonna"                        Music                    13.5
## 3 "N'Sync"                         Bye Bye Bye              14.3
## 4 "Elliott, Missy \"Misdemeanor\"" Hot Boyz                 14.3
## 5 "Destiny's Child"                Independent Women Pa...  14.8
## 6 "Iglesias, Enrique"              Be With You              15.8
## # i 311 more rows
\end{verbatim}
\item
  E se quisermos {\hl{a média sobre o número de semanas desde a entrada da música até a última semana}} em que a música apareceu na lista?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{media2 }\OtherTok{\textless{}{-}}\NormalTok{ bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista, musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{media =} \FunctionTok{sum}\NormalTok{(pos)}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(semana), }\AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(media)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{media2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 317 x 3
##   artista                          musica                  media
##   <chr>                            <chr>                   <dbl>
## 1 "Santana"                        Maria, Maria             10.5
## 2 "Madonna"                        Music                    13.5
## 3 "N'Sync"                         Bye Bye Bye              14.3
## 4 "Elliott, Missy \"Misdemeanor\"" Hot Boyz                 14.3
## 5 "Destiny's Child"                Independent Women Pa...  14.8
## 6 "Iglesias, Enrique"              Be With You              15.8
## # i 311 more rows
\end{verbatim}

  As primeiras linhas são iguais, mas os resultados são diferentes:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{identical}\NormalTok{(media1, media2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE
\end{verbatim}
\end{itemize}

\hypertarget{exercuxedcios-4}{%
\section{Exercícios}\label{exercuxedcios-4}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Vamos trabalhar com um conjunto de dados sobre super-heróis.

  Carregue o \texttt{tidyverse} com o comando

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

  Execute o seguinte comando para ler os dados para uma \emph{tibble}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{arquivo }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}
  \StringTok{\textquotesingle{}https://github.com/fnaufel/\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}probestr/raw/master/data/\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}heroes\_information.csv\textquotesingle{}}      
\NormalTok{)}

\NormalTok{herois\_info }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}
\NormalTok{  arquivo,}
  \AttributeTok{na =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}NA\textquotesingle{}}\NormalTok{)}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \CommentTok{\# Eliminar a primeira coluna (números de série)}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \CommentTok{\# Renomear colunas restantes}
  \FunctionTok{rename}\NormalTok{(}
    \AttributeTok{nome =}\NormalTok{ name,}
    \AttributeTok{sexo =}\NormalTok{ Gender,}
    \AttributeTok{olhos =} \StringTok{\textquotesingle{}Eye color\textquotesingle{}}\NormalTok{,}
\NormalTok{    raça }\OtherTok{=}\NormalTok{ Race,}
    \AttributeTok{cabelos =} \StringTok{\textquotesingle{}Hair color\textquotesingle{}}\NormalTok{,}
    \AttributeTok{altura =}\NormalTok{ Height,}
    \AttributeTok{editora =}\NormalTok{ Publisher,}
    \AttributeTok{pele =} \StringTok{\textquotesingle{}Skin color\textquotesingle{}}\NormalTok{,}
    \AttributeTok{lado =}\NormalTok{ Alignment,}
    \AttributeTok{peso =}\NormalTok{ Weight}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}
\item
  Quantas linhas tem a \emph{tibble}?

  \begin{comment}



  ```r
  herois_info %>% nrow()
  ```

  ```
  ## [1] 734
  ```


    \end{comment}
\item
  Existem heróis que aparecem em mais de uma linha?

  \begin{comment}



  ```r
  herois_info %>% 
    count(nome)
  ```

  ```
  ## # A tibble: 715 x 2
  ##   nome              n
  ##   <chr>         <int>
  ## 1 A-Bomb            1
  ## 2 Abe Sapien        1
  ## 3 Abin Sur          1
  ## 4 Abomination       1
  ## 5 Abraxas           1
  ## 6 Absorbing Man     1
  ## # i 709 more rows
  ```

  Precisaríamos [examinar a tabela acima]{.hl}, procurando linhas com $n > 1$. 

  [Vamos pedir para o R fazer isto:]{.hl}


  ```r
  repetidos <- herois_info %>% 
    count(nome) %>% 
    filter(n > 1)

  repetidos
  ```

  ```
  ## # A tibble: 17 x 2
  ##   nome             n
  ##   <chr>        <int>
  ## 1 Angel            2
  ## 2 Atlas            2
  ## 3 Atom             2
  ## 4 Batgirl          2
  ## 5 Batman           2
  ## 6 Black Canary     2
  ## # i 11 more rows
  ```

  Vamos mostrar mais dados destes heróis:


  ```r
  herois_info %>% 
    filter(nome %in% repetidos$nome) %>% 
    select(nome, editora, raça, everything())
  ```

  ```
  ## # A tibble: 36 x 10
  ##   nome  editora      raça  sexo  olhos cabelos altura pele  lado   peso
  ##   <chr> <chr>        <chr> <chr> <chr> <chr>    <dbl> <chr> <chr> <dbl>
  ## 1 Angel Marvel Comi~ <NA>  Male  blue  Blond      183 <NA>  good     68
  ## 2 Angel Dark Horse ~ Vamp~ Male  <NA>  <NA>       -99 <NA>  good    -99
  ## 3 Atlas Marvel Comi~ Muta~ Male  brown Red        183 <NA>  good    101
  ## 4 Atlas DC Comics    God ~ Male  blue  Brown      198 <NA>  bad     126
  ## 5 Atom  DC Comics    <NA>  Male  blue  Red        178 <NA>  good     68
  ## 6 Atom  DC Comics    <NA>  Male  <NA>  <NA>       -99 <NA>  good    -99
  ## # i 30 more rows
  ```

  Em alguns casos, são editoras diferentes (como para Angel e Atlas). 

  Em alguns casos, o mesmo herói aparece com várias características.

  São $17$ heróis que aparecem mais de uma vez. É um número pequeno o bastante para corrigirmos a situação manualmente. 

  Como não tenho conhecimento suficiente sobre heróis para fazer isso, vou ignorar esta confusão e usar os dados como estão.


    \end{comment}
\item
  Quantas editoras diferentes existem na \emph{tibble}? Liste-as em ordem decrescente de quantidade de heróis.

  \begin{comment}



  ```r
  herois_info %>% count(editora, sort = TRUE)
  ```

  ```
  ## # A tibble: 25 x 2
  ##   editora               n
  ##   <chr>             <int>
  ## 1 Marvel Comics       388
  ## 2 DC Comics           215
  ## 3 NBC - Heroes         19
  ## 4 Dark Horse Comics    18
  ## 5 <NA>                 15
  ## 6 George Lucas         14
  ## # i 19 more rows
  ```


    \end{comment}
\item
  Vamos colocar todas as editores menores em uma classe só.

  Na coluna \texttt{editora}, substitua

  \begin{itemize}
  \tightlist
  \item
    `Marvel Comics' por `Marvel',
  \item
    `DC Comics' por `DC', e
  \item
    todas as outras editoras pelo termo `Outras'.
  \end{itemize}

  \textbf{Dica:} use a função \texttt{case\_when()}, do \texttt{tidyverse}.

  \begin{comment}



  ```r
  herois_info <- herois_info %>% 
    mutate(
      editora = case_when(
        editora == 'Marvel Comics' ~ 'Marvel',
        editora == 'DC Comics' ~ 'DC',
        TRUE ~ 'Outras'
      )
  )
  ```


    \end{comment}
\item
  Confira, novamente, a quantidade de valores diferentes na coluna \texttt{editora}.

  \begin{comment}



  ```r
  herois_info %>% count(editora, sort = TRUE)
  ```

  ```
  ## # A tibble: 3 x 2
  ##   editora     n
  ##   <chr>   <int>
  ## 1 Marvel    388
  ## 2 DC        215
  ## 3 Outras    131
  ```


    \end{comment}
\item
  Existem heróis sem informação de editora. Quantos? Quais são?

  \begin{comment}



  ```r
  herois_info %>% filter(is.na(editora))
  ```

  ```
  ## # A tibble: 0 x 10
  ## # i 10 variables: nome <chr>, sexo <chr>, olhos <chr>, raça <chr>,
  ## #   cabelos <chr>, altura <dbl>, editora <chr>, pele <chr>,
  ## #   lado <chr>, peso <dbl>
  ```

  Na verdade, a chamada a `case_when()`, da maneira como fiz, já substituiu os `NA` por 'Outras'. Entenda por quê.


    \end{comment}
\item
  Altere novamente a coluna \texttt{editora}, colocando o valor `Outras' para os heróis sem informação de editora. Use a função \texttt{if\_else()} (com \emph{underscore}, não a função \texttt{ifelse}).

  \begin{comment}


  Se, no seu caso, ainda houver valores `NA` em `editora`, basta fazer o seguinte:


  ```r
  herois_info <- herois_info %>% 
    mutate(
      editora = if_else(is.na(editora), 'Outras', editora)
    )
  ```


    \end{comment}
\item
  Confira, mais uma vez, a quantidade de valores diferentes na coluna \texttt{editora}.

  \begin{comment}



  ```r
  herois_info %>% count(editora, sort = TRUE)
  ```

  ```
  ## # A tibble: 3 x 2
  ##   editora     n
  ##   <chr>   <int>
  ## 1 Marvel    388
  ## 2 DC        215
  ## 3 Outras    131
  ```


    \end{comment}
\item
  Existem heróis sem informação de sexo? Quantos? Para estes heróis, coloque o valor `Desconhecido' na coluna \texttt{sexo}.

  \begin{comment}



  ```r
  herois_info %>% filter(is.na(sexo))
  ```

  ```
  ## # A tibble: 29 x 10
  ##   nome       sexo  olhos raça  cabelos altura editora pele  lado   peso
  ##   <chr>      <chr> <chr> <chr> <chr>    <dbl> <chr>   <chr> <chr> <dbl>
  ## 1 Bird-Brain <NA>  <NA>  <NA>  <NA>       -99 Marvel  <NA>  good    -99
  ## 2 Blaquesmi~ <NA>  black <NA>  No Hair    -99 Marvel  <NA>  good    -99
  ## 3 Box III    <NA>  blue  <NA>  Blond      193 Marvel  <NA>  good    110
  ## 4 Box IV     <NA>  brown <NA>  Brown ~    -99 Marvel  <NA>  good    -99
  ## 5 Captain U~ <NA>  <NA>  God ~ <NA>       -99 Marvel  <NA>  good    -99
  ## 6 Cecilia R~ <NA>  brown <NA>  Brown      170 Marvel  <NA>  good     62
  ## # i 23 more rows
  ```


  ```r
  herois_info <-  herois_info %>% 
    mutate(
      sexo = if_else(
        is.na(sexo),
        'Desconhecido',
        sexo
      )
    )
  ```

  Conferindo:


  ```r
  herois_info %>% filter(is.na(sexo))
  ```

  ```
  ## # A tibble: 0 x 10
  ## # i 10 variables: nome <chr>, sexo <chr>, olhos <chr>, raça <chr>,
  ## #   cabelos <chr>, altura <dbl>, editora <chr>, pele <chr>,
  ## #   lado <chr>, peso <dbl>
  ```


    \end{comment}
\item
  Qual a altura mínima? Qual a altura máxima? Substitua as alturas negativas por \texttt{NA}.

  \begin{comment}


  Podemos extrair o vetor de alturas com `pull` e usar a função `summary` do R    base, que retorna um vetor:


  ```r
  herois_info %>% 
    pull(altura) %>% 
    summary()
  ```

  ```
  ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  ##   -99,0   -99,0   175,0   102,3   185,0   975,0
  ```

  Ou podemos usar `summarize`, do `tidyverse`, que retorna uma *tibble*:


  ```r
  herois_info %>% 
    summarize(
      minimo = min(altura),
      maximo = max(altura)
    )
  ```

  ```
  ## # A tibble: 1 x 2
  ##   minimo maximo
  ##    <dbl>  <dbl>
  ## 1    -99    975
  ```

  Quantas alturas negativas existem?


  ```r
  herois_info %>% count(altura < 0)
  ```

  ```
  ## # A tibble: 2 x 2
  ##   `altura < 0`     n
  ##   <lgl>        <int>
  ## 1 FALSE          517
  ## 2 TRUE           217
  ```

  Substituindo as alturas negativas por `NA`:


  ```r
  herois_info <- herois_info %>% 
    mutate(
      altura = if_else(
        altura < 0,
        NA_real_,
        altura
      )
    )
  ```

  Como `if_else` (com *underscore*) é exigente, precisamos passar `NA_real_` em vez de `NA`.

  Situação atual:


  ```r
  herois_info %>% 
    pull(altura) %>% 
    summary()
  ```

  ```
  ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  ##    15,2   173,0   183,0   186,7   191,0   975,0     217
  ```


    \end{comment}
\item
  Qual o peso mínimo? Qual o peso máximo? Substitua os pesos negativos por \texttt{NA}.

  \begin{comment}


  Como fizemos com as alturas:


  ```r
  herois_info %>% 
    pull(peso) %>% 
    summary()
  ```

  ```
  ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  ##  -99,00  -99,00   62,00   43,86   90,00  900,00       2
  ```

  Observe que existem valores `NA` em peso.


  ```r
  herois_info %>% 
    summarize(
      minimo = min(peso),
      maximo = max(peso)
    )
  ```

  ```
  ## # A tibble: 1 x 2
  ##   minimo maximo
  ##    <dbl>  <dbl>
  ## 1     NA     NA
  ```

  Para ignorar os valores `NA` nas funções `min()` e `max()`:


  ```r
  herois_info %>% 
    summarize(
      minimo = min(peso, na.rm = TRUE),
      maximo = max(peso, na.rm = TRUE)
    )
  ```

  ```
  ## # A tibble: 1 x 2
  ##   minimo maximo
  ##    <dbl>  <dbl>
  ## 1    -99    900
  ```

  Quantos pesos negativos existem?


  ```r
  herois_info %>% count(peso < 0)
  ```

  ```
  ## # A tibble: 3 x 2
  ##   `peso < 0`     n
  ##   <lgl>      <int>
  ## 1 FALSE        495
  ## 2 TRUE         237
  ## 3 NA             2
  ```

  Substituindo por `NA`:


  ```r
  herois_info <- herois_info %>% 
    mutate(
      peso = if_else(
        peso < 0,
        NA_real_,
        peso
      )
    )
  ```

  Como `if_else` (com *underscore*) é exigente, precisamos passar `NA_real_`    em vez de `NA`.

  Situação atual:


  ```r
  herois_info %>% 
    pull(peso) %>% 
    summary()
  ```

  ```
  ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  ##     2,0    61,0    81,0   112,3   108,0   900,0     239
  ```


    \end{comment}
\item
  Qual é o peso médio de todos os heróis? Ignore os valores \texttt{NA}.

  \begin{comment}



  ```r
  herois_info %>% pull(peso) %>% mean(na.rm = TRUE)
  ```

  ```
  ## [1] 112,2525
  ```


    \end{comment}
\item
  Qual é a altura média de todos os heróis? Ignore os valores \texttt{NA}.

  \begin{comment}



  ```r
  herois_info %>% pull(altura) %>% mean(na.rm = TRUE)
  ```

  ```
  ## [1] 186,7263
  ```


    \end{comment}
\item
  Qual é a altura média dos heróis, por editora? Ignore os valores \texttt{NA}.

  \begin{comment}



  ```r
  herois_info %>% 
    group_by(editora) %>% 
    summarize(média = mean(altura, na.rm = TRUE))
  ```

  ```
  ## # A tibble: 3 x 2
  ##   editora média
  ##   <chr>   <dbl>
  ## 1 DC       181.
  ## 2 Marvel   191.
  ## 3 Outras   179.
  ```


    \end{comment}
\item
  Quais são os $3$ heróis mais altos de cada sexo?

  \begin{comment}



  ```r
  herois_info %>% 
    group_by(sexo) %>% 
    slice_max(altura, n = 3) %>% 
    select(nome, sexo, altura)
  ```

  ```
  ## # A tibble: 11 x 3
  ##   nome          sexo         altura
  ##   <chr>         <chr>         <dbl>
  ## 1 Living Brain  Desconhecido    198
  ## 2 Fabian Cortez Desconhecido    196
  ## 3 Box III       Desconhecido    193
  ## 4 Firelord      Desconhecido    193
  ## 5 Wolfsbane     Female          366
  ## 6 Rey           Female          297
  ## # i 5 more rows
  ```

  Como houve empates, foram mostrados $4$ de sexo desconhecido e $4$ do sexo feminino.

  Leia a documentação da função `slice_max` para descobrir como mostrar    exatamente $n$ de cada grupo. (Dica: "empate", em inglês, é "*tie*".)


    \end{comment}
\item
  Quais são as $3$ cores de olhos mais comuns para cada sexo?

  \begin{comment}



  ```r
  herois_info %>% 
    group_by(sexo) %>% 
    count(olhos, sort = TRUE) %>% 
    slice_head(n = 3)
  ```

  ```
  ## # A tibble: 9 x 3
  ##   sexo         olhos     n
  ##   <chr>        <chr> <int>
  ## 1 Desconhecido <NA>     10
  ## 2 Desconhecido blue      6
  ## 3 Desconhecido red       5
  ## 4 Female       blue     76
  ## 5 Female       green    43
  ## 6 Female       <NA>     41
  ## # i 3 more rows
  ```


    \end{comment}
\item
  Liste, por editora, as quantidades de heróis do bem, do mal, e neutros.

  \begin{comment}



  ```r
  herois_info %>% 
    group_by(editora) %>% 
    count(lado)
  ```

  ```
  ## # A tibble: 11 x 3
  ##   editora lado        n
  ##   <chr>   <chr>   <int>
  ## 1 DC      bad        59
  ## 2 DC      good      142
  ## 3 DC      neutral    13
  ## 4 DC      <NA>        1
  ## 5 Marvel  bad       115
  ## 6 Marvel  good      259
  ## # i 5 more rows
  ```

  ou


  ```r
  herois_info %>% 
    group_by(editora, lado) %>% 
    summarize(n())
  ```

  ```
  ## `summarise()` has grouped output by 'editora'. You can override using
  ## the `.groups` argument.
  ```

  ```
  ## # A tibble: 11 x 3
  ##   editora lado    `n()`
  ##   <chr>   <chr>   <int>
  ## 1 DC      bad        59
  ## 2 DC      good      142
  ## 3 DC      neutral    13
  ## 4 DC      <NA>        1
  ## 5 Marvel  bad       115
  ## 6 Marvel  good      259
  ## # i 5 more rows
  ```


    \end{comment}
\item
  Quantas raças diferentes existem?

  \begin{comment}



  ```r
  herois_info %>% 
    pull(raça) %>% 
    n_distinct()
  ```

  ```
  ## [1] 62
  ```

  ou (mostrando os nomes das raças e as quantidades de heróis por raça)


  ```r
  herois_info %>% 
    count(raça)
  ```

  ```
  ## # A tibble: 62 x 2
  ##   raça          n
  ##   <chr>     <int>
  ## 1 Alien         7
  ## 2 Alpha         5
  ## 3 Amazon        2
  ## 4 Android       9
  ## 5 Animal        4
  ## 6 Asgardian     5
  ## # i 56 more rows
  ```

  ou 


  ```r
  herois_info %>% 
    group_by(raça) %>% 
    summarise(n())
  ```

  ```
  ## # A tibble: 62 x 2
  ##   raça      `n()`
  ##   <chr>     <int>
  ## 1 Alien         7
  ## 2 Alpha         5
  ## 3 Amazon        2
  ## 4 Android       9
  ## 5 Animal        4
  ## 6 Asgardian     5
  ## # i 56 more rows
  ```


    \end{comment}
\item
  Qual a quantidade de raças diferentes de cada editora?

  \begin{comment}



  ```r
  herois_info %>% 
    group_by(editora) %>% 
    summarise(n = n_distinct(raça))
  ```

  ```
  ## # A tibble: 3 x 2
  ##   editora     n
  ##   <chr>   <int>
  ## 1 DC         30
  ## 2 Marvel     32
  ## 3 Outras     23
  ```


    \end{comment}
\item
  \textbf{DESAFIO:} Liste as raças que só pertencem a uma única editora.

  Existem várias maneiras de fazer isto. Experimente várias, até achar uma que seja mais elegante.

  \begin{comment}


  * Maneira simples, usando contagem:


    ```r
    herois_info %>% 
      group_by(raça) %>% 
      summarise(n_ed = n_distinct(editora)) %>% 
      filter(n_ed == 1)
    ```

    ```
    ## # A tibble: 47 x 2
    ##   raça        n_ed
    ##   <chr>      <int>
    ## 1 Alpha          1
    ## 2 Amazon         1
    ## 3 Asgardian      1
    ## 4 Bizarro        1
    ## 5 Bolovaxian     1
    ## 6 Clone          1
    ## # i 41 more rows
    ```

  * Maneira repetitiva, manual:


    ```r
    racas_marvel <- herois_info %>% 
      filter(editora == 'Marvel') %>% 
      select(raça) %>% 
      unique()

    racas_dc <- herois_info %>% 
      filter(editora == 'DC') %>% 
      select(raça) %>% 
      unique()

    racas_outras <- herois_info %>% 
      filter(editora == 'Outras') %>% 
      select(raça) %>% 
      unique()
    ```

    Exclusivas da Marvel:


    ```r
    racas_marvel %>% 
      setdiff(racas_dc) %>% 
      setdiff(racas_outras) %>% 
      arrange(raça)
    ```

    ```
    ## # A tibble: 17 x 1
    ##   raça          
    ##   <chr>         
    ## 1 Asgardian     
    ## 2 Clone         
    ## 3 Cosmic Entity 
    ## 4 Eternal       
    ## 5 Flora Colossus
    ## 6 Frost Giant   
    ## # i 11 more rows
    ```

    Exclusivas da DC:


    ```r
    racas_dc %>% 
      setdiff(racas_marvel) %>% 
      setdiff(racas_outras) %>% 
      arrange(raça)
    ```

    ```
    ## # A tibble: 17 x 1
    ##   raça           
    ##   <chr>          
    ## 1 Amazon         
    ## 2 Bizarro        
    ## 3 Bolovaxian     
    ## 4 Czarnian       
    ## 5 Gorilla        
    ## 6 Human-Vuldarian
    ## # i 11 more rows
    ```

    Exclusivas de outras editoras:


    ```r
    racas_outras %>% 
      setdiff(racas_dc) %>% 
      setdiff(racas_marvel) %>% 
      arrange(raça)
    ```

    ```
    ## # A tibble: 13 x 1
    ##   raça              
    ##   <chr>             
    ## 1 Alpha             
    ## 2 Dathomirian Zabrak
    ## 3 Gungan            
    ## 4 Human / Clone     
    ## 5 Human-Vulcan      
    ## 6 Icthyo Sapien     
    ## # i 7 more rows
    ```

  * Mesma maneira, mas usando uma função:


    ```r
    racas_exclusivas <- function(x) {

      esta_editora <- herois_info %>% 
        filter(editora == x) %>% 
        select(raça) %>% 
        unique()

      outras_editoras <- herois_info %>% 
        filter(editora != x) %>% 
        select(raça) %>% 
        unique()

      esta_editora %>%
        setdiff(outras_editoras) %>% 
        arrange(raça)
    }
    ```


    ```r
    racas_exclusivas('Marvel')
    ```

    ```
    ## # A tibble: 17 x 1
    ##   raça          
    ##   <chr>         
    ## 1 Asgardian     
    ## 2 Clone         
    ## 3 Cosmic Entity 
    ## 4 Eternal       
    ## 5 Flora Colossus
    ## 6 Frost Giant   
    ## # i 11 more rows
    ```


    ```r
    racas_exclusivas('DC')
    ```

    ```
    ## # A tibble: 17 x 1
    ##   raça           
    ##   <chr>          
    ## 1 Amazon         
    ## 2 Bizarro        
    ## 3 Bolovaxian     
    ## 4 Czarnian       
    ## 5 Gorilla        
    ## 6 Human-Vuldarian
    ## # i 11 more rows
    ```


    ```r
    racas_exclusivas('Outras')
    ```

    ```
    ## # A tibble: 13 x 1
    ##   raça              
    ##   <chr>             
    ## 1 Alpha             
    ## 2 Dathomirian Zabrak
    ## 3 Gungan            
    ## 4 Human / Clone     
    ## 5 Human-Vulcan      
    ## 6 Icthyo Sapien     
    ## # i 7 more rows
    ```

  * Maneira complicada, usando `join`:


    ```r
    herois_info %>% 
      select(raça, editora) %>% 
      group_by(raça) %>% 
      summarise(n_editoras = n_distinct(editora)) %>% 
      filter(n_editoras == 1) %>% 
      inner_join(herois_info, by = 'raça') %>% 
      select(raça, editora) %>% 
      unique() %>% 
      arrange(editora)
    ```

    ```
    ## # A tibble: 47 x 2
    ##   raça            editora
    ##   <chr>           <chr>  
    ## 1 Amazon          DC     
    ## 2 Bizarro         DC     
    ## 3 Bolovaxian      DC     
    ## 4 Czarnian        DC     
    ## 5 Gorilla         DC     
    ## 6 Human-Vuldarian DC     
    ## # i 41 more rows
    ```


    \end{comment}
\end{enumerate}

\hypertarget{examinando-tibbles-intermediuxe1rias}{%
\section{\texorpdfstring{Examinando \emph{tibbles} intermediárias}{Examinando tibbles intermediárias}}\label{examinando-tibbles-intermediuxe1rias}}

\begin{itemize}
\item
  \href{https://github.com/daranzolin/ViewPipeSteps}{O pacote \texttt{ViewPipeSteps}} serve para exibir (no console ou em \emph{tabs} no RStudio) as \emph{tibbles} que são resultados de cada passo em uma sequência de comandos montada com o \emph{pipe} \texttt{\%\textgreater{}\%}.
\item
  Instale o pacote com o comando

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ViewPipeSteps"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Carregue o pacote com

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ViewPipeSteps)}
\end{Highlighting}
\end{Shaded}
\item
  Para exibir, no console, as \emph{tibbles} intermediárias, acrescente \texttt{print\_pipe\_steps(all\ =\ TRUE)} após o último passo do \emph{pipe}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{resultado }\OtherTok{\textless{}{-}}\NormalTok{ bb\_tidy }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(artista, musica) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{media =} \FunctionTok{sum}\NormalTok{(pos)}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(semana), }\AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(media) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{print\_pipe\_steps}\NormalTok{(}\AttributeTok{all =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 1. bb_tidy
\end{verbatim}

\begin{verbatim}
## # A tibble: 5.307 x 5
##   artista musica                  entrou     semana   pos
##   <chr>   <chr>                   <date>      <int> <dbl>
## 1 2 Pac   Baby Don't Cry (Keep... 2000-02-26      1    87
## 2 2 Pac   Baby Don't Cry (Keep... 2000-02-26      2    82
## 3 2 Pac   Baby Don't Cry (Keep... 2000-02-26      3    72
## 4 2 Pac   Baby Don't Cry (Keep... 2000-02-26      4    77
## 5 2 Pac   Baby Don't Cry (Keep... 2000-02-26      5    87
## 6 2 Pac   Baby Don't Cry (Keep... 2000-02-26      6    94
## # i 5.301 more rows
\end{verbatim}

\begin{verbatim}
## 2. group_by(artista, musica)
\end{verbatim}

\begin{verbatim}
## # A tibble: 5.307 x 5
##   artista musica                  entrou     semana   pos
##   <chr>   <chr>                   <date>      <int> <dbl>
## 1 2 Pac   Baby Don't Cry (Keep... 2000-02-26      1    87
## 2 2 Pac   Baby Don't Cry (Keep... 2000-02-26      2    82
## 3 2 Pac   Baby Don't Cry (Keep... 2000-02-26      3    72
## 4 2 Pac   Baby Don't Cry (Keep... 2000-02-26      4    77
## 5 2 Pac   Baby Don't Cry (Keep... 2000-02-26      5    87
## 6 2 Pac   Baby Don't Cry (Keep... 2000-02-26      6    94
## # i 5.301 more rows
\end{verbatim}

\begin{verbatim}
## 3. summarize(media = sum(pos)/max(semana), .groups = "drop")
\end{verbatim}

\begin{verbatim}
## # A tibble: 317 x 3
##   artista      musica                  media
##   <chr>        <chr>                   <dbl>
## 1 2 Pac        Baby Don't Cry (Keep...  85.4
## 2 2Ge+her      The Hardest Part Of ...  90  
## 3 3 Doors Down Kryptonite               26.5
## 4 3 Doors Down Loser                    67.1
## 5 504 Boyz     Wobble Wobble            56.2
## 6 98^0         Give Me Just One Nig...  37.6
## # i 311 more rows
\end{verbatim}

\begin{verbatim}
## 4. arrange(media)
\end{verbatim}

\begin{verbatim}
## # A tibble: 317 x 3
##   artista                          musica                  media
##   <chr>                            <chr>                   <dbl>
## 1 "Santana"                        Maria, Maria             10.5
## 2 "Madonna"                        Music                    13.5
## 3 "N'Sync"                         Bye Bye Bye              14.3
## 4 "Elliott, Missy \"Misdemeanor\"" Hot Boyz                 14.3
## 5 "Destiny's Child"                Independent Women Pa...  14.8
## 6 "Iglesias, Enrique"              Be With You              15.8
## # i 311 more rows
\end{verbatim}
\item
  Para exibir as \emph{tibbles} intermediárias em \emph{tabs} do RStudio (como com a função \texttt{View()}), você pode usar o \emph{addin} \texttt{viewPipeChain}, que também faz parte deste pacote. Veja o exemplo \href{https://github.com/daranzolin/ViewPipeSteps}{no site do pacote}.
\end{itemize}

\hypertarget{viz}{%
\chapter{Visualização com ggplot2}\label{viz}}

\begin{rmdtip}
Busque mais informações sobre os pacotes \texttt{tidyverse} e \texttt{ggplot2} \protect\hyperlink{refrec}{nas referências recomendadas}.

\end{rmdtip}

\hypertarget{vuxeddeo-1-2}{%
\section{Vídeo 1}\label{vuxeddeo-1-2}}

\begin{center} \url{https://youtu.be/OBpNjqIIyhI} \end{center}

\hypertarget{componentes-de-um-gruxe1fico-ggplot2}{%
\section{Componentes de um gráfico ggplot2}\label{componentes-de-um-gruxe1fico-ggplot2}}

\hypertarget{geometrias-e-mapeamentos-estuxe9ticos-mappings}{%
\subsection{\texorpdfstring{Geometrias e mapeamentos estéticos (\emph{mappings})}{Geometrias e mapeamentos estéticos (mappings)}}\label{geometrias-e-mapeamentos-estuxe9ticos-mappings}}

\begin{itemize}
\tightlist
\item
  Observe o gráfico abaixo, obtido de \url{https://www.gapminder.org/downloads/updated-gapminder-world-poster-2015/}.
\end{itemize}

\begin{center}\includegraphics[width=1\linewidth]{images/countries-1} \end{center}

\begin{itemize}
\item
  O gráfico mostra como, em cada país, a saúde (mais precisamente, a expectativa de vida) se relaciona com a riqueza (mais precisamente, o PIB \emph{per capita}).
\item
  Além da expectativa de vida e o do PIB \emph{per capita}, o gráfico traz mais informações sobre cada país.
\item
  Cada país é representado por um ponto (a {\hl{geometria}}).
\item
  Informações sobre cada país são representadas por características do ponto correspondente (as {\hl{estéticas}}):

  \begin{longtable}[]{@{}lll@{}}
  \toprule()
  Variável & Geometria & Estética \\
  \midrule()
  \endhead
  PIB \emph{per capita} & ponto & posição x \\
  Expectativa de vida & ponto & posição y \\
  População & ponto & tamanho \\
  Continente & ponto & cor \\
  \bottomrule()
  \end{longtable}
\item
  Você pode usar outras estéticas para representar informações:

  \begin{itemize}
  \tightlist
  \item
    Cor de preenchimento.
  \item
    Cor do traço.
  \item
    Tipo do traço (sólido, pontilhado, tracejado etc.).
  \item
    Forma (círculo, quadrado, triângulo etc.).
  \item
    Opacidade.
  \item
    etc.
  \end{itemize}
\item
  Você pode usar outras geometrias:

  \begin{itemize}
  \tightlist
  \item
    Linhas.
  \item
    Barras ou colunas.
  \item
    Caixas.
  \item
    etc.
  \end{itemize}
\end{itemize}

\hypertarget{escalas-scales}{%
\subsection{\texorpdfstring{Escalas (\emph{scales})}{Escalas (scales)}}\label{escalas-scales}}

\begin{itemize}
\item
  As escalas controlam os detalhes da aparência da geometria e do mapeamento (eixos, cores etc.).
\item
  Os eixos do gráfico acima são escalas {\hl{contínuas}}, com valores reais.
\item
  Observe o eixo horizontal. Os valores não aumentam linearmente, mas sim exponencialmente: cada passo à direita equivale a \emph{dobrar} o valor do PIB. O eixo horizontal segue uma {\hl{escala logarítmica}}.
\item
  Os tamanhos dos pontos formam uma escala {\hl{discreta}}, com $4$ valores possíveis (veja a legenda no canto inferior direito do gráfico).
\item
  As cores também formam uma escala discreta.
\end{itemize}

\hypertarget{ruxf3tulos-labels}{%
\subsection{\texorpdfstring{Rótulos (\emph{labels})}{Rótulos (labels)}}\label{ruxf3tulos-labels}}

\begin{itemize}
\item
  O gráfico também representa informação na forma de texto.
\item
  Além de rótulos (por exemplo, o texto que identifica cada eixo), {\hl{o texto também pode, ele mesmo, ser uma geometria, com suas próprias estéticas:}} observe como o nome de cada país é escrito em um tamanho proporcional à sua população.
\end{itemize}

\hypertarget{outros-componentes}{%
\subsection{Outros componentes}\label{outros-componentes}}

\begin{itemize}
\item
  Coordenadas:

  \begin{itemize}
  \item
    Este gráfico usa {\hl{coordenadas cartesianas}}, com eixos $x$ e $y$.
  \item
    Existem gráficos que usam um sistema de {\hl{coordenadas polares}}.
  \end{itemize}
\item
  Temas:

  \begin{itemize}
  \item
    Incluem todos os elementos ``decorativos'': cor de fundo, linhas de grade, etc. Ajudam a facilitar a leitura e a interpretação.
  \item
    No gráfico acima, um detalhe interessante do tema é a divisão de cada eixo em segmentos claros e segmentos escuros.
  \end{itemize}
\item
  Legendas (\emph{guides}).
\item
  Facetas:

  \begin{itemize}
  \item
    Às vezes, um gráfico é composto por múltiplos subgráficos.
  \item
    Cada subgráfico é uma {\hl{faceta}}.
  \item
    Facetas evitam que informações demais sejam apresentadas no mesmo lugar.
  \end{itemize}
\end{itemize}

\hypertarget{mamiferos}{%
\section{Conjunto de dados}\label{mamiferos}}

\begin{itemize}
\item
  Nossos exemplos de gráficos vão usar dados sobre o sono de diversos mamíferos.
\item
  O conjunto de dados se chama \texttt{msleep} e está incluído no pacote \texttt{ggplot2}.
\item
  Para ver a documentação, digite

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\NormalTok{?msleep}
\end{Highlighting}
\end{Shaded}
\item
  Vamos atribuir o conjunto de dados à variável \texttt{df}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ msleep}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 83 x 11
##   name             genus vore  order conservation sleep_total sleep_rem
##   <chr>            <chr> <chr> <chr> <chr>              <dbl>     <dbl>
## 1 Cheetah          Acin~ carni Carn~ lc                  12.1      NA  
## 2 Owl monkey       Aotus omni  Prim~ <NA>                17         1.8
## 3 Mountain beaver  Aplo~ herbi Rode~ nt                  14.4       2.4
## 4 Greater short-t~ Blar~ omni  Sori~ lc                  14.9       2.3
## 5 Cow              Bos   herbi Arti~ domesticated         4         0.7
## 6 Three-toed sloth Brad~ herbi Pilo~ <NA>                14.4       2.2
## # i 77 more rows
## # i 4 more variables: sleep_cycle <dbl>, awake <dbl>, brainwt <dbl>,
## #   bodywt <dbl>
\end{verbatim}
\item
  Vamos examinar a estrutura --- usando R base:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## tibble [83 x 11] (S3: tbl_df/tbl/data.frame)
##  $ name        : chr [1:83] "Cheetah" "Owl monkey" "Mountain beaver" ...
##  $ genus       : chr [1:83] "Acinonyx" "Aotus" "Aplodontia" ...
##  $ vore        : chr [1:83] "carni" "omni" "herbi" ...
##  $ order       : chr [1:83] "Carnivora" "Primates" "Rodentia" ...
##  $ conservation: chr [1:83] "lc" NA "nt" ...
##  $ sleep_total : num [1:83] 12,1 17 14,4 14,9 4 14,4 8,7 7 ...
##  $ sleep_rem   : num [1:83] NA 1,8 2,4 2,3 0,7 2,2 1,4 NA ...
##  $ sleep_cycle : num [1:83] NA NA NA 0,133 ...
##  $ awake       : num [1:83] 11,9 7 9,6 9,1 20 9,6 15,3 17 ...
##  $ brainwt     : num [1:83] NA 0,0155 NA 0,00029 0,423 NA NA NA ...
##  $ bodywt      : num [1:83] 50 0,48 1,35 0,019 ...
\end{verbatim}
\item
  Podemos usar \texttt{glimpse}, uma função do \texttt{tidyverse}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glimpse}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 83
## Columns: 11
## $ name         <chr> "Cheetah", "Owl monkey", "Mountain beaver", "Gre~
## $ genus        <chr> "Acinonyx", "Aotus", "Aplodontia", "Blarina", "B~
## $ vore         <chr> "carni", "omni", "herbi", "omni", "herbi", "herb~
## $ order        <chr> "Carnivora", "Primates", "Rodentia", "Soricomorp~
## $ conservation <chr> "lc", NA, "nt", "lc", "domesticated", NA, "vu", ~
## $ sleep_total  <dbl> 12,1, 17,0, 14,4, 14,9, 4,0, 14,4, 8,7, 7,0, 10,~
## $ sleep_rem    <dbl> NA, 1,8, 2,4, 2,3, 0,7, 2,2, 1,4, NA, 2,9, NA, 0~
## $ sleep_cycle  <dbl> NA, NA, NA, 0,1333333, 0,6666667, 0,7666667, 0,3~
## $ awake        <dbl> 11,9, 7,0, 9,6, 9,1, 20,0, 9,6, 15,3, 17,0, 13,9~
## $ brainwt      <dbl> NA, 0,01550, NA, 0,00029, 0,42300, NA, NA, NA, 0~
## $ bodywt       <dbl> 50,000, 0,480, 1,350, 0,019, 600,000, 3,850, 20,~
\end{verbatim}
\item
  Para examinar só as primeiras linhas do \emph{data frame}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 11
##   name             genus vore  order conservation sleep_total sleep_rem
##   <chr>            <chr> <chr> <chr> <chr>              <dbl>     <dbl>
## 1 Cheetah          Acin~ carni Carn~ lc                  12.1      NA  
## 2 Owl monkey       Aotus omni  Prim~ <NA>                17         1.8
## 3 Mountain beaver  Aplo~ herbi Rode~ nt                  14.4       2.4
## 4 Greater short-t~ Blar~ omni  Sori~ lc                  14.9       2.3
## 5 Cow              Bos   herbi Arti~ domesticated         4         0.7
## 6 Three-toed sloth Brad~ herbi Pilo~ <NA>                14.4       2.2
## # i 4 more variables: sleep_cycle <dbl>, awake <dbl>, brainwt <dbl>,
## #   bodywt <dbl>
\end{verbatim}
\item
  Para examinar o \emph{data frame} interativamente:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}
\item
  Podemos produzir um sumário dos dados usando o pacote \emph{summarytools} (que já foi carregado neste documento):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{dfSummary}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{print}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{longtable}[]{@{}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1928}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.3976}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2771}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1325}}@{}}
  \toprule()
  \begin{minipage}[b]{\linewidth}\raggedright
  Variável
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Estatísticas / Valores
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Freqs (\% de Válidos)
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Faltante
  \end{minipage} \\
  \midrule()
  \endhead
  \begin{minipage}[t]{\linewidth}\raggedright
  name\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. African elephant\\
  2. African giant pouched rat\\
  3. African striped mouse\\
  4. Arctic fox\\
  5. Arctic ground squirrel\\
  6. Asian elephant\\
  7. Baboon\\
  8. Big brown bat\\
  9. Bottle-nosed dolphin\\
  10. Brazilian tapir\\
  {[} 73 outros {]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  73 (88,0\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  genus\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. Panthera\\
  2. Spermophilus\\
  3. Equus\\
  4. Vulpes\\
  5. Acinonyx\\
  6. Aotus\\
  7. Aplodontia\\
  8. Blarina\\
  9. Bos\\
  10. Bradypus\\
  {[} 67 outros {]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  3 ( 3,6\%)\\
  3 ( 3,6\%)\\
  2 ( 2,4\%)\\
  2 ( 2,4\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  67 (80,7\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  vore\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. carni\\
  2. herbi\\
  3. insecti\\
  4. omni\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  19 (25,0\%)\\
  32 (42,1\%)\\
  5 ( 6,6\%)\\
  20 (26,3\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  7\\
  (8,4\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  order\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. Rodentia\\
  2. Carnivora\\
  3. Primates\\
  4. Artiodactyla\\
  5. Soricomorpha\\
  6. Cetacea\\
  7. Hyracoidea\\
  8. Perissodactyla\\
  9. Chiroptera\\
  10. Cingulata\\
  {[} 9 outros {]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  22 (26,5\%)\\
  12 (14,5\%)\\
  12 (14,5\%)\\
  6 ( 7,2\%)\\
  5 ( 6,0\%)\\
  3 ( 3,6\%)\\
  3 ( 3,6\%)\\
  3 ( 3,6\%)\\
  2 ( 2,4\%)\\
  2 ( 2,4\%)\\
  13 (15,7\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  conservation\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. cd\\
  2. domesticated\\
  3. en\\
  4. lc\\
  5. nt\\
  6. vu\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  2 ( 3,7\%)\\
  10 (18,5\%)\\
  4 ( 7,4\%)\\
  27 (50,0\%)\\
  4 ( 7,4\%)\\
  7 (13,0\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  29\\
  (34,9\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  sleep\_total\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 10,4 (4,5)\\
  mín \textless{} mediana \textless{} máx:\\
  1,9 \textless{} 10,1 \textless{} 19,9\\
  IQE (CV) : 5,9 (0,4)\strut
  \end{minipage} & 65 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  sleep\_rem\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 1,9 (1,3)\\
  mín \textless{} mediana \textless{} máx:\\
  0,1 \textless{} 1,5 \textless{} 6,6\\
  IQE (CV) : 1,5 (0,7)\strut
  \end{minipage} & 32 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  22\\
  (26,5\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  sleep\_cycle\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 0,4 (0,4)\\
  mín \textless{} mediana \textless{} máx:\\
  0,1 \textless{} 0,3 \textless{} 1,5\\
  IQE (CV) : 0,4 (0,8)\strut
  \end{minipage} & 22 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  51\\
  (61,4\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  awake\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 13,6 (4,5)\\
  mín \textless{} mediana \textless{} máx:\\
  4,1 \textless{} 13,9 \textless{} 22,1\\
  IQE (CV) : 5,9 (0,3)\strut
  \end{minipage} & 65 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  brainwt\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 0,3 (1)\\
  mín \textless{} mediana \textless{} máx:\\
  0 \textless{} 0 \textless{} 5,7\\
  IQE (CV) : 0,1 (3,5)\strut
  \end{minipage} & 53 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  27\\
  (32,5\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  bodywt\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 166,1 (786,8)\\
  mín \textless{} mediana \textless{} máx:\\
  0 \textless{} 1,7 \textless{} 6654\\
  IQE (CV) : 41,6 (4,7)\strut
  \end{minipage} & 82 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \bottomrule()
  \end{longtable}
\item
  Vemos que há muitos \texttt{NA} em diversas variáveis. Para nossos exemplos simples de visualização, vamos usar as colunas

  \begin{itemize}
  \tightlist
  \item
    \texttt{name}
  \item
    \texttt{genus}
  \item
    \texttt{order}
  \item
    \texttt{sleep\_total}
  \item
    \texttt{awake}
  \item
    \texttt{bodywt}
  \item
    \texttt{brainwt}
  \end{itemize}
\item
  Mas\ldots{} a coluna que mostra a dieta (\texttt{vore}) tem só 7 \texttt{NA}. Quais são?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(vore)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(name)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 7 x 1
##   name           
##   <chr>          
## 1 Vesper mouse   
## 2 Desert hedgehog
## 3 Deer mouse     
## 4 Phalanger      
## 5 Rock hyrax     
## 6 Mole rat       
## # i 1 more row
\end{verbatim}
\item
  OK. Vamos manter a coluna \texttt{vore} também, apesar dos \texttt{NA}. Quando formos usar esta variável, tomaremos cuidado.
\item
  Também\ldots{} a coluna \texttt{bodywt} tem 0 como valor mínimo. Como assim?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(name, bodywt) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(bodywt)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 35 x 2
##   name                       bodywt
##   <chr>                       <dbl>
## 1 Lesser short-tailed shrew   0.005
## 2 Little brown bat            0.01 
## 3 Greater short-tailed shrew  0.019
## 4 Deer mouse                  0.021
## 5 House mouse                 0.022
## 6 Big brown bat               0.023
## # i 29 more rows
\end{verbatim}
\item
  Ah, sem problema. A função \texttt{dfSummary} arredondou estes pesos para 0. Os valores de verdade ainda estão na \emph{tibble}.
\item
  Vamos criar uma \emph{tibble} nova, só com as colunas que nos interessam:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}
\NormalTok{    name, order, genus, vore, bodywt, }
\NormalTok{    brainwt, awake, sleep\_total}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}
\item
  Vamos ver o sumário:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{dfSummary}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{print}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{longtable}[]{@{}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1829}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.4024}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2805}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1341}}@{}}
  \toprule()
  \begin{minipage}[b]{\linewidth}\raggedright
  Variável
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Estatísticas / Valores
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Freqs (\% de Válidos)
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Faltante
  \end{minipage} \\
  \midrule()
  \endhead
  \begin{minipage}[t]{\linewidth}\raggedright
  name\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. African elephant\\
  2. African giant pouched rat\\
  3. African striped mouse\\
  4. Arctic fox\\
  5. Arctic ground squirrel\\
  6. Asian elephant\\
  7. Baboon\\
  8. Big brown bat\\
  9. Bottle-nosed dolphin\\
  10. Brazilian tapir\\
  {[} 73 outros {]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  73 (88,0\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  order\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. Rodentia\\
  2. Carnivora\\
  3. Primates\\
  4. Artiodactyla\\
  5. Soricomorpha\\
  6. Cetacea\\
  7. Hyracoidea\\
  8. Perissodactyla\\
  9. Chiroptera\\
  10. Cingulata\\
  {[} 9 outros {]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  22 (26,5\%)\\
  12 (14,5\%)\\
  12 (14,5\%)\\
  6 ( 7,2\%)\\
  5 ( 6,0\%)\\
  3 ( 3,6\%)\\
  3 ( 3,6\%)\\
  3 ( 3,6\%)\\
  2 ( 2,4\%)\\
  2 ( 2,4\%)\\
  13 (15,7\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  genus\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. Panthera\\
  2. Spermophilus\\
  3. Equus\\
  4. Vulpes\\
  5. Acinonyx\\
  6. Aotus\\
  7. Aplodontia\\
  8. Blarina\\
  9. Bos\\
  10. Bradypus\\
  {[} 67 outros {]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  3 ( 3,6\%)\\
  3 ( 3,6\%)\\
  2 ( 2,4\%)\\
  2 ( 2,4\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  1 ( 1,2\%)\\
  67 (80,7\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  vore\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. carni\\
  2. herbi\\
  3. insecti\\
  4. omni\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  19 (25,0\%)\\
  32 (42,1\%)\\
  5 ( 6,6\%)\\
  20 (26,3\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  7\\
  (8,4\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  bodywt\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 166,1 (786,8)\\
  mín \textless{} mediana \textless{} máx:\\
  0 \textless{} 1,7 \textless{} 6654\\
  IQE (CV) : 41,6 (4,7)\strut
  \end{minipage} & 82 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  brainwt\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 0,3 (1)\\
  mín \textless{} mediana \textless{} máx:\\
  0 \textless{} 0 \textless{} 5,7\\
  IQE (CV) : 0,1 (3,5)\strut
  \end{minipage} & 53 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  27\\
  (32,5\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  awake\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 13,6 (4,5)\\
  mín \textless{} mediana \textless{} máx:\\
  4,1 \textless{} 13,9 \textless{} 22,1\\
  IQE (CV) : 5,9 (0,3)\strut
  \end{minipage} & 65 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  sleep\_total\\
  {[}numeric{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  Média (dp) : 10,4 (4,5)\\
  mín \textless{} mediana \textless{} máx:\\
  1,9 \textless{} 10,1 \textless{} 19,9\\
  IQE (CV) : 5,9 (0,4)\strut
  \end{minipage} & 65 valores distintos & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \bottomrule()
  \end{longtable}
\end{itemize}

\hypertarget{gruxe1ficos-de-dispersuxe3o-scatter-plots}{%
\section{\texorpdfstring{Gráficos de dispersão (\emph{scatter plots})}{Gráficos de dispersão (scatter plots)}}\label{gruxe1ficos-de-dispersuxe3o-scatter-plots}}

\begin{itemize}
\item
  Servem para visualizar a \emph{relação} entre {\hl{duas variáveis quantitativas.}}
\item
  {\hl{Essa relação \emph{não} é necessariamente de causa e efeito.}}
\item
  Isto é, a variável do eixo horizontal não determina, necessariamente, os valores da variável do eixo vertical.
\item
  Pense em {\hl{associação}}, {\hl{correlação}}, não em causalidade.
\item
  Troque as variáveis de eixo, se ajudar a deixar isto claro.
\end{itemize}

\hypertarget{horas-de-sono-e-peso-corporal}{%
\subsection{Horas de sono e peso corporal}\label{horas-de-sono-e-peso-corporal}}

\begin{itemize}
\item
  Como as variáveis \texttt{sleep\_total} e \texttt{bodywt} estão relacionadas?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/sono-peso-plot-1-1} \end{center}
\item
  O que houve? Cadê os pontos?
\item
  O problema foi que só especificamos o mapeamento estético (com \texttt{aes}, que são as iniciais de \emph{aesthetics}). {\hl{Faltou a geometria.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/sono-peso-plot-2-1} \end{center}
\item
  Que horror.
\item
  A única coisa que percebemos aqui é que os mamíferos muito pesados dormem menos de $5$ horas por noite.
\item
  Estes animais muito pesados estão estragando a escala do eixo $x$.
\item
  Que animais são estes?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textgreater{}} \DecValTok{250}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(name, bodywt) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(bodywt)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 2
##   name             bodywt
##   <chr>             <dbl>
## 1 Horse              521 
## 2 Cow                600 
## 3 Pilot whale        800 
## 4 Giraffe            900.
## 5 Asian elephant    2547 
## 6 African elephant  6654
\end{verbatim}
\item
  Além disso, há muitos pontos sobrepostos. Em bom português, temos um problema de \emph{overplotting}.
\item
  Existem diversas maneiras de lidar com isso.
\item
  A primeira delas é {\hl{alterando a opacidade dos pontos}}. Isto é um ajuste na geometria apenas, pois a opacidade, aqui, não representa informação nenhuma.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/sono-peso-plot-alfa-1} \end{center}
\item
  Outra maneira é usar \texttt{geom\_jitter} em vez de \texttt{geom\_point}. ``\emph{Jitter}'' significa ``tremer''. As posições dos pontos são ligeiramente perturbadas, para evitar colisões. Perdemos precisão, mas a visualização fica melhor.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{width =} \DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/sono-peso-plot-jitter-1} \end{center}
\item
  Vamos mudar os limites do gráfico para nos concentrarmos nos animais menos pesados. Observe que {\hl{isto é um ajuste na escala}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{200}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 7 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/sono-peso-plot-3-1} \end{center}
\item
  Nestes limites, a relação entre horas de sono e peso não é mais tão pronunciada.
\end{itemize}

\hypertarget{horas-de-sono-e-peso-corporal-para-animais-pequenos}{%
\subsection{Horas de sono e peso corporal para animais pequenos}\label{horas-de-sono-e-peso-corporal-para-animais-pequenos}}

\begin{itemize}
\item
  Vamos restringir o gráfico a animais com no máximo $5$kg.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{limite }\OtherTok{\textless{}{-}} \DecValTok{5}
\end{Highlighting}
\end{Shaded}
\item
  Em vez de mudar a escala do gráfico, vamos filtrar as linhas do \emph{data frame}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/sono-peso-plot-pequenos-1} \end{center}
\end{itemize}

\hypertarget{incluindo-a-dieta}{%
\subsection{Incluindo a dieta}\label{incluindo-a-dieta}}

\begin{itemize}
\item
  Com a estética \texttt{color}. Observe como a legenda aparece automaticamente.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total, }\AttributeTok{color =}\NormalTok{ vore)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/plot-sono-peso-dieta-1} \end{center}
\end{itemize}

\hypertarget{a-estuxe9tica-pode-ser-especificada-na-geom}{%
\subsection{\texorpdfstring{A estética pode ser especificada na \texttt{geom}}{A estética pode ser especificada na geom}}\label{a-estuxe9tica-pode-ser-especificada-na-geom}}

\begin{itemize}
\item
  Compare com o código anterior.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total, }\AttributeTok{color =}\NormalTok{ vore))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/plot-sono-peso-dieta-geom-1} \end{center}
\item
  Fazendo deste modo, a estética só vale para uma geometria. Se você acrescentar outras geometrias (linhas, por exemplo), a estética não valerá para elas.
\end{itemize}

\hypertarget{aparuxeancia-fixa-ou-dependendo-de-variuxe1vel}{%
\subsection{Aparência fixa ou dependendo de variável?}\label{aparuxeancia-fixa-ou-dependendo-de-variuxe1vel}}

\begin{itemize}
\item
  Se for fixa, não é estética. Não representa informação.
\item
  Se depender de variável, é estética. Representa informação.
\item
  Compare o último \emph{chunk} acima com:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total), }\AttributeTok{color =} \StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/plot-sono-peso-cor-1} \end{center}
\item
  Se for uma estética, precisa estar {\hl{associada a uma variável}}, não a um valor fixo. Um erro comum seria fazer:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ sleep\_total, }\AttributeTok{color =} \StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/plot-sono-peso-cor-erro-1} \end{center}
\end{itemize}

\hypertarget{uma-correlauxe7uxe3o-mais-clara}{%
\subsection{Uma correlação mais clara}\label{uma-correlauxe7uxe3o-mais-clara}}

\begin{itemize}
\item
  Peso cerebral versus peso corporal:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ brainwt)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 27 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/cerebro-corpo-1} \end{center}
\item
  A mensagem de aviso (\emph{warning}) diz que há $27$ valores faltantes (\texttt{NA}) em \texttt{bodywt} ou \texttt{brainwt}. De fato:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(bodywt)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 1
##       n
##   <int>
## 1     0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(brainwt)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 1
##       n
##   <int>
## 1    27
\end{verbatim}
\item
  Vamos restringir aos animais mais leves e mudar a opacidade:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ bodywt, }\AttributeTok{y =}\NormalTok{ brainwt)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 18 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/cerebro-corpo-2-1} \end{center}
\item
  Vamos incluir horas de sono e dieta. Observe as estéticas usadas.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}
      \AttributeTok{x =}\NormalTok{ bodywt, }
      \AttributeTok{y =}\NormalTok{ brainwt,}
      \AttributeTok{size =}\NormalTok{ sleep\_total,}
      \AttributeTok{color =}\NormalTok{ vore}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 18 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/cerebro-corpo-3-1} \end{center}
\item
  Vamos mudar a escala dos tamanhos e incluir rótulos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grafico }\OtherTok{\textless{}{-}}\NormalTok{ sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(bodywt }\SpecialCharTok{\textless{}}\NormalTok{ limite) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}
      \AttributeTok{x =}\NormalTok{ bodywt, }
      \AttributeTok{y =}\NormalTok{ brainwt,}
      \AttributeTok{size =}\NormalTok{ sleep\_total,}
      \AttributeTok{color =}\NormalTok{ vore}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_size}\NormalTok{(}
      \AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{24}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Peso do cérebro versus peso corporal\textquotesingle{}}\NormalTok{,}
      \AttributeTok{subtitle =} \FunctionTok{paste0}\NormalTok{(}
        \StringTok{\textquotesingle{}para mamíferos com menos de \textquotesingle{}}\NormalTok{, }
\NormalTok{        limite, }
        \StringTok{\textquotesingle{} kg\textquotesingle{}}
\NormalTok{      ),}
      \AttributeTok{caption =} \StringTok{\textquotesingle{}Fonte: dataset \textasciigrave{}msleep\textasciigrave{}\textquotesingle{}}\NormalTok{,}
      \AttributeTok{x =} \StringTok{\textquotesingle{}Peso corporal (kg)\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \StringTok{\textquotesingle{}Peso do}\SpecialCharTok{\textbackslash{}n}\StringTok{ cérebro (kg)\textquotesingle{}}\NormalTok{,}
      \AttributeTok{color =} \StringTok{\textquotesingle{}Dieta\textquotesingle{}}\NormalTok{,}
      \AttributeTok{size =} \StringTok{\textquotesingle{}Horas}\SpecialCharTok{\textbackslash{}n}\StringTok{de sono\textquotesingle{}}
\NormalTok{    )}

\NormalTok{grafico}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 18 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/cerebro-corpo-4-1} \end{center}
\item
  Vamos mudar as cores usadas para a dieta, usando uma escala diferente.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grafico2 }\OtherTok{\textless{}{-}}\NormalTok{ grafico }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}
    \AttributeTok{palette =} \StringTok{\textquotesingle{}RdBu\textquotesingle{}}\NormalTok{,}
    \AttributeTok{na.value =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
    \AttributeTok{type =}\NormalTok{ scale\_color\_brewer}
\NormalTok{  )}

\NormalTok{grafico2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 18 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-174-1} \end{center}
\item
  Observe como usamos o gráfico já salvo na variável \texttt{grafico} e simplesmente acrescentamos a nova escala. Este tipo de ``montagem'' de gráficos \texttt{ggplot2} é bem conveniente, para evitar repetição de código.
\item
  Um último ajuste na aparência: os pontos na legenda ``Dieta'' estão pequenos demais. Quase não identificamos as cores deles.

  Vamos usar a função \texttt{guides} para modificar (\emph{override}) a estética \texttt{color} --- {\hl{apenas na legenda, não nos pontos mostrados no gráfico, cujos tamanhos representam o número de horas de sono}} --- tornando o tamanho maior. \href{https://ggplot2-book.org/scale-colour.html\#guide_legend}{Leia mais sobre \texttt{override.aes} neste \emph{link} (em inglês)}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grafico3 }\OtherTok{\textless{}{-}}\NormalTok{ grafico2 }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{color =} \FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{override.aes =} \FunctionTok{list}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{)))}

\NormalTok{grafico3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 18 rows containing missing values (`geom_point()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-175-1} \end{center}
\item
  Agora podemos finalmente comentar sobre a informação que o gráfico mostra sobre os dados:

  \begin{itemize}
  \item
    De fato, existe uma correlação entre peso cerebral e peso corporal: quanto maior o peso corporal, maior o peso cerebral. Nada surprenndente.
  \item
    \protect\hypertarget{grafico4}{}{} Podemos fazer o \texttt{ggplot2} traçar uma reta de regressão com a geometria \texttt{geom\_smooth}. Vamos falar mais sobre correlação \protect\hyperlink{correlacao}{em um capítulo futuro}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grafico4 }\OtherTok{\textless{}{-}}\NormalTok{ grafico3 }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \DecValTok{1}\NormalTok{), }
    \AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{,}
    \AttributeTok{method =} \StringTok{\textquotesingle{}lm\textquotesingle{}}\NormalTok{, }
    \AttributeTok{se =} \ConstantTok{FALSE}
\NormalTok{  )}

\NormalTok{grafico4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## i Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 18 rows containing non-finite values
## (`stat_smooth()`).
\end{verbatim}

\begin{verbatim}
## Warning: The following aesthetics were dropped during statistical transformation: size, colour
## i This can happen when ggplot fails to infer the correct grouping structure in the data.
## i Did you forget to specify a `group` aesthetic or to convert a numerical variable into a factor?
\end{verbatim}

\begin{verbatim}
## Warning: Removed 18 rows containing missing values (`geom_point()`).
\end{verbatim}

    \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-176-1} \end{center}
  \item
    Todos os carnívoros têm peso corporal maior que $1$kg e peso cerebral maior ou igual a $10$g.
  \item
    Só um carnívoro dorme $8$ horas ou menos. Qual?
  \item
    Todos os insetívoros --- com exceção de um (qual?) --- são muito leves e dormem muito.
  \item
    Todos os onívoros têm menos de $2$kg de peso corporal e $20$g ou menos de peso cerebral.
  \end{itemize}
\end{itemize}

\hypertarget{vuxeddeo-2-1}{%
\section{Vídeo 2}\label{vuxeddeo-2-1}}

\begin{center} \url{https://youtu.be/c-LoZ9e8xWc} \end{center}

\hypertarget{histogramas-e-cia.}{%
\section{Histogramas e cia.}\label{histogramas-e-cia.}}

\begin{itemize}
\tightlist
\item
  A idéia agora é {\hl{agrupar indivíduos em classes,}} dependendo do valor de uma variável quantitativa.
\end{itemize}

\hypertarget{distribuiuxe7uxf5es-de-frequuxeancia}{%
\subsection{Distribuições de frequência}\label{distribuiuxe7uxf5es-de-frequuxeancia}}

\begin{itemize}
\item
  Vamos nos concentrar nas horas de sono.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono}\SpecialCharTok{$}\NormalTok{sleep\_total}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 12,1 17,0 14,4 14,9  4,0 14,4  8,7  7,0 10,1  3,0  5,3  9,4 10,0
## [14] 12,5 10,3  8,3  9,1 17,4  5,3 18,0  3,9 19,7  2,9  3,1 10,1 10,9
## [27] 14,9 12,5  9,8  1,9  2,7  6,2  6,3  8,0  9,5  3,3 19,4 10,1 14,2
## [40] 14,3 12,8 12,5 19,9 14,6 11,0  7,7 14,5  8,4  3,8  9,7 15,8 10,4
## [53] 13,5  9,4 10,3 11,0 11,5 13,7  3,5  5,6 11,1 18,1  5,4 13,0  8,7
## [66]  9,6  8,4 11,3 10,6 16,6 13,8 15,9 12,8  9,1  8,6 15,8  4,4 15,6
## [79]  8,9  5,2  6,3 12,5  9,8
\end{verbatim}
\item
  Antes de montar o histograma, vamos construir uma {\hl{distribuição de frequência.}}
\item
  A {\hl{amplitude}} é a diferença entre o valor máximo e o valor mínimo. A função \texttt{range} não retorna a amplitude, mas sim os valores mínimo e máximo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono}\SpecialCharTok{$}\NormalTok{sleep\_total }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{range}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  1,9 19,9
\end{verbatim}
\item
  Vamos decidir que cada classe vai ter $2$ horas. A função \texttt{cut} substitui os valores do vetor pelos nomes das classes:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono}\SpecialCharTok{$}\NormalTok{sleep\_total }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{cut}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{right =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] [12,14) [16,18) [14,16) [14,16) [4,6)   [14,16) [8,10)  [6,8)  
##  [9] [10,12) [2,4)   [4,6)   [8,10)  [10,12) [12,14) [10,12) [8,10) 
## [17] [8,10)  [16,18) [4,6)   [18,20) [2,4)   [18,20) [2,4)   [2,4)  
## [25] [10,12) [10,12) [14,16) [12,14) [8,10)  [0,2)   [2,4)   [6,8)  
## [33] [6,8)   [8,10)  [8,10)  [2,4)   [18,20) [10,12) [14,16) [14,16)
## [41] [12,14) [12,14) [18,20) [14,16) [10,12) [6,8)   [14,16) [8,10) 
## [49] [2,4)   [8,10)  [14,16) [10,12) [12,14) [8,10)  [10,12) [10,12)
## [57] [10,12) [12,14) [2,4)   [4,6)   [10,12) [18,20) [4,6)   [12,14)
## [65] [8,10)  [8,10)  [8,10)  [10,12) [10,12) [16,18) [12,14) [14,16)
## [73] [12,14) [8,10)  [8,10)  [14,16) [4,6)   [14,16) [8,10)  [4,6)  
## [81] [6,8)   [12,14) [8,10) 
## 10 Levels: [0,2) [2,4) [4,6) [6,8) [8,10) [10,12) [12,14) ... [18,20)
\end{verbatim}
\item
  A função \texttt{table} faz a contagem dos elementos de cada classe:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono}\SpecialCharTok{$}\NormalTok{sleep\_total }\SpecialCharTok{\%\textgreater{}\%}  
  \FunctionTok{cut}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{right =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{table}\NormalTok{(}\AttributeTok{dnn =} \StringTok{\textquotesingle{}Horas de sono\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as.data.frame}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 2
##   Horas.de.sono  Freq
##   <fct>         <int>
## 1 [0,2)             1
## 2 [2,4)             8
## 3 [4,6)             7
## 4 [6,8)             5
## 5 [8,10)           17
## 6 [10,12)          14
## # i 4 more rows
\end{verbatim}
\end{itemize}

\hypertarget{histograma}{%
\subsection{Histograma}\label{histograma}}

\begin{itemize}
\item
  Na verdade, o \texttt{ggplot2} já faz esses cálculos para nós.
\item
  O \emph{default} é criar $30$ classes (\emph{bins}):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/hist-sono1-1} \end{center}
\item
  \protect\hypertarget{histograma1}{}{} Vamos mudar isto passando um vetor de limites das classes (\emph{breaks}). Vamos acrescentar rótulos também:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Horas de sono de diversos mamíferos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{x =} \StringTok{\textquotesingle{}horas de sono\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}\NormalTok{,}
      \AttributeTok{caption =} \StringTok{\textquotesingle{}Fonte: dataset \textasciigrave{}msleep\textasciigrave{}\textquotesingle{}}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/hist-sono2-1} \end{center}
\item
  Nossas impressões:

  \begin{itemize}
  \item
    A classe que mais tem elementos é a de $8$ a $10$ horas.
  \item
    A distribuição é mais ou menos simétrica.
  \item
    A distribuição tem forma aproximada de sino: há poucos mamíferos com valores extremos de horas de sono; a maioria está próxima do valor médio:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(sono}\SpecialCharTok{$}\NormalTok{sleep\_total)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10,43373
\end{verbatim}
  \end{itemize}
\end{itemize}

\hypertarget{poluxedgono-de-frequuxeancia}{%
\subsection{Polígono de frequência}\label{poluxedgono-de-frequuxeancia}}

\begin{itemize}
\item
  Em vez das barras do histograma, podemos desenhar uma linha ligando seus topos.
\item
  O resultado é um {\hl{polígono de frequência}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pf }\OtherTok{\textless{}{-}}\NormalTok{ sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{))}

\NormalTok{pf}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/hist-freqpoly-1} \end{center}
\item
  Vamos sobrepor o polígono de frequência ao histograma, para deixar claro o que está acontecendo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pf }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/hist-freqpoly2-1} \end{center}
\end{itemize}

\hypertarget{ogiva}{%
\section{Ogiva}\label{ogiva}}

\begin{itemize}
\item
  A ogiva é um gráfico que mostra a {\hl{frequência acumulada}}: para cada valor $v$ da variável no eixo $x$, a proporção de indivíduos com valor menor ou igual a $v$.
\item
  A geometria \texttt{geom\_step} gera o gráfico de uma {\hl{função degrau}}.
\item
  Cada geometria está ligada a uma {\hl{{\mbox{\texttt{stat}}}}}, um algoritmo para computar o que vai ser desenhado. Aqui, passamos para a geometria {\hl{a função {\mbox{\texttt{ecdf}}} (\emph{empirical cumulative distribution function}), do pacote {\mbox{\texttt{stats}}}, que calcula as frequências acumuladas.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_step}\NormalTok{(}\AttributeTok{stat =} \StringTok{\textquotesingle{}ecdf\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/ogiva-1} \end{center}
\item
  Com a ogiva, podemos obter informações difíceis de visualizar no histograma. Por exemplo:

  \begin{itemize}
  \item
    Cerca de $20\%$ dos mamíferos têm menos de $6$ horas de sono.
  \item
    Cerca de metade dos mamíferos têm menos de $10$ horas de sono.
  \item
    Cerca de $10\%$ dos mamíferos têm mais de $16$ horas de sono.
  \end{itemize}
\end{itemize}

\hypertarget{ramos-e-folhas}{%
\section{Ramos e folhas}\label{ramos-e-folhas}}

\begin{itemize}
\item
  No início dos anos $1900$, quando estatísticas eram feitas à mão, Arthur Bowley criou os {\hl{diagramas de ramos e folhas}}.
\item
  Um diagrama de ramos e folhas é, basicamente, uma listagem de todos os valores de uma variável, agrupados de maneira que todos os valores de uma classe (i.e., de uma linha) têm os algarismos iniciais dentro de um intervalo.
\item
  Para as horas de sono dos mamíferos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono}\SpecialCharTok{$}\NormalTok{sleep\_total }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{stem}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##   The decimal point is at the |
## 
##    0 | 9
##    2 | 79013589
##    4 | 0423346
##    6 | 23307
##    8 | 03446779114456788
##   10 | 01113346900135
##   12 | 15555880578
##   14 | 234456996889
##   16 | 604
##   18 | 01479
\end{verbatim}
\item
  A primeira linha representa um indivíduo com $0{,}9$ horas de sono.
\item
  A penúltima linha representa $3$ valores:

  \begin{itemize}
  \tightlist
  \item
    $16{,}6$
  \item
    $17{,}0$
  \item
    $17{,}4$
  \end{itemize}
\end{itemize}

\hypertarget{personalizauxe7uxe3o-do-tema}{%
\section{Personalização do tema}\label{personalizauxe7uxe3o-do-tema}}

\begin{itemize}
\item
  O \texttt{ggplot2} tem um tema \emph{default}, chamado \texttt{theme\_gray}, que gera \protect\hyperlink{grafico4}{o \emph{scatterplot} de um exemplo anterior} deste capítulo do seguinte modo:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-179-1} \end{center}
\item
  Para este material, escolhi o tema \texttt{theme\_linedraw}, que usa linhas pretas sobre fundo branco:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-180-1} \end{center}
\item
  Para deixar os gráficos mais leves e facilitar a leitura, fiz as seguintes alterações no tema:

  \begin{itemize}
  \item
    Mudei o tamanho do texto dos rótulos.
  \item
    Fiz o rótulo do eixo $y$ aparecer na horizontal; embora isto ocupe um pouco mais de espaço, evita que o leitor tenha que girar a cabeça para ler o rótulo.
  \item
    Eliminei as linhas dos eixos, para o gráfico ficar mais leve.
  \item
    Eliminei a moldura da área de dados, para o gráfico ficar mais leve.
  \item
    Eliminei a grade secundária, para o gráfico ficar mais leve.
  \end{itemize}
\item
  O resultado é

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-181-1} \end{center}
\item
  Os meus comandos para alterar o tema são

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tamanho do texto depende do formato de saída (html ou pdf):}
\NormalTok{plot\_text\_size }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is\_html\_output}\NormalTok{(), }\DecValTok{12}\NormalTok{, }\DecValTok{13}\NormalTok{)}

\CommentTok{\# Tema mais leve:}
\FunctionTok{theme\_set}\NormalTok{(}
  \FunctionTok{theme\_linedraw}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}
      \CommentTok{\# Tamanho do texto}
      \AttributeTok{text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =}\NormalTok{ plot\_text\_size),}
      \CommentTok{\# Eixo y}
      \AttributeTok{axis.title.y.left =} \FunctionTok{element\_text}\NormalTok{(}
        \CommentTok{\# Nunca girar o rótulo do eixo y}
        \AttributeTok{angle =} \DecValTok{0}\NormalTok{,}
        \CommentTok{\# Separar o rótulo do eixo um pouco}
        \AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{r =} \DecValTok{20}\NormalTok{),}
        \CommentTok{\# Posicionar verticalmente no meio}
        \AttributeTok{vjust =}\NormalTok{ .}\DecValTok{5}
\NormalTok{      ),}
      \CommentTok{\# Eixo y secundário (à direita), quando presente}
      \AttributeTok{axis.title.y.right =} \FunctionTok{element\_text}\NormalTok{(}
        \CommentTok{\# Nunca girar o rótulo do eixo y}
        \AttributeTok{angle =} \DecValTok{0}\NormalTok{,}
        \CommentTok{\# Separar o rótulo do eixo um pouco}
        \AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{l =} \DecValTok{20}\NormalTok{),}
        \CommentTok{\# Posicionar verticalmente no meio}
        \AttributeTok{vjust =}\NormalTok{ .}\DecValTok{5}
\NormalTok{      ),}
      \CommentTok{\# Não colocar marcas no eixo y secundário}
      \AttributeTok{axis.ticks.y.right =} \FunctionTok{element\_blank}\NormalTok{(),}
      \CommentTok{\# Separar o eixo x do rótulo um pouco mais}
      \AttributeTok{axis.title.x.bottom =} \FunctionTok{element\_text}\NormalTok{(}
        \AttributeTok{margin =} \FunctionTok{margin}\NormalTok{(}\AttributeTok{t =} \DecValTok{20}\NormalTok{)}
\NormalTok{      ),}
      \CommentTok{\# Eliminar linhas dos eixos}
      \AttributeTok{axis.line =} \FunctionTok{element\_blank}\NormalTok{(),}
      \CommentTok{\# Eliminar a moldura da área de dados}
      \AttributeTok{panel.border =} \FunctionTok{element\_blank}\NormalTok{(),}
      \CommentTok{\# Eliminar a grade secundária}
      \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{()}
\NormalTok{    )}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{exercuxedcios-5}{%
\section{Exercícios}\label{exercuxedcios-5}}

\begin{rmdimportant}
Não se esqueça de incluir títulos nos gráficos e rótulos nos eixos.

\end{rmdimportant}

\hypertarget{peso-cerebral-e-peso-corporal}{%
\subsection{Peso cerebral e peso corporal}\label{peso-cerebral-e-peso-corporal}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Observe os \protect\hyperlink{grafico4}{comandos que geraram o gráfico \texttt{grafico4}}.
\item
  O que acontece se você retirar \texttt{aes(group\ =\ 1)} da chamada a \texttt{geom\_smooth}? Explique.
\item
  O que acontece se você mudar \texttt{show.legend\ =\ FALSE} para \texttt{show.legend\ =\ TRUE} na chamada a \texttt{geom\_smooth}? Explique.
\item
  O que acontece se você mudar \texttt{se\ =\ FALSE} para \texttt{se\ =\ TRUE} na chamada a \texttt{geom\_smooth}? Explique.
\item
  Acrescente ao gráfico a camada \texttt{facet\_wrap(\textasciitilde{}vore)}. O que acontece?
\item
  Examine o \emph{data frame} \texttt{sono} e identifique o único insetívoro com mais de $4$kg.
\item
  Instale o pacote \texttt{gg\_repel} e acrescente ao gráfico \texttt{grafico4} (não facetado) a geometria \texttt{geom\_label\_repel} (consulte a ajuda) para rotular o mamífero insetívoro identificado no item anterior com o seu nome, {\hl{sem cobrir outros pontos do gráfico}}. Cuidado para não alterar a legenda que já existe.
\end{enumerate}

\hypertarget{peso-cerebral-e-horas-de-sono}{%
\subsection{Peso cerebral e horas de sono}\label{peso-cerebral-e-horas-de-sono}}

\begin{rmdbox}

Use o \emph{data frame} \texttt{sono} definido como

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}

\NormalTok{sono }\OtherTok{\textless{}{-}}\NormalTok{ msleep }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}
\NormalTok{    name, order, genus, vore, bodywt, }
\NormalTok{    brainwt, awake, sleep\_total}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\end{rmdbox}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Construa um histograma da variável \texttt{brainwt}. Escolha o número de classes que você achar melhor. O que acontece com os valores \texttt{NA}?
\item
  \href{http://sillasgonzaga.com/material/curso_visualizacao/ggplot2-parte-ii.html\#customizando-escalas}{Descubra que função da forma \texttt{scale\_x\_...} usar} para fazer com que o eixo $x$ tenha uma escala logarítmica. Gere um novo histograma.
\item
  Qual dos dois histogramas é melhor para responder a pergunta ``\emph{Qual a faixa de peso cerebral que tem mais animais?}'' de forma satisfatória?
\item
  Construa um \emph{scatter plot} de horas de sono versus peso do cérebro. Você percebe alguma correlação entre estas variáveis? Se precisar, concentre-se em um subconjunto dos dados.
\item
  Usando \texttt{geom\_smooth} (\href{https://cdr.ibpad.com.br/ggplot2.html\#objetos-geom\%C3\%A9tricos-e-tipos-de-gr\%C3\%A1ficos}{leia a respeito}), sobreponha uma reta de regressão ao gráfico de dispersão, usando o método \texttt{lm} e sem o erro padrão (i.e., com \texttt{se\ =\ FALSE}). O que você observa? Discuta.
\end{enumerate}

\hypertarget{igualdade-de-guxeanero-entre-furacuxf5es}{%
\subsection{Igualdade de gênero entre furacões?}\label{igualdade-de-guxeanero-entre-furacuxf5es}}

\href{https://www.pnas.org/content/111/24/8782}{Este artigo} tenta achar uma relação entre o gênero do nome de um furacão e a quantidade de vítimas fatais provocadas por ele.

\begin{rmdbox}

Os dados estão no pacote \texttt{DAAG}, que deve ser instalado:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(DAAG))}
  \FunctionTok{install.packages}\NormalTok{(}\StringTok{"DAAG"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Vamos usar apenas algumas das variáveis, com nomes em português.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ hurricNamed }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{transmute}\NormalTok{(}
    \AttributeTok{id =} \FunctionTok{paste}\NormalTok{(Year, Name, }\AttributeTok{sep =} \StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{),}
    \AttributeTok{nome =}\NormalTok{ Name,}
    \AttributeTok{ano =}\NormalTok{ Year,}
    \AttributeTok{velocidade =}\NormalTok{ LF.WindsMPH }\SpecialCharTok{*} \FloatTok{1.8}\NormalTok{,     }\CommentTok{\# convertido para km/h}
    \AttributeTok{pressao =}\NormalTok{ LF.PressureMB,            }\CommentTok{\# mbar}
    \AttributeTok{prejuizo =}\NormalTok{ BaseDam2014 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{round}\NormalTok{(), }\CommentTok{\# milhões de dólares de 2014}
    \AttributeTok{mortes =}\NormalTok{ deaths,}
    \AttributeTok{genero =}\NormalTok{ mf}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\end{rmdbox}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Crie histogramas para as seguintes variáveis, escolhendo a quantidade de barras que você achar melhor.

  \begin{itemize}
  \item
    \texttt{velocidade}
  \item
    \texttt{prejuizo}
  \item
    \texttt{mortes}
  \end{itemize}

  Não se esqueça de incluir títulos nos gráficos e rótulos nos eixos.

  Comente os histogramas.
\item
  Os histogramas de prejuízos e mortes não ficaram bons. Vamos gerar histogramas transformados.

  No \emph{data frame}, crie duas novas colunas:

  \begin{itemize}
  \item
    \texttt{logprejuizo}: \emph{logaritmo} do prejuízo (na base $10$)
  \item
    \texttt{logmortes}: \emph{logaritmo} do número de mortes (na base $10$)
  \end{itemize}

  Agora, gere histogramas destas duas novas variáveis.
\item
  O que significa o valor do logaritmo do prejuízo na base $10$?
\item
  O que significa o valor do logaritmo do número de mortes na base $10$?
\item
  Por que o histograma do logaritmo do número de mortes vem com uma mensagem de aviso?
\item
  Por que isto não acontece com o logaritmo do prejuízo?
\item
  Faça um gráfico de dispersão com \texttt{pressao} no eixo $y$ e \texttt{velocidade} no eixo $x$.
\item
  Usando \texttt{geom\_smooth} (\href{https://cdr.ibpad.com.br/ggplot2.html\#objetos-geom\%C3\%A9tricos-e-tipos-de-gr\%C3\%A1ficos}{leia a respeito}), sobreponha uma reta de regressão ao gráfico, usando o método \texttt{lm} e sem o erro padrão (i.e., com \texttt{se\ =\ FALSE}). O que você observa? Discuta.
\item
  Faça um gráfico de dispersão com \texttt{logmortes} no eixo $y$ e \texttt{pressao} no eixo $x$.
\item
  Usando \texttt{geom\_smooth} (\href{https://cdr.ibpad.com.br/ggplot2.html\#objetos-geom\%C3\%A9tricos-e-tipos-de-gr\%C3\%A1ficos}{leia a respeito}), sobreponha uma reta de regressão ao gráfico, usando o método \texttt{lm} e sem o erro padrão (i.e., com \texttt{se\ =\ FALSE}). O que você observa? Discuta.
\item
  Faça um gráfico de dispersão com \texttt{logmortes} no eixo $y$ e \texttt{pressao} no eixo $x$, com pontos coloridos de acordo com o gênero do nome do furacão.
\item
  Usando \texttt{geom\_smooth} (\href{https://cdr.ibpad.com.br/ggplot2.html\#objetos-geom\%C3\%A9tricos-e-tipos-de-gr\%C3\%A1ficos}{leia a respeito}), sobreponha retas de regressão ao gráfico, uma para cada gênero, usando o método \texttt{lm} e sem o erro padrão (i.e., com \texttt{se\ =\ FALSE}). O que você observa? Discuta.
\end{enumerate}

\begin{rmdcaution}
Visualizações como esta ajudam a explorar os dados, mas não servem para testar rigorosamente a hipótese de que furacões mulheres matam mais do que furacões homens.

Mais adiante no curso, vamos aprender a fazer testes mais rigorosos sobre hipóteses como esta.

\end{rmdcaution}

\hypertarget{viz2}{%
\chapter{Visualização com ggplot2 (continuação)}\label{viz2}}

\begin{rmdtip}
Busque mais informações sobre os pacotes \texttt{tidyverse} e \texttt{ggplot2} \protect\hyperlink{refrec}{nas referências recomendadas}.

\end{rmdtip}

\hypertarget{vuxeddeo-1-3}{%
\section{Vídeo 1}\label{vuxeddeo-1-3}}

\begin{center} \url{https://youtu.be/TjgLDeIQHIc} \end{center}

\hypertarget{boxplots}{%
\section{\texorpdfstring{\emph{Boxplots}}{Boxplots}}\label{boxplots}}

\hypertarget{conjunto-de-dados}{%
\subsection{Conjunto de dados}\label{conjunto-de-dados}}

\begin{itemize}
\item
  Vamos continuar a trabalhar com os dados sobre as horas de sono de alguns mamíferos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\OtherTok{\textless{}{-}}\NormalTok{ msleep }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(name, vore, order, sleep\_total)}

\NormalTok{sono}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 83 x 4
##   name                       vore  order        sleep_total
##   <chr>                      <chr> <chr>              <dbl>
## 1 Cheetah                    carni Carnivora           12.1
## 2 Owl monkey                 omni  Primates            17  
## 3 Mountain beaver            herbi Rodentia            14.4
## 4 Greater short-tailed shrew omni  Soricomorpha        14.9
## 5 Cow                        herbi Artiodactyla         4  
## 6 Three-toed sloth           herbi Pilosa              14.4
## # i 77 more rows
\end{verbatim}
\end{itemize}

\hypertarget{mediana}{%
\subsection{Mediana e quartis}\label{mediana}}

\begin{itemize}
\item
  Para entender \emph{boxplots}, precisamos, antes, entender algumas medidas.
\item
  Se tomarmos as quantidades de horas de sono de todos os animais do conjunto de dados e {\hl{classificarmos estas quantidades em ordem crescente}}, vamos ter:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas }\OtherTok{\textless{}{-}}\NormalTok{ sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(sleep\_total) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sort}\NormalTok{()}

\NormalTok{horas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1,9  2,7  2,9  3,0  3,1  3,3  3,5  3,8  3,9  4,0  4,4  5,2  5,3
## [14]  5,3  5,4  5,6  6,2  6,3  6,3  7,0  7,7  8,0  8,3  8,4  8,4  8,6
## [27]  8,7  8,7  8,9  9,1  9,1  9,4  9,4  9,5  9,6  9,7  9,8  9,8 10,0
## [40] 10,1 10,1 10,1 10,3 10,3 10,4 10,6 10,9 11,0 11,0 11,1 11,3 11,5
## [53] 12,1 12,5 12,5 12,5 12,5 12,8 12,8 13,0 13,5 13,7 13,8 14,2 14,3
## [66] 14,4 14,4 14,5 14,6 14,9 14,9 15,6 15,8 15,8 15,9 16,6 17,0 17,4
## [79] 18,0 18,1 19,4 19,7 19,9
\end{verbatim}
\item
  Quantos valores são?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(horas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 83
\end{verbatim}
\item
  O valor que está {\hl{bem no meio desta fila}} --- i.e., na posição $42$ --- é a {\hl{mediana}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas[}\FunctionTok{ceiling}\NormalTok{(}\FunctionTok{length}\NormalTok{(horas) }\SpecialCharTok{/} \DecValTok{2}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10,1
\end{verbatim}
\item
  Em R:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(horas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10,1
\end{verbatim}

  \begin{rmdcaution}
  Mediana e média são coisas muito diferentes.

  Por acaso, neste exemplo, a média das horas é próxima da mediana:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(horas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10,43373
\end{verbatim}

  Isto costuma acontecer quando a distribuição dos dados é aproximadamente simétrica.

  \end{rmdcaution}
\item
  Os {\hl{quartis}} são os valores que estão nas posições $\frac14$, $\frac12$ e $\frac34$ da fila. São o {\hl{primeiro, segundo e terceiro quartis}}, respectivamente.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas[}
  \FunctionTok{c}\NormalTok{(}
    \FunctionTok{ceiling}\NormalTok{(}\FunctionTok{length}\NormalTok{(horas) }\SpecialCharTok{/} \DecValTok{4}\NormalTok{),}
    \FunctionTok{ceiling}\NormalTok{(}\FunctionTok{length}\NormalTok{(horas) }\SpecialCharTok{/} \DecValTok{2}\NormalTok{),}
    \FunctionTok{ceiling}\NormalTok{(}\DecValTok{3} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(horas) }\SpecialCharTok{/} \DecValTok{4}\NormalTok{)}
\NormalTok{  )}
\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  7,7 10,1 13,8
\end{verbatim}
\item
  {\hl{Sim, a mediana é o segundo quartil.}}
\item
  Em R, a {\hl{função {\mbox{\texttt{quantile}}}}} generaliza esta idéia: dado um número $q$ entre $0$ e $1$, {\hl{o quantil (com ``N'') $q$ é o elemento que está na posição que corresponde à fração $q$ da fila ordenada.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{quantile}\NormalTok{(}\FunctionTok{c}\NormalTok{(.}\DecValTok{25}\NormalTok{, .}\DecValTok{5}\NormalTok{, .}\DecValTok{75}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   25%   50%   75% 
##  7,85 10,10 13,75
\end{verbatim}
\item
  Na verdade, R tem $9$ algoritmos diferentes para calcular os quantis de uma amostra! Leia a ajuda da função \texttt{quantile} para conhecê-los.
\item
  As diferenças entre nossos cálculos ``à mão'' e os resultados retornados por \texttt{quantile} são porque, em algumas situações, \texttt{quantile} calcula uma média ponderada entre elementos vizinhos. Por isso, \texttt{quantile} pode retornar valores que nem estão no vetor.
\item
  Em R, a {\hl{função {\mbox{\texttt{summary}}}}} mostra o {\hl{mínimo}}, os {\hl{quartis (com ``R'')}}, a {\hl{média}}, e o {\hl{máximo}} de um vetor:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(horas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1,90    7,85   10,10   10,43   13,75   19,90
\end{verbatim}
\end{itemize}

\hypertarget{muxe9dia-times-mediana}{%
\subsection{\texorpdfstring{Média $\times$ mediana}{Média  mediana}}\label{muxe9dia-times-mediana}}

\begin{itemize}
\item
  Vamos ver um exemplo simples para entender a diferença entre a média e a mediana.
\item
  Imagine o seguinte vetor com as receitas mensais de algumas pessoas (em milhares de reais:)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{receitas }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Eis a mediana e a média deste vetor:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(receitas)[}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Median\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Mean\textquotesingle{}}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Median     Mean 
## 2,000000 2,071429
\end{verbatim}
\item
  A mediana e a média são bem próximas.
\item
  Imagine, agora, que adicionamos ao vetor um sujeito com receita mensal de $100$ mil reais:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{receitas }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Eis a nova mediana e a nova média:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(receitas)[}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Median\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Mean\textquotesingle{}}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  Median    Mean 
##  2,0000 14,3125
\end{verbatim}
\item
  O sujeito com a receita de $2$ mil reais continua no meio da fila, mas a média (que é a soma de todas as receitas, dividida pelo número de indivíduos) ficou muito diferente.
\item
  A receita do novo sujeito é um {\hl{valor discrepante}}, ou, em inglês, um {\hl{\emph{outlier}}}.
\end{itemize}

\begin{rmdimportant}
\textbf{Conclusão:}

A {\hl{mediana é robusta}}, pouco afetada por \emph{outliers}.

A {\hl{média é pouco robusta}}, muito sensível a \emph{outliers}.

\end{rmdimportant}

\hypertarget{intervalo-interquartil-iqr-e-outliers}{%
\subsection{\texorpdfstring{Intervalo interquartil (IQR) e \emph{outliers}}{Intervalo interquartil (IQR) e outliers}}\label{intervalo-interquartil-iqr-e-outliers}}

\begin{itemize}
\item
  Qual fração dos elementos está {\hl{entre o primeiro e o terceiro quartis?}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}
\NormalTok{  horas[}\FunctionTok{between}\NormalTok{(horas, }\FunctionTok{quantile}\NormalTok{(horas, .}\DecValTok{25}\NormalTok{), }\FunctionTok{quantile}\NormalTok{(horas, .}\DecValTok{75}\NormalTok{))]}
\NormalTok{) }\SpecialCharTok{/}
\FunctionTok{length}\NormalTok{(}
\NormalTok{  horas}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,4939759
\end{verbatim}
\item
  {\hl{Metade}} do total de elementos está entre o primeiro e o terceiro quartis.
\item
  Este é o chamado {\hl{intervalo interquartil}} (\emph{interquartile range}, em inglês).
\item
  No nosso vetor \texttt{horas}, os {\hl{limites do IQR}} são

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(horas, }\FunctionTok{c}\NormalTok{(.}\DecValTok{25}\NormalTok{, .}\DecValTok{75}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   25%   75% 
##  7,85 13,75
\end{verbatim}
\item
  O {\hl{comprimento}} deste intervalo é calculado pela função \texttt{IQR}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{(horas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5,9
\end{verbatim}
\item
  Valores {\hl{muito abaixo do primeiro quartil}} podem ser considerados discrepantes (\emph{outliers}), mas quão abaixo?
\item
  A resposta (puramente convencional) é {\hl{$1{,}5 \times \text{IQR}$ abaixo do primeiro quartil.}}
\item
  No nosso vetor \texttt{horas}, isto significa valores abaixo de

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{limite\_inferior }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(horas, .}\DecValTok{25}\NormalTok{) }\SpecialCharTok{{-}} \FloatTok{1.5} \SpecialCharTok{*} \FunctionTok{IQR}\NormalTok{(horas)}

\FunctionTok{unname}\NormalTok{(limite\_inferior)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -1
\end{verbatim}
\item
  Neste caso, não há \emph{outliers}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas[horas }\SpecialCharTok{\textless{}}\NormalTok{ limite\_inferior]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## numeric(0)
\end{verbatim}
\item
  Da mesma forma, valores {\hl{muito acima do terceiro quartil}} podem ser considerados discrepantes (\emph{outliers}), mas quão acima?
\item
  De novo, a resposta (puramente convencional) é {\hl{$1{,}5 \times \text{IQR}$ acima do terceiro quartil.}}
\item
  No nosso vetor \texttt{horas}, isto significa valores acima de

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{limite\_superior }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(horas, .}\DecValTok{75}\NormalTok{) }\SpecialCharTok{+} \FloatTok{1.5} \SpecialCharTok{*} \FunctionTok{IQR}\NormalTok{(horas)}

\FunctionTok{unname}\NormalTok{(limite\_superior)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 22,6
\end{verbatim}
\item
  Neste caso, também não há \emph{outliers}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas[horas }\SpecialCharTok{\textgreater{}}\NormalTok{ limite\_superior]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## numeric(0)
\end{verbatim}
\item
  Outro exemplo: vamos tomar apenas os mamíferos onívoros:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{onivoros }\OtherTok{\textless{}{-}}\NormalTok{ sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(vore }\SpecialCharTok{==} \StringTok{\textquotesingle{}omni\textquotesingle{}}\NormalTok{)}

\NormalTok{onivoros}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 20 x 4
##   name                       vore  order        sleep_total
##   <chr>                      <chr> <chr>              <dbl>
## 1 Owl monkey                 omni  Primates            17  
## 2 Greater short-tailed shrew omni  Soricomorpha        14.9
## 3 Grivet                     omni  Primates            10  
## 4 Star-nosed mole            omni  Soricomorpha        10.3
## 5 African giant pouched rat  omni  Rodentia             8.3
## 6 Lesser short-tailed shrew  omni  Soricomorpha         9.1
## # i 14 more rows
\end{verbatim}
\item
  Vamos extrair o vetor de horas de sono:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horas }\OtherTok{\textless{}{-}}\NormalTok{ onivoros }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(sleep\_total)}

\NormalTok{horas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 17,0 14,9 10,0 10,3  8,3  9,1 18,0 10,1 10,9  9,8  8,0 10,1  9,7
## [14]  9,4 11,0  8,7  9,6  9,1 15,6  8,9
\end{verbatim}
\item
  Vamos calcular o primeiro e terceiro quartis:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quartis }\OtherTok{\textless{}{-}}\NormalTok{ horas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{quantile}\NormalTok{(}\FunctionTok{c}\NormalTok{(.}\DecValTok{25}\NormalTok{, .}\DecValTok{75}\NormalTok{))}

\NormalTok{quartis}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    25%    75% 
##  9,100 10,925
\end{verbatim}
\item
  Vamos achar o IQR:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{(horas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1,825
\end{verbatim}
\item
  E os limites a partir dos quais os valores são \emph{outliers}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{limites }\OtherTok{\textless{}{-}}\NormalTok{ quartis }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FloatTok{1.5} \SpecialCharTok{*} \FunctionTok{IQR}\NormalTok{(horas)}

\FunctionTok{unname}\NormalTok{(limites)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  6,3625 13,6625
\end{verbatim}
\item
  Existem \emph{outliers} inferiores?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{onivoros }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(sleep\_total }\SpecialCharTok{\textless{}}\NormalTok{ limites[}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 0 x 4
## # i 4 variables: name <chr>, vore <chr>, order <chr>,
## #   sleep_total <dbl>
\end{verbatim}

  Não.
\item
  Existem \emph{outliers} superiores?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{onivoros }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(sleep\_total }\SpecialCharTok{\textgreater{}}\NormalTok{ limites[}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 4
##   name                       vore  order           sleep_total
##   <chr>                      <chr> <chr>                 <dbl>
## 1 Owl monkey                 omni  Primates               17  
## 2 Greater short-tailed shrew omni  Soricomorpha           14.9
## 3 North American Opossum     omni  Didelphimorphia        18  
## 4 Tenrec                     omni  Afrosoricida           15.6
\end{verbatim}

  Sim! Estes animais dormem demais em comparação com os outros onívoros.
\end{itemize}

\hypertarget{gerando-boxplots}{%
\subsection{Gerando boxplots}\label{gerando-boxplots}}

\begin{itemize}
\item
  {\hl{Um \emph{boxplot} é uma representação visual dos valores que calculamos acima.}}
\item
  No \texttt{ggplot2}, {\hl{a geometria {\mbox{\texttt{geom\_boxplot}}} constrói \emph{boxplots}:}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill =} \StringTok{\textquotesingle{}gray\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-215-1} \end{center}
\item
  A {\hl{caixa}} vai do valor do {\hl{primeiro quartil}} (embaixo) até o {\hl{terceiro quartil}} (em cima).
\item
  A {\hl{linha horizontal dentro da caixa}} representa o valor da {\hl{mediana}}.
\item
  As {\hl{linhas verticais}} acima e abaixo da caixa (pitorescamente chamadas de ``bigodes'') vão até o {\hl{limite inferior}} (primeiro quartil ${}- 1{,}5 \times \text{IQR}$) e até o {\hl{limite superior}} (terceiro quartil ${}+ 1{,}5 \times \text{IQR}$).
\item
  Neste \emph{boxplot}, não há \emph{outliers}.
\item
  \protect\hypertarget{onivoros}{}{} Podemos usar a posição $x$ para desenhar vários \emph{boxplots}, um para cada dieta:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ vore, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill =} \StringTok{\textquotesingle{}gray\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-216-1} \end{center}
\item
  No \emph{boxplot} de onívoros, {\hl{os \emph{outliers} aparecem como pontos isolados,}} acima da caixa, além dos alcances do bigode superior (aliás, onde está bigode superior?).
\item
  \emph{Boxplots} lado a lado são úteis para compararmos grupos diferentes de dados.
\item
  Veja como, com exceção dos insetívoros, as medianas dos grupos são parecidas.
\item
  Veja como carnívoros, insetívoros e herbívoros apresentam maior variação, enquanto onívoros e animais sem dieta registrada apresentam menor variação.
\item
  Vamos combinar, em um só gráfico

  \begin{itemize}
  \item
    Os pontos representando os animais,
  \item
    Os \emph{boxplots},
  \item
    As médias (que podem estar próximas ou distantes das medianas).
  \end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sono }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ vore, }\AttributeTok{y =}\NormalTok{ sleep\_total)) }\SpecialCharTok{+}
    \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill =} \StringTok{\textquotesingle{}gray\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}
      \AttributeTok{color =} \StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }
      \AttributeTok{alpha =}\NormalTok{ .}\DecValTok{3}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{stat\_summary}\NormalTok{(}
      \AttributeTok{fun =}\NormalTok{ mean, }
      \AttributeTok{geom =} \StringTok{\textquotesingle{}point\textquotesingle{}}\NormalTok{, }
      \AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, }
      \AttributeTok{shape =} \StringTok{\textquotesingle{}cross\textquotesingle{}}\NormalTok{, }
      \AttributeTok{size =} \DecValTok{5}\NormalTok{,}
      \AttributeTok{stroke =} \DecValTok{1}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Sono total de diversos mamíferos, por dieta\textquotesingle{}}\NormalTok{,}
      \AttributeTok{subtitle =} \StringTok{\textquotesingle{}(o X vermelho representa a média)\textquotesingle{}}\NormalTok{,}
      \AttributeTok{x =} \StringTok{\textquotesingle{}dieta\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \StringTok{\textquotesingle{}sono total}\SpecialCharTok{\textbackslash{}n}\StringTok{(em horas)\textquotesingle{}}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-217-1} \end{center}
\item
  {\hl{Quando a caixa é longa,}} o IQR é grande, e {\hl{os valores estão muito espalhados;}} é o caso dos herbívoros e insetívoros.
\item
  {\hl{Quando a caixa é curta,}} o IQR é pequeno, e {\hl{os valores estão pouco espalhados}}; é o caso dos onívoros. Como o IQR é pequeno, os $4$ mamíferos com mais de $14$ horas de sono são \emph{outliers}.
\item
  Observe, ainda, como os \emph{outliers} ``puxam'' a média dos onívoros para cima.
\end{itemize}

\hypertarget{vuxeddeo-2-2}{%
\section{Vídeo 2}\label{vuxeddeo-2-2}}

\begin{center} \url{https://youtu.be/QqnOvgBXJ-s} \end{center}

\hypertarget{gruxe1ficos-de-barras-e-de-colunas}{%
\section{Gráficos de barras e de colunas}\label{gruxe1ficos-de-barras-e-de-colunas}}

\hypertarget{conjunto-de-dados-1}{%
\subsection{Conjunto de dados}\label{conjunto-de-dados-1}}

\begin{itemize}
\item
  O R tem um \emph{array} de $3$ dimensões com dados sobre as cores dos cabelos e dos olhos de $592$ alunos e alunas de uma universidade americana em $1974$.
\item
  Se pedirmos para o R exibir os dados, veremos {\hl{duas matrizes}}, uma para cada sexo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{HairEyeColor}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## , , Sex = Male
## 
##        Eye
## Hair    Brown Blue Hazel Green
##   Black    32   11    10     3
##   Brown    53   50    25    15
##   Red      10   10     7     7
##   Blond     3   30     5     8
## 
## , , Sex = Female
## 
##        Eye
## Hair    Brown Blue Hazel Green
##   Black    36    9     5     2
##   Brown    66   34    29    14
##   Red      16    7     7     7
##   Blond     4   64     5     8
\end{verbatim}
\item
  Vamos transformar este \emph{array} em um \emph{data frame}.
\item
  O \emph{array} contém apenas os totais de cada classe. Vamos usar a função \texttt{uncount} para gerar uma linha para cada aluno:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_orig }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(HairEyeColor) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{uncount}\NormalTok{(Freq) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{()}

\NormalTok{df\_orig}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 592 x 3
##   Hair  Eye   Sex  
##   <fct> <fct> <fct>
## 1 Black Brown Male 
## 2 Black Brown Male 
## 3 Black Brown Male 
## 4 Black Brown Male 
## 5 Black Brown Male 
## 6 Black Brown Male 
## # i 586 more rows
\end{verbatim}
\item
  O \texttt{ggplot2} e os outros pacotes do \texttt{tidyverse} foram projetados para trabalhar com \emph{data frames} neste formato, {\hl{com uma observação (um indivíduo, um elemento) por linha.}} É o chamado {\hl{formato \emph{tidy}.}}
\item
  Usando vetores com elementos nomeados, podemos traduzir o conteúdo do \emph{data frame} para português:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cabelo }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}Brown\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}castanhos\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Blond\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}louros\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Black\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}pretos\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Red\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}ruivos\textquotesingle{}}
\NormalTok{)}

\NormalTok{olhos }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}Brown\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}castanhos\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Blue\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}azuis\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Hazel\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}avelã\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Green\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}verdes\textquotesingle{}}
\NormalTok{)}

\NormalTok{sexo }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}Male\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}homem\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}Female\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}mulher\textquotesingle{}}
\NormalTok{)}

\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df\_orig }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{transmute}\NormalTok{(}
    \AttributeTok{cabelos =}\NormalTok{ cabelo[Hair],}
    \AttributeTok{olhos =}\NormalTok{ olhos[Eye],}
    \AttributeTok{sexo =}\NormalTok{ sexo[Sex]}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}
\item
  Um sumário:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{dfSummary}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{print}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{longtable}[]{@{}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1918}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.3425}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.3151}}
    >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1507}}@{}}
  \toprule()
  \begin{minipage}[b]{\linewidth}\raggedright
  Variável
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Estatísticas / Valores
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Freqs (\% de Válidos)
  \end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
  Faltante
  \end{minipage} \\
  \midrule()
  \endhead
  \begin{minipage}[t]{\linewidth}\raggedright
  cabelos\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. castanhos\\
  2. louros\\
  3. pretos\\
  4. ruivos\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  108 (18,2\%)\\
  286 (48,3\%)\\
  71 (12,0\%)\\
  127 (21,5\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  olhos\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. avelã\\
  2. azuis\\
  3. castanhos\\
  4. verdes\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  93 (15,7\%)\\
  215 (36,3\%)\\
  220 (37,2\%)\\
  64 (10,8\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \begin{minipage}[t]{\linewidth}\raggedright
  sexo\\
  {[}character{]}\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  1. homem\\
  2. mulher\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  279 (47,1\%)\\
  313 (52,9\%)\strut
  \end{minipage} & \begin{minipage}[t]{\linewidth}\raggedright
  0\\
  (0,0\%)\strut
  \end{minipage} \\
  \bottomrule()
  \end{longtable}
\end{itemize}

\hypertarget{gerando-gruxe1ficos-de-barras}{%
\subsection{Gerando gráficos de barras}\label{gerando-gruxe1ficos-de-barras}}

\begin{itemize}
\item
  Um {\hl{gráfico de barras}} contém uma barra para cada valor de uma {\hl{variável categórica.}}
\item
  {\hl{Usamos {\mbox{\texttt{geom\_bar}}} para gerar um gráfico de barras}} de cores de cabelo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cabelos)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-223-1} \end{center}

  \begin{rmdimportant}

  \textbf{Gráfico de barras $\times$ histograma:}

  \begin{itemize}
  \item
    {\hl{Os dois tipos de gráficos mostram a frequência}} (quantidade de elementos) {\hl{no eixo vertical}}.
  \item
    No {\hl{gráfico de barras}}:

    \begin{itemize}
    \item
      A variável é {\hl{categórica}} (nominal).
    \item
      {\hl{Cada barra}} corresponde a {\hl{um valor}} da variável.
    \item
      {\hl{As barras não se tocam}}, enfatizando o fato de que a variável é categórica.
    \end{itemize}
  \item
    No {\hl{histograma}} (\protect\hyperlink{histograma1}{veja o exemplo}):

    \begin{itemize}
    \item
      A variável é {\hl{quantitativa}} (intervalar ou racional).
    \item
      {\hl{Cada barra}} corresponde a {\hl{uma classe de valores}} da variável.
    \item
      {\hl{As barras se tocam}}, para enfatizar que as classes são contíguas.
    \end{itemize}
  \end{itemize}

  \end{rmdimportant}
\item
  Um gráfico de barras é mais legível quando as barras são mostradas em ordem crescente ou decrescente.
\item
  Embora os valores da variável \texttt{cabelos} sejam \emph{strings}, podemos aplicar a eles funções que manipulam fatores.
\item
  A {\hl{função {\mbox{\texttt{fct\_infreq}}}}}, do pacote \texttt{forcats}, ordena os valores em {\hl{ordem decrescente de frequência}}.
\item
  A {\hl{função {\mbox{\texttt{fct\_rev}}}}}, também do pacote \texttt{forcats}, {\hl{inverte a ordenação.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)))) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-224-1} \end{center}
\item
  A posição $x$ e a altura de cada barra são estéticas: {\hl{a posição $x$ representa a cor dos cabelos}}, e {\hl{a altura representa a frequência daquela cor}}.
\item
  Vamos acrescentar mais uma estética: {\hl{a cor de preenchimento vai representar o sexo}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ sexo)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-225-1} \end{center}
\item
  Se a cor dos homens incomoda você, altere a escala que especifica o preenchimento (\texttt{scale\_fill\_discrete}):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ sexo)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-226-1} \end{center}
\item
  {\hl{Podemos fazer um gráfico de barras horizontais com {\mbox{\texttt{coord\_flip}}}.}} Isto geralmente é útil quando os rótulos das barras são longos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ sexo)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-227-1} \end{center}
\item
  Você consegue dizer se há mais homens ou mulheres com cabelos pretos? E castanhos? E ruivos?
\item
  Se posicionarmos as barras lado a lado, fica mais fácil responder.
\item
  Usamos o argumento \texttt{position\ =\ \textquotesingle{}dodge\textquotesingle{}} de \texttt{geom\_bar}. ``\emph{Dodge}'' significa ``esquivar-se'', em inglês.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ sexo)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{\textquotesingle{}dodge\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-228-1} \end{center}
\item
  Agora vamos examinar a relação entre as cores dos olhos e as cores dos cabelos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ olhos)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}
      \AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}\#908050\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}brown\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{)}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-229-1} \end{center}
\item
  Ou, com barras lado a lado:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ olhos)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{\textquotesingle{}dodge\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}
      \AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}\#908050\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}brown\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{)}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-230-1} \end{center}
\item
  Observações e perguntas:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Há mais pessoas louras de olhos castanhos do que louras de olhos azuis. O esperado não seria mais pessoas louras de olhos azuis? Pessoas louras de olhos castanhos pintaram os cabelos?
  \item
    Há muito mais ruivos de olhos azuis do que ruivos de olhos verdes. Não deveria ser o contrário? Também são pessoas que pintaram os cabelos de ruivo? Ou houve erro no registro das cores dos olhos?
  \end{enumerate}
\item
  Para incluir o sexo, podemos {\hl{facetar}} o gráfico. Usando \texttt{facet\_wrap}\footnote{O nome da variável segundo a qual facetar deve aparecer depois de um \texttt{\textasciitilde{}}.}, geramos dois subgráficos lado a lado:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(cabelos)), }\AttributeTok{fill =}\NormalTok{ olhos)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{\textquotesingle{}dodge\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}\#908050\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}brown\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{sexo) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Cores de cabelos e olhos por sexo\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}\NormalTok{,}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-231-1} \end{center}
\end{itemize}

\begin{itemize}
\item
  Se a quantidade grande de pessoas louras de olhos castanhos (em comparação com pessoas louras de olhos azuis) for por causa da pintura de cabelos, então o gráfico acima mostra que as mulheres pintam os cabelos de louro com mais frequência do que os homens.
\item
  Quando facetamos por cor de cabelos, também podemos observar as mesmas diferenças entre homens e mulheres:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sexo, }\AttributeTok{fill =} \FunctionTok{fct\_infreq}\NormalTok{(olhos))) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{\textquotesingle{}dodge\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{cabelos, }\AttributeTok{labeller =}\NormalTok{ label\_both) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}brown\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}\#908050\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \ConstantTok{NULL}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}\NormalTok{,}
      \AttributeTok{fill =} \StringTok{\textquotesingle{}olhos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Cor dos olhos e sexo por cor dos cabelos\textquotesingle{}}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-232-1} \end{center}
\end{itemize}

\hypertarget{data-frame-juxe1-contendo-os-totais}{%
\subsection{\texorpdfstring{\emph{Data frame} já contendo os totais}{Data frame já contendo os totais}}\label{data-frame-juxe1-contendo-os-totais}}

\begin{itemize}
\item
  Você percebeu que {\hl{{\mbox{\texttt{geom\_bar}}} analisa o \emph{data frame} e calcula as frequências}} necessárias para construir o gráfico.
\item
  Em algumas situações, {\hl{o \emph{data frame} já contém as frequências}} (em vez de conter uma linha por indivíduo).
\item
  Vamos usar \texttt{count} para criar um \emph{data frame} assim:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_tot }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(sexo, cabelos, olhos)}

\NormalTok{df\_tot}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 32 x 4
##   sexo  cabelos   olhos         n
##   <chr> <chr>     <chr>     <int>
## 1 homem castanhos avelã        10
## 2 homem castanhos azuis        11
## 3 homem castanhos castanhos    32
## 4 homem castanhos verdes        3
## 5 homem louros    avelã        25
## 6 homem louros    azuis        50
## # i 26 more rows
\end{verbatim}
\item
  Para $4$ cores de cabelo, $4$ cores de olhos, e $2$ sexos, são $32$ combinações possíveis.
\item
  Com este \emph{data frame}, podemos gerar todos os gráficos anteriores usando {\hl{{\mbox{\texttt{geom\_col}}} no lugar de {\mbox{\texttt{geom\_bar}}}}}. Por exemplo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_tot }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cabelos, }\AttributeTok{y =}\NormalTok{ n)) }\SpecialCharTok{+}
    \FunctionTok{geom\_col}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-234-1} \end{center}
\item
  Com \texttt{geom\_col}, {\hl{precisamos passar a estética $y$}} (no nosso exemplo, a variável \texttt{n}, que contém as frequências).
\item
  Para ordenar as barras, usamos a função \texttt{fct\_reorder}, que ordena os níveis de um fator (\texttt{cabelos}) de acordo com o resultado de uma função (\texttt{sum}) aplicada sobre os valores de outra variável (\texttt{n}):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_tot }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_reorder}\NormalTok{(cabelos, n, sum), }\AttributeTok{y =}\NormalTok{ n)) }\SpecialCharTok{+}
    \FunctionTok{geom\_col}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \StringTok{\textquotesingle{}cabelos\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-235-1} \end{center}
\end{itemize}

\hypertarget{gruxe1ficos-de-linha-e-suxe9ries-temporais}{%
\section{Gráficos de linha e séries temporais}\label{gruxe1ficos-de-linha-e-suxe9ries-temporais}}

\hypertarget{conjunto-de-dados-2}{%
\subsection{Conjunto de dados}\label{conjunto-de-dados-2}}

\begin{itemize}
\item
  O R tem uma matriz com as quantidades de telefones em várias regiões do mundo ao longo de vários anos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{WorldPhones}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer
## 1951  45939  21574 2876   1815    1646     89      555
## 1956  60423  29990 4708   2568    2366   1411      733
## 1957  64721  32510 5230   2695    2526   1546      773
## 1958  68484  35218 6662   2845    2691   1663      836
## 1959  71799  37598 6856   3000    2868   1769      911
## 1960  76036  40341 8220   3145    3054   1905     1008
## 1961  79831  43173 9053   3338    3224   2005     1076
\end{verbatim}
\item
  Os números representam milhares.
\item
  {\hl{Os números dos anos são os nomes das linhas da matriz.}}
\item
  Vamos transformar esta matriz em uma \emph{tibble}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fones }\OtherTok{\textless{}{-}}\NormalTok{ WorldPhones }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{(}\AttributeTok{rownames =} \StringTok{\textquotesingle{}Ano\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Ano =} \FunctionTok{as.numeric}\NormalTok{(Ano))}

\NormalTok{fones}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 7 x 8
##     Ano N.Amer Europe  Asia S.Amer Oceania Africa Mid.Amer
##   <dbl>  <dbl>  <dbl> <dbl>  <dbl>   <dbl>  <dbl>    <dbl>
## 1  1951  45939  21574  2876   1815    1646     89      555
## 2  1956  60423  29990  4708   2568    2366   1411      733
## 3  1957  64721  32510  5230   2695    2526   1546      773
## 4  1958  68484  35218  6662   2845    2691   1663      836
## 5  1959  71799  37598  6856   3000    2868   1769      911
## 6  1960  76036  40341  8220   3145    3054   1905     1008
## # i 1 more row
\end{verbatim}
\item
  Esta \emph{tibble} {\hl{não está no formato \emph{tidy}}}. Queremos que cada linha corresponda a uma observação, contendo

  \begin{itemize}
  \item
    Ano,
  \item
    Região,
  \item
    Quantidade de telefones.
  \end{itemize}
\item
  Usamos a função \texttt{pivot\_longer} para mudar o formato da \emph{tibble}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fones\_long }\OtherTok{\textless{}{-}}\NormalTok{ fones }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \SpecialCharTok{{-}}\NormalTok{Ano,}
    \AttributeTok{names\_to =} \StringTok{\textquotesingle{}Região\textquotesingle{}}\NormalTok{,}
    \AttributeTok{values\_to =} \StringTok{\textquotesingle{}n\textquotesingle{}}
\NormalTok{  )}

\NormalTok{fones\_long}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 49 x 3
##     Ano Região      n
##   <dbl> <chr>   <dbl>
## 1  1951 N.Amer  45939
## 2  1951 Europe  21574
## 3  1951 Asia     2876
## 4  1951 S.Amer   1815
## 5  1951 Oceania  1646
## 6  1951 Africa     89
## # i 43 more rows
\end{verbatim}
\item
  Confira: antes, tínhamos $7$ anos, com $7$ quantidades por ano, uma quantidade por região. Eram $49$ quantidades. Agora temos uma \emph{tibble} de $49$ linhas.
\end{itemize}

\hypertarget{gerando-gruxe1ficos-de-linha}{%
\subsection{Gerando gráficos de linha}\label{gerando-gruxe1ficos-de-linha}}

\begin{itemize}
\item
  {\hl{A geometria {\mbox{\texttt{geom\_line}}} gera gráficos de linha.}} Perceba como geramos uma linha por região:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fones\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Ano, }\AttributeTok{y =}\NormalTok{ n, }\AttributeTok{color =}\NormalTok{ Região)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \DecValTok{1951}\SpecialCharTok{:}\DecValTok{1961}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-239-1} \end{center}
\item
  Embora a legenda associe uma cor a cada região, {\hl{a leitura seria mais fácil se a ordem das regiões na legenda coincidisse com a posição das linhas na borda direita da grade}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fones\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}
      \FunctionTok{aes}\NormalTok{(}
        \AttributeTok{x =}\NormalTok{ Ano, }
        \AttributeTok{y =}\NormalTok{ n, }
        \AttributeTok{color =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_reorder}\NormalTok{(Região, n, max))}
\NormalTok{      )}
\NormalTok{  ) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \DecValTok{1951}\SpecialCharTok{:}\DecValTok{1961}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{color =} \StringTok{\textquotesingle{}Região\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{,}
      \AttributeTok{x =} \ConstantTok{NULL}\NormalTok{,}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Quantidade de aparelhos de telefone por ano, por região\textquotesingle{}}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-240-1} \end{center}
\item
  Parece que está faltando uma linha, mas o que acontece é que as quantidades da América do Sul e da Oceania são bem parecidas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fones\_long }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Região }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}S.Amer\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Oceania\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}
      \AttributeTok{x =}\NormalTok{ Ano, }
      \AttributeTok{y =}\NormalTok{ n, }
      \AttributeTok{color =} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_reorder}\NormalTok{(Região, n, max))}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \DecValTok{1951}\SpecialCharTok{:}\DecValTok{1961}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}Região\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-241-1} \end{center}
\item
  Estamos tratando estes dados como simples números, mas, na verdade, {\hl{este conjunto de dados é uma série temporal (\emph{time series})}}.
\item
  R tem todo um conjunto de funções para tratar séries temporais, calcular tendências, achar padrões cíclicos, fazer estimativas, e gerar gráficos específicos, entre outras coisas.
\item
  Mas não vamos falar mais sobre séries temporais aqui.
\item
  O {\hl{pacote {\mbox{\texttt{tsibble}}}}} oferece maneiras de trabalhar com séries temporais de maneira \emph{tidy}. Você pode ler a documentação do pacote entrando

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tsibble)}
\NormalTok{?}\StringTok{\textasciigrave{}}\AttributeTok{tsibble{-}package}\StringTok{\textasciigrave{}}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{exercuxedcios-6}{%
\section{Exercícios}\label{exercuxedcios-6}}

\hypertarget{o-bigode-dos-onuxedvoros}{%
\subsection{O bigode dos onívoros}\label{o-bigode-dos-onuxedvoros}}

\begin{itemize}
\tightlist
\item
  Examine o \emph{data frame} \texttt{sono} para descobrir o que houve com o bigode superior do \emph{boxplot} dos onívoros \protect\hyperlink{onivoros}{neste gráfico}.
\end{itemize}

\hypertarget{usando-geom_col}{%
\subsection{\texorpdfstring{Usando \texttt{geom\_col}}{Usando geom\_col}}\label{usando-geom_col}}

\begin{itemize}
\tightlist
\item
  Use \texttt{geom\_col} para reproduzir, a partir do \emph{data frame} \texttt{df\_tot}, todos os gráficos que foram gerados com \texttt{geom\_bar} na seção \protect\hyperlink{gerando-grux5cux25C3ux5cux25A1ficos-de-barras}{Gerando gráficos de barras}.
\end{itemize}

\hypertarget{referuxeancias-sobre-visualizauxe7uxe3o-e-r}{%
\section{Referências sobre visualização e R}\label{referuxeancias-sobre-visualizauxe7uxe3o-e-r}}

\begin{rmdtip}
Busque mais informações sobre os pacotes \texttt{tidyverse} e \texttt{ggplot2} \protect\hyperlink{refrec}{nas referências recomendadas}.

\end{rmdtip}

\hypertarget{medidas}{%
\chapter{Medidas}\label{medidas}}

\hypertarget{vuxeddeo}{%
\section{Vídeo}\label{vuxeddeo}}

\begin{center} \url{https://youtu.be/C96MOP4YlaY} \end{center}

\hypertarget{medidas-de-centralidade}{%
\section{Medidas de centralidade}\label{medidas-de-centralidade}}

\hypertarget{muxe9dia}{%
\subsection{Média}\label{muxe9dia}}

\begin{itemize}
\item
  A {\hl{média de uma população}} é escrita como $\mu$, e é definida como
  \[\mu = \frac{\sum_{i=1}^N x_i}{N}\]

  \begin{itemize}
  \item
    $\sum_{i=1}^N x_i$ é a soma de todos os dados da população.
  \item
    $N$ é a quantidade de elementos na população.
  \end{itemize}
\item
  A {\hl{média de uma amostra}} é escrita como $\bar x$, e é definida como:
  \[\bar x = \frac{\sum_{i=1}^n x_i}{n}\]

  \begin{itemize}
  \item
    $\sum_{i=1}^n x_i$ é a soma de todos os dados da amostra.
  \item
    $n$ é a quantidade de elementos na amostra.
  \end{itemize}
\item
  O cálculo é essencialmente o mesmo. Só mudam os símbolos: $N$ versus $n$, e $\mu$ versus $\bar x$.
\end{itemize}

\hypertarget{exemplo}{%
\subsubsection{Exemplo}\label{exemplo}}

\begin{itemize}
\item
  Idades dos alunos de uma turma:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{idades }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \DecValTok{20}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{21}\NormalTok{, }
  \DecValTok{22}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{24}\NormalTok{, }\DecValTok{24}\NormalTok{,}
  \DecValTok{65}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Média {\hl{com}} o velhinho de $65$ anos:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(idades)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 23,75
\end{verbatim}
\item
  Média {\hl{sem}} o velhinho:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(idades[}\SpecialCharTok{{-}}\FunctionTok{length}\NormalTok{(idades)])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21,57895
\end{verbatim}
\end{itemize}

\hypertarget{mediana-1}{%
\subsection{Mediana}\label{mediana-1}}

\begin{itemize}
\item
  Já aprendemos sobre a mediana na \protect\hyperlink{mediana}{seção sobre \emph{boxplots}}.
\item
  A idéia é que, depois de ordenar os dados, $50\%$ dos dados estarão à esquerda da mediana, e $50\%$ à direita.
\item
  A mediana não é tão sensível a \emph{outliers} quanto à média.
\end{itemize}

\hypertarget{exemplo-1}{%
\subsubsection{Exemplo}\label{exemplo-1}}

\begin{itemize}
\item
  Mediana {\hl{com}} o velhinho:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(idades)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21,5
\end{verbatim}
\item
  Mediana {\hl{sem}} o velhinho:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(idades[}\SpecialCharTok{{-}}\FunctionTok{length}\NormalTok{(idades)])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21
\end{verbatim}
\end{itemize}

\hypertarget{moda}{%
\subsection{Moda}\label{moda}}

\begin{itemize}
\item
  A {\hl{moda}} é o {\hl{valor mais frequente}} do conjunto de dados.
\item
  Pode haver mais de uma moda.
\item
  {\hl{Não existe uma função para a moda em R base.}} Por quê?
\item
  Por incrível que pareça, {\hl{é complicado definir a moda de forma a conseguir resultados interessantes}}.
\item
  {\hl{Por exemplo}}, vamos definir um conjunto de $1000$ valores numéricos distribuídos normalmente\footnote{Mais sobre a distribuição normal no capítulo ???.}, com média igual a $5$ e desvio-padrão\footnote{Mais sobre o desvio-padrão daqui a pouco.} igual a $2$:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{normal }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{1000}\NormalTok{, }\AttributeTok{mean =} \DecValTok{5}\NormalTok{, }\AttributeTok{sd =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  \protect\hypertarget{dados-normais}{}{} O histograma dos nossos dados é

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-246-1} \end{center}
\item
  Vamos calcular a moda com a função \texttt{mfv} (\emph{most frequent value}), do pacote \texttt{modeest}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Pacote com funções para calcular modas}
\FunctionTok{library}\NormalTok{(modeest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Registered S3 method overwritten by 'rmutil':
##   method         from
##   print.response httr
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Por causa de um bug na função mfv, }
\CommentTok{\# precisamos de números com ponto decimal}
\CommentTok{\# (em vez de vírgula):}
\FunctionTok{options}\NormalTok{(}\AttributeTok{OutDec =} \StringTok{\textquotesingle{}.\textquotesingle{}}\NormalTok{)}
\FunctionTok{mfv}\NormalTok{(normal)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    [1] -0.81215397 -0.12837356  0.02945055  0.13761992  0.22543367
##    [6]  0.22932082  0.33160123  0.34267641  0.36204940  0.40672372
##   [11]  0.50164710  0.53757801  0.63908611  0.78440766  0.81150134
##   [16]  0.89084600  0.89233798  0.94940125  0.96340957  0.97432526
##   [21]  1.10786961  1.11387156  1.14400890  1.14561818  1.15093796
##   [26]  1.20184130  1.20788733  1.25883939  1.29348498  1.29724675
##   [31]  1.30092483  1.32091504  1.32744674  1.33115485  1.37060682
##   [36]  1.37646270  1.38924447  1.41397149  1.42630231  1.44516282
##   [41]  1.44581105  1.44748108  1.56912995  1.57980642  1.58711704
##   [46]  1.61425456  1.61448039  1.62477493  1.64703042  1.71417696
##   [51]  1.71681425  1.73623974  1.75471652  1.76175668  1.77041763
##   [56]  1.77657787  1.77665743  1.78931736  1.79624004  1.80045380
##   [61]  1.82875930  1.83085097  1.83344742  1.84278846  1.85824245
##   [66]  1.87862248  1.89214256  1.89859163  1.90560512  1.90727968
##   [71]  1.92218788  1.92855987  1.93027508  1.94237134  2.01299743
##   [76]  2.01519826  2.03324241  2.05153033  2.05908049  2.06531115
##   [81]  2.07600714  2.08141639  2.08332919  2.14944030  2.15498184
##   [86]  2.16963254  2.18930912  2.19797426  2.20273020  2.20337299
##   [91]  2.22364746  2.22810507  2.23095922  2.23863719  2.24175853
##   [96]  2.30018947  2.31451509  2.33082985  2.33599546  2.34471315
##  [101]  2.35288387  2.35794985  2.35901050  2.36445789  2.37865128
##  [106]  2.38284413  2.39286199  2.39991724  2.41088196  2.41976797
##  [111]  2.42496055  2.43426231  2.44457229  2.46171505  2.46290602
##  [116]  2.46295447  2.48541149  2.49759547  2.49965339  2.50687039
##  [121]  2.50744477  2.51974453  2.55397764  2.57707849  2.57749438
##  [126]  2.58569370  2.59172246  2.59902612  2.63580244  2.63851229
##  [131]  2.64458221  2.64605225  2.65111275  2.65478667  2.67054966
##  [136]  2.67517088  2.67916714  2.70242419  2.70720782  2.71545698
##  [141]  2.72199029  2.73363763  2.74685591  2.76596550  2.77071684
##  [146]  2.77509391  2.78726880  2.79180951  2.79725247  2.79972762
##  [151]  2.80245464  2.80365756  2.81052524  2.82290484  2.82651026
##  [156]  2.83566836  2.84177621  2.85190666  2.85453259  2.85745656
##  [161]  2.86769289  2.87165810  2.88173681  2.88667335  2.89718420
##  [166]  2.90204566  2.90672081  2.90798892  2.91010157  2.92189683
##  [171]  2.97681273  2.97863628  2.98379253  2.98731228  2.98968927
##  [176]  2.99124152  3.00037652  3.00892747  3.00966826  3.01266175
##  [181]  3.01421454  3.01549097  3.01742968  3.03770304  3.05016940
##  [186]  3.06623591  3.06999208  3.08345812  3.09814078  3.10747966
##  [191]  3.11186900  3.12588898  3.12905704  3.14182392  3.14875445
##  [196]  3.15271186  3.15536870  3.15788666  3.15800828  3.17186930
##  [201]  3.17843615  3.18986412  3.19396803  3.19980126  3.20040525
##  [206]  3.20461272  3.20833879  3.22229827  3.22411908  3.23368491
##  [211]  3.24049152  3.24664137  3.25748856  3.26625258  3.26914028
##  [216]  3.31988994  3.32915961  3.33459538  3.34341870  3.34616003
##  [221]  3.34737722  3.35155463  3.35350875  3.36231244  3.36346161
##  [226]  3.36424564  3.37047226  3.37486259  3.37912612  3.38338483
##  [231]  3.39434285  3.42828251  3.43308469  3.44132574  3.44656091
##  [236]  3.46366923  3.46994735  3.49765881  3.50944095  3.53809119
##  [241]  3.53960675  3.54882236  3.55125652  3.56289767  3.57070340
##  [246]  3.57358125  3.57358129  3.58051098  3.58199783  3.59566352
##  [251]  3.59693106  3.60346653  3.60485957  3.60699393  3.61015054
##  [256]  3.61442235  3.61653526  3.62399143  3.64240546  3.64523111
##  [261]  3.64901669  3.65651312  3.65852038  3.66346969  3.67195581
##  [266]  3.67755680  3.67866863  3.68007948  3.68586718  3.68998873
##  [271]  3.69235143  3.70851484  3.72731412  3.72807126  3.72816674
##  [276]  3.73790998  3.74318750  3.75203205  3.77542957  3.78030607
##  [281]  3.78298519  3.78485813  3.78728562  3.79457788  3.79989383
##  [286]  3.80156836  3.80414639  3.81680653  3.83732886  3.84663022
##  [291]  3.84912417  3.84933022  3.85067967  3.85261340  3.85715478
##  [296]  3.85781405  3.85919267  3.86975188  3.87327735  3.88071525
##  [301]  3.88582271  3.88711352  3.89424767  3.90158521  3.90458857
##  [306]  3.91008990  3.92281346  3.94514979  3.95618778  3.96267519
##  [311]  3.96292501  3.96368108  3.97693029  3.98213764  3.98690321
##  [316]  4.00185552  4.00422001  4.01437597  4.02352234  4.02588333
##  [321]  4.02745006  4.02796580  4.02935984  4.03412561  4.03897717
##  [326]  4.04516115  4.06460063  4.06537515  4.07595868  4.08447083
##  [331]  4.09224493  4.09416005  4.09540465  4.09590007  4.10173481
##  [336]  4.10620829  4.11670855  4.12267944  4.12703933  4.13669104
##  [341]  4.13702037  4.14694746  4.15272384  4.15364436  4.15404163
##  [346]  4.15547130  4.15898014  4.16285292  4.16470288  4.16719533
##  [351]  4.17362099  4.17718152  4.17735507  4.18277908  4.19613016
##  [356]  4.19897916  4.21106716  4.21857052  4.24707238  4.24719101
##  [361]  4.24815754  4.25358171  4.25478750  4.26620989  4.28155070
##  [366]  4.28242460  4.28264309  4.28667496  4.29412371  4.30561963
##  [371]  4.30826101  4.31395047  4.31580644  4.31763113  4.32068451
##  [376]  4.32269795  4.32655681  4.33220627  4.33272901  4.33504651
##  [381]  4.34232172  4.34323268  4.35103263  4.35656658  4.36167854
##  [386]  4.36753849  4.37020454  4.39121993  4.39301073  4.39456038
##  [391]  4.39637965  4.39662743  4.39772451  4.40238034  4.41322662
##  [396]  4.41438487  4.41454664  4.41641786  4.42150752  4.42533366
##  [401]  4.43295523  4.43639555  4.44179066  4.44235449  4.45080346
##  [406]  4.46188820  4.46508551  4.46962194  4.47004553  4.48555548
##  [411]  4.48676980  4.49528898  4.49859342  4.51671657  4.52560970
##  [416]  4.53335163  4.53689488  4.53721026  4.54271356  4.55042644
##  [421]  4.55096881  4.56461383  4.56772286  4.56913907  4.57078342
##  [426]  4.57550932  4.58588657  4.58619918  4.58819314  4.59595489
##  [431]  4.59798825  4.60762404  4.61260556  4.62340588  4.62382990
##  [436]  4.62480331  4.63693938  4.64621421  4.65715511  4.65939738
##  [441]  4.66641338  4.66872071  4.67029305  4.67049977  4.68739045
##  [446]  4.69198818  4.69553906  4.69619013  4.71465868  4.71793831
##  [451]  4.71830955  4.73339960  4.73854042  4.74687207  4.75786779
##  [456]  4.75987187  4.76655700  4.77497501  4.77906044  4.78717974
##  [461]  4.79220241  4.79416179  4.79508586  4.80261377  4.80762827
##  [466]  4.81268880  4.81565839  4.82472974  4.82899331  4.83250753
##  [471]  4.84102436  4.84136862  4.84212529  4.85574533  4.85763939
##  [476]  4.86205571  4.86389724  4.86441327  4.86756892  4.86966908
##  [481]  4.87150576  4.88869662  4.89000086  4.89610119  4.90988864
##  [486]  4.91596256  4.92600690  4.93113026  4.93444763  4.93504162
##  [491]  4.93508576  4.93603341  4.93856074  4.94142839  4.94528857
##  [496]  4.94605443  4.96301283  4.97169950  4.98705074  4.98718431
##  [501]  4.99303973  5.00391248  5.01270079  5.02039502  5.02977406
##  [506]  5.03112342  5.03393943  5.03651066  5.04646700  5.05353868
##  [511]  5.05561895  5.05730308  5.06098185  5.08084132  5.08107944
##  [516]  5.08194100  5.08756745  5.09224213  5.09483226  5.10745161
##  [521]  5.10818885  5.10981401  5.11469178  5.12396251  5.13397490
##  [526]  5.14151753  5.14759759  5.14772983  5.16504294  5.16556762
##  [531]  5.17066572  5.17211584  5.17599239  5.17933436  5.18744627
##  [536]  5.18920632  5.19868104  5.19873771  5.21069427  5.21352046
##  [541]  5.21689700  5.22230312  5.22762755  5.22914232  5.23598163
##  [546]  5.23844998  5.24393385  5.25733762  5.25922517  5.26903430
##  [551]  5.28416038  5.28708357  5.28966302  5.29134462  5.29200513
##  [556]  5.29503795  5.30653217  5.33091962  5.33782090  5.33874446
##  [561]  5.34101197  5.34886794  5.35769427  5.36139408  5.36397527
##  [566]  5.36474392  5.36654772  5.36828885  5.37079656  5.37520534
##  [571]  5.37984269  5.39382686  5.39471311  5.39812578  5.40324884
##  [576]  5.40394243  5.40972205  5.41398076  5.43185342  5.44891735
##  [581]  5.44928777  5.45223568  5.45355200  5.45851621  5.46029197
##  [586]  5.46208645  5.46242192  5.46505654  5.47965259  5.47986760
##  [591]  5.50555720  5.50670592  5.51589038  5.51993178  5.52822631
##  [596]  5.52964680  5.53240853  5.53264277  5.53452343  5.54066666
##  [601]  5.54411732  5.54873351  5.55286428  5.55299111  5.55637291
##  [606]  5.56325114  5.56667853  5.56710578  5.56780209  5.56930104
##  [611]  5.56962997  5.57169131  5.58313181  5.58475868  5.58724711
##  [616]  5.59796886  5.63177071  5.63644459  5.64287226  5.64541488
##  [621]  5.65497674  5.66218516  5.66397853  5.66879079  5.67051876
##  [626]  5.67751756  5.68407067  5.68551033  5.69359706  5.70575710
##  [631]  5.71629422  5.72505705  5.73607529  5.73757351  5.74226952
##  [636]  5.74731607  5.75842644  5.76959292  5.77265844  5.78706053
##  [641]  5.78791844  5.79243016  5.79504499  5.80327789  5.80971322
##  [646]  5.81246681  5.81664666  5.81706087  5.82273198  5.82313386
##  [651]  5.83553623  5.84548177  5.84971923  5.85033989  5.85203008
##  [656]  5.85968257  5.86213984  5.86593688  5.86744562  5.87101920
##  [661]  5.87288447  5.87464060  5.87947739  5.88091055  5.88645383
##  [666]  5.89343605  5.90192150  5.90465928  5.91091233  5.93169328
##  [671]  5.93428738  5.93475206  5.93905913  5.93951668  5.94099707
##  [676]  5.94121021  5.94430687  5.94888211  5.95204538  5.96521533
##  [681]  5.96949716  5.97105771  5.98073315  5.99355313  5.99471453
##  [686]  6.00579608  6.01190497  6.01275471  6.01905984  6.02008870
##  [691]  6.02490342  6.03318455  6.03439497  6.03487064  6.03563679
##  [696]  6.03748276  6.04196350  6.04346816  6.04458887  6.04506592
##  [701]  6.04899988  6.05786954  6.07443690  6.07683981  6.08781748
##  [706]  6.09772527  6.10363903  6.10638740  6.10784184  6.11242243
##  [711]  6.11759432  6.13100860  6.13781903  6.15185319  6.15310676
##  [716]  6.15352653  6.15820513  6.16305744  6.16439958  6.16821212
##  [721]  6.16968902  6.18284544  6.18387258  6.19819522  6.19849250
##  [726]  6.19962006  6.22865845  6.24108265  6.24115739  6.25290143
##  [731]  6.27353591  6.28141231  6.28563470  6.28909673  6.28916518
##  [736]  6.30505876  6.31921793  6.32101191  6.32830156  6.33344479
##  [741]  6.34408252  6.34809222  6.35197967  6.35225563  6.35264221
##  [746]  6.36664073  6.37388737  6.37578608  6.38196472  6.38284715
##  [751]  6.38626936  6.39112855  6.39342695  6.39590835  6.40377783
##  [756]  6.41304206  6.41372018  6.41704666  6.42424331  6.42561500
##  [761]  6.42877601  6.43013465  6.43491996  6.44863700  6.44882701
##  [766]  6.44915688  6.46235089  6.48121074  6.49203870  6.49455670
##  [771]  6.49684590  6.50550196  6.51027750  6.51317124  6.51391875
##  [776]  6.51571093  6.52420411  6.52615293  6.53073785  6.53335153
##  [781]  6.53571353  6.53625568  6.54613488  6.56620537  6.56865566
##  [786]  6.58175206  6.58394702  6.61772757  6.62153295  6.62379623
##  [791]  6.62780471  6.63269382  6.65462622  6.66126490  6.66797334
##  [796]  6.67102159  6.68737932  6.70504888  6.70798240  6.71095244
##  [801]  6.71305337  6.72006049  6.72695483  6.72711189  6.73143218
##  [806]  6.73400561  6.75664832  6.75699150  6.79394357  6.79619499
##  [811]  6.80642739  6.80881034  6.81701095  6.81716081  6.82757177
##  [816]  6.82834835  6.84572178  6.85031686  6.87223558  6.87804425
##  [821]  6.88003836  6.88083520  6.88955685  6.89667135  6.89930848
##  [826]  6.92867371  6.93209735  6.93424626  6.94803339  6.95608615
##  [831]  6.96568086  6.96713635  6.97803912  6.99798640  7.00920466
##  [836]  7.01491084  7.01580723  7.01906316  7.02572869  7.03352208
##  [841]  7.03749205  7.04258321  7.04330701  7.04421595  7.04665726
##  [846]  7.05123042  7.05125387  7.05525179  7.05984351  7.07541369
##  [851]  7.07658556  7.08101749  7.08323766  7.10014071  7.10659188
##  [856]  7.10913475  7.10948347  7.11407978  7.11583687  7.11654960
##  [861]  7.14140426  7.14151530  7.15714380  7.16719233  7.18389792
##  [866]  7.18804179  7.19449472  7.19996120  7.21520750  7.22179784
##  [871]  7.23825960  7.25712225  7.26279117  7.27391629  7.28634523
##  [876]  7.28795559  7.29662962  7.31916681  7.31953004  7.33160920
##  [881]  7.34211412  7.34276784  7.35648053  7.35944649  7.36348605
##  [886]  7.36699395  7.39464405  7.40284589  7.40732797  7.41087095
##  [891]  7.41538244  7.41575144  7.42461729  7.46338465  7.48726807
##  [896]  7.51386023  7.54312551  7.57188593  7.57844150  7.58557748
##  [901]  7.59858458  7.59959266  7.60179597  7.63328518  7.63917754
##  [906]  7.64231789  7.64659966  7.66954137  7.68175961  7.68838802
##  [911]  7.70078345  7.71409649  7.72847088  7.73535950  7.73924634
##  [916]  7.74453024  7.75484053  7.75563372  7.75619617  7.76520187
##  [921]  7.79315029  7.80312621  7.80736272  7.81395137  7.82610568
##  [926]  7.86565712  7.89121846  7.89634090  7.89703268  7.89877807
##  [931]  7.92868450  7.94251068  7.94585995  7.95633690  7.96061926
##  [936]  7.96810477  7.99840964  7.99950939  8.01261503  8.02008798
##  [941]  8.03959026  8.07802083  8.09448956  8.10580490  8.11428596
##  [946]  8.13462259  8.14295291  8.19569886  8.23991558  8.26133737
##  [951]  8.26602927  8.27241696  8.27466037  8.32695026  8.33163874
##  [956]  8.33556784  8.35621239  8.36358233  8.42018783  8.44153186
##  [961]  8.49112933  8.51016101  8.51345712  8.53509259  8.56024291
##  [966]  8.63002338  8.63543558  8.65708934  8.66428457  8.75190818
##  [971]  8.76422926  8.78999783  8.82129221  8.84185049  8.88383386
##  [976]  8.91857276  8.95436061  8.96819530  8.98599839  9.00516056
##  [981]  9.02236375  9.08768972  9.18525858  9.25959788  9.29088198
##  [986]  9.36523331  9.37545506  9.43501710  9.50755739  9.54353512
##  [991]  9.58365760  9.63790333  9.92587466 10.16728070 10.19414445
##  [996] 10.35270048 10.43896958 10.51337535 11.02845728 13.00355067
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Voltamos para a vírgula como separador decimal:}
\FunctionTok{options}\NormalTok{(}\AttributeTok{OutDec =} \StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  O que houve?!
\item
  O problema é que não há valores repetidos no conjunto de dados! Por isso, todos os $1000$ valores são modais.
\item
  Uma maneira de evitar isto é definir a moda como o {\hl{centro do intervalo mais curto que contém metade dos dados}}. Usamos a função \texttt{mlv} (\emph{most likely value}):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{moda }\OtherTok{\textless{}{-}} \FunctionTok{mlv}\NormalTok{(normal, }\AttributeTok{method =} \StringTok{\textquotesingle{}venter\textquotesingle{}}\NormalTok{)}
\NormalTok{moda}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5,161771
\end{verbatim}
\item
  Esta moda estimada pode nem estar no conjunto de dados:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{moda }\SpecialCharTok{\%in\%}\NormalTok{ normal}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE
\end{verbatim}
\item
  Mas o resultado de \texttt{mlv()} é útil, pois nos diz que, embora não haja valores repetidos, valores próximos de $5$ são mais frequentes, como mostra o histograma.
\end{itemize}

\hypertarget{exercuxedcios-7}{%
\subsubsection{Exercícios}\label{exercuxedcios-7}}

\begin{itemize}
\item
  Arrendonde os valores no vetor \texttt{normal} para $2$ casas decimais e ache a(s) moda(s)

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    com a função \texttt{mfv}, e
  \item
    com a função \texttt{mlv}, usando o método \texttt{venter}.
  \end{enumerate}

  \protect\hyperlink{dados-normais}{Considerando o histograma}, qual das respostas você prefere? Por quê?
\end{itemize}

\hypertarget{formas-de-uma-distribuiuxe7uxe3o}{%
\section{Formas de uma distribuição}\label{formas-de-uma-distribuiuxe7uxe3o}}

\begin{itemize}
\tightlist
\item
  A forma do histograma mostra aspectos importantes da distribuição dos dados.
\end{itemize}

\hypertarget{distribuiuxe7uxe3o-uniforme}{%
\subsection{Distribuição Uniforme}\label{distribuiuxe7uxe3o-uniforme}}

\begin{itemize}
\item
  Se o histograma tem todas as barras aproximadamente da mesma altura, dizemos que a distribuição é {\hl{uniforme}}:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-248-1} \end{center}
\item
  {\hl{A distribuição uniforme não tem moda}}, já que todos os valores têm aproximadamente a mesma frequência.
\end{itemize}

\hypertarget{simetria}{%
\subsection{Simetria}\label{simetria}}

\begin{itemize}
\item
  Se o histograma for simétrico (i.e., os lados esquerdo e direito são ``espelhados''), dizemos que a distribuição é {\hl{simétrica}}.
\item
  A distribuição normal \protect\hyperlink{dados-normais}{do exemplo acima} é simétrica.
\item
  A distribuição uniforme também é simétrica.
\item
  Para distribuições simétricas, a média, a mediana e a moda {\hl{(quando existe e é única)}} são bem próximas.

  \begin{itemize}
  \item
    Para a distribuição normal do exemplo:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(normal)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4,980165
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(normal)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4,990112
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mlv}\NormalTok{(normal, }\AttributeTok{method =} \StringTok{\textquotesingle{}venter\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5,161771
\end{verbatim}
  \item
    Para a distribuição uniforme do exemplo:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(uniforme)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4,999604
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(uniforme)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5,13832
\end{verbatim}
  \end{itemize}
\item
  Uma distribuição pode ser {\hl{simétrica}}, mas ter {\hl{duas (ou mais) modas diferentes}}:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/bimodal-1} \end{center}
\item
  Algumas distribuições não são simétricas, mas têm uma {\hl{cauda longa}} à esquerda ou à direita.
\item
  Dependendo da cauda, as distribuições são chamadas de {\hl{assimétricas à esquerda}} ou {\hl{assimétricas à direita}}.
\item
  Um exemplo: receitas anuais (em milhões de dólares) de CEOs de grandes empresas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}
  \StringTok{\textquotesingle{}./data/CEO\_Salary\_2012.csv\textquotesingle{}}\NormalTok{,}
  \AttributeTok{show\_col\_types =} \ConstantTok{FALSE}
\NormalTok{)}
\FunctionTok{glimpse}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 500
## Columns: 9
## $ Rank                  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, ~
## $ Name                  <chr> "John H Hammergren", "Ralph Lauren", "M~
## $ Company               <chr> "McKesson", "Ralph Lauren", "Vornado Re~
## $ `1-Year Pay ($mil)`   <dbl> 131,190, 66,650, 64,405, 60,940, 55,790~
## $ `5 Year Pay ($mil)`   <dbl> 285,020, 204,060, NA, 60,940, 96,110, 1~
## $ `Shares Owned ($mil)` <dbl> 51,9, 5010,4, 171,7, 8582,3, 21,5, 47,3~
## $ Age                   <dbl> 53, 72, 55, 67, 59, 57, 55, 59, 61, 60,~
## $ Efficiency            <dbl> 121, 84, NA, NA, 138, 36, 12, NA, 91, 1~
## $ `Log Pay`             <dbl> 8,117901, 7,823800, 7,808920, 7,784902,~
\end{verbatim}
\item
  Vamos usar apenas os nomes e os valores anuais:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Name, }\AttributeTok{valor =} \StringTok{\textasciigrave{}}\AttributeTok{1{-}Year Pay ($mil)}\StringTok{\textasciigrave{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Um histograma:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ valor)) }\SpecialCharTok{+}
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{150}\NormalTok{, }\FloatTok{2.5}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{150}\NormalTok{, }\DecValTok{10}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/ceos-hist-1} \end{center}
\item
  É uma distribuição {\hl{assimétrica à direita}}: a maior parte dos CEOs têm receitas anuais ``baixas'', de menos de $10$ milhões. À medida que examinamos valores maiores, a quantidade de CEOs vai diminuindo lentamente.
\item
  Observe que {\hl{a longa cauda à direita ``puxa'' a média para um valor mais alto do que a mediana}}.
\item
  A moda, que corresponde à barra mais alta do histograma, é menor que a mediana (e que a média):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sumario }\OtherTok{\textless{}{-}}\NormalTok{ salarios }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{moda =} \FunctionTok{mlv}\NormalTok{(valor, }\AttributeTok{method =} \StringTok{\textquotesingle{}venter\textquotesingle{}}\NormalTok{),}
    \AttributeTok{mediana =} \FunctionTok{median}\NormalTok{(valor),}
    \AttributeTok{media =} \FunctionTok{mean}\NormalTok{(valor)}
\NormalTok{  )}

\NormalTok{sumario}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 3
##    moda mediana media
##   <dbl>   <dbl> <dbl>
## 1  4.60    6.97  10.5
\end{verbatim}
\item
  Em um \emph{boxplot}, também é possível detectar a assimetria pela grande quantidade de \emph{outliers} em um extremo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ valor)) }\SpecialCharTok{+}
    \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{150}\NormalTok{, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/ceos-boxplot-1} \end{center}
\item
  Com distribuições {\hl{assimétricas à esquerda}}, a situação se inverte: {\hl{a média é menor que a mediana, que é menor que a moda}}.
\end{itemize}

\hypertarget{exercuxedcios-8}{%
\subsection{Exercícios}\label{exercuxedcios-8}}

\begin{itemize}
\item
  Ache um conjunto de dados com uma distribuição assimétrica à esquerda.
\item
  Faça um histograma.
\item
  Calcule a média, a mediana, e a moda dos dados.
\end{itemize}

\hypertarget{re-expressuxe3o}{%
\section{Re-expressão}\label{re-expressuxe3o}}

\begin{itemize}
\item
  Muitas vezes, é recomendável {\hl{transformar a escala dos dados}} para que uma distribuição assimétrica se torne simétrica.
\item
  No exemplo das receitas dos CEOs, podemos tomar os {\hl{logaritmos}} dos valores, em vez dos valores:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios\_log }\OtherTok{\textless{}{-}}\NormalTok{ salarios }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{log\_valor =} \FunctionTok{log10}\NormalTok{(valor))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios\_log }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ log\_valor)) }\SpecialCharTok{+}
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{x =} \FunctionTok{TeX}\NormalTok{(}\StringTok{\textquotesingle{}$}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{log\_\{10\}$ valor\textquotesingle{}}\NormalTok{),}
      \AttributeTok{y =} \ConstantTok{NULL}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 3 rows containing non-finite values (`stat_bin()`).
\end{verbatim}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/ceos-log-hist-1} \end{center}
\item
  O logaritmo de um número na base $10$ é, essencialmente, a quantidade de dígitos do número, vista como uma grandeza contínua.
\item
  Logaritmos negativos vêm de valores entre $0$ e $1$.
\item
  Logaritmo zero vem do valor $1$.
\item
  Valores iguais ou menores que zero não têm logaritmo definido.
\item
  Por isso a mensagem de aviso sobre $3$ valores removidos. São valores iguais a zero:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios\_log }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(valor }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 3
##   Name               valor log_valor
##   <chr>              <dbl>     <dbl>
## 1 Malon Wilkus           0      -Inf
## 2 Matthew J Lambiase     0      -Inf
## 3 Larry Page             0      -Inf
\end{verbatim}
\item
  Uma vantagem desta escala logarítmica é que podemos entender melhor o histograma. Os dados não estão amontoados de um lado só.
\end{itemize}

\hypertarget{exercuxedcios-9}{%
\subsection{Exercícios}\label{exercuxedcios-9}}

\begin{itemize}
\item
  Quais são os registros com $\log_{10} \text{valor} < 0$?
\item
  Faça um \emph{boxplot} dos logaritmos das receitas.
\end{itemize}

\hypertarget{medidas-de-posiuxe7uxe3o}{%
\section{Medidas de posição}\label{medidas-de-posiuxe7uxe3o}}

\hypertarget{quantis}{%
\subsection{Quantis}\label{quantis}}

\begin{itemize}
\item
  Na \protect\hyperlink{mediana}{seção sobre \emph{boxplots}}, falamos sobre {\hl{quantis}}, que são medidas de posição.
\item
  Em R, a função \texttt{quantile} calcula quantis de um vetor:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(valor) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{quantile}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        0%       25%       50%       75%      100% 
##   0,00000   3,88500   6,96750  13,36125 131,19000
\end{verbatim}
\item
  Você pode passar frações entre $0$ e $1$ para \texttt{quantile}. Por exemplo, para calcular o primeiro, o quinto, e o décimo percentis\footnote{Um percentil é um quantil da forma $k/100$, para $k$ natural, $0 \leq k \leq 100$.} das receitas dos CEOs:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{salarios }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(valor) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{quantile}\NormalTok{(}\FunctionTok{c}\NormalTok{(.}\DecValTok{01}\NormalTok{, .}\DecValTok{05}\NormalTok{, .}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      1%      5%     10% 
## 0,48695 1,48405 2,19400
\end{verbatim}
\end{itemize}

\hypertarget{medidas-de-dispersuxe3o}{%
\section{Medidas de dispersão}\label{medidas-de-dispersuxe3o}}

\begin{itemize}
\item
  Tão importantes quanto as medidas de centralidade são as medidas de dispersão (ou {\hl{espalhamento}}).
\item
  Elas informam {\hl{o quanto os dados variam}}.
\end{itemize}

\hypertarget{amplitude}{%
\subsection{Amplitude}\label{amplitude}}

\begin{itemize}
\item
  Uma medida simples é a {\hl{diferença entre o valor máximo e o valor mínimo}}.
\item
  Lembrando do nosso exemplo das idades dos alunos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{idades}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 20 20 20 20 20 20 21 21 21 21 22 22 22 23 23 23 23 24 24 65
\end{verbatim}
\item
  A função \texttt{range} retorna o mínimo e o máximo:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{range}\NormalTok{(idades)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 20 65
\end{verbatim}
\item
  A amplitude destes dados é, então

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{range}\NormalTok{(idades)[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{{-}} \FunctionTok{range}\NormalTok{(idades)[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 45
\end{verbatim}
\item
  A diferença de idade entre o aluno mais novo e o mais velho é de $45$ anos, um valor alto, por causa do velhinho.
\end{itemize}

\hypertarget{iqr}{%
\subsection{IQR}\label{iqr}}

\begin{itemize}
\item
  Na \protect\hyperlink{mediana}{seção sobre \emph{boxplots}}, também falamos sobre o {\hl{intervalo interquartil}} (IQR).
\item
  No \emph{boxplot}, é a {\hl{altura da caixa}}. Para as idades dos alunos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{idades }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ value)) }\SpecialCharTok{+}
    \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{70}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/idades-bp-1} \end{center}
\item
  O IQR é a diferença entre o primeiro e o terceiro quartis:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(idades)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   20,00   20,00   21,50   23,75   23,00   65,00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unname}\NormalTok{(}\FunctionTok{summary}\NormalTok{(idades)[}\DecValTok{5}\NormalTok{] }\SpecialCharTok{{-}} \FunctionTok{summary}\NormalTok{(idades)[}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{(idades)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}
\item
  Ou seja, {\hl{os $50\%$ centrais dos alunos têm idade entre $20$ e $23$ anos}}, um IQR de $3$.
\item
  É uma variação pequena, porém mais fiel à realidade do que a amplitude, que é alta por causa do velhinho.
\item
  Quanto maior o IQR, mais espalhados estão os dados.
\end{itemize}

\hypertarget{variuxe2ncia}{%
\subsection{Variância}\label{variuxe2ncia}}

\begin{itemize}
\item
  Agora, vamos trabalhar com os pesos (kg) e alturas (m) de um time de basquete:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{medidas }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{altura =}\NormalTok{ .}\DecValTok{025} \SpecialCharTok{*} 
    \FunctionTok{c}\NormalTok{(}\DecValTok{72}\NormalTok{, }\DecValTok{74}\NormalTok{, }\DecValTok{68}\NormalTok{, }\DecValTok{76}\NormalTok{, }\DecValTok{74}\NormalTok{, }\DecValTok{69}\NormalTok{, }\DecValTok{72}\NormalTok{, }\DecValTok{79}\NormalTok{, }\DecValTok{70}\NormalTok{, }\DecValTok{69}\NormalTok{, }\DecValTok{77}\NormalTok{, }\DecValTok{73}\NormalTok{),}
  \AttributeTok{peso =} \FloatTok{0.45} \SpecialCharTok{*} 
    \FunctionTok{c}\NormalTok{(}\DecValTok{180}\NormalTok{, }\DecValTok{168}\NormalTok{, }\DecValTok{225}\NormalTok{, }\DecValTok{201}\NormalTok{, }\DecValTok{189}\NormalTok{, }\DecValTok{192}\NormalTok{, }\DecValTok{197}\NormalTok{, }\DecValTok{162}\NormalTok{, }\DecValTok{174}\NormalTok{, }\DecValTok{171}\NormalTok{, }\DecValTok{185}\NormalTok{, }\DecValTok{210}\NormalTok{)}
\NormalTok{)}

\NormalTok{medidas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 12 x 2
##   altura  peso
##    <dbl> <dbl>
## 1   1.8   81  
## 2   1.85  75.6
## 3   1.7  101. 
## 4   1.9   90.4
## 5   1.85  85.0
## 6   1.72  86.4
## # i 6 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(medidas}\SpecialCharTok{$}\NormalTok{altura)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1,700   1,744   1,812   1,819   1,863   1,975
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(medidas}\SpecialCharTok{$}\NormalTok{peso)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   72,90   77,96   84,15   84,53   89,10  101,25
\end{verbatim}
\item
  A {\hl{variância}} é a maneira mais usada de medir o espalhamento em torno da média.
\item
  Para calcular a variância das alturas e a variância dos pesos, precisamos calcular valores intermediários.
\item
  O {\hl{desvio}} de um valor é a {\hl{diferença entre o valor e a média}}. O desvio pode ser positivo ou negativo.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_medidas }\OtherTok{\textless{}{-}}\NormalTok{ medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{d\_altura =}\NormalTok{ altura }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(altura),}
    \AttributeTok{d\_peso =}\NormalTok{ peso }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(peso)}
\NormalTok{  )}

\NormalTok{d\_medidas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 12 x 4
##   altura  peso d_altura d_peso
##    <dbl> <dbl>    <dbl>  <dbl>
## 1   1.8   81    -0.0188 -3.53 
## 2   1.85  75.6   0.0312 -8.92 
## 3   1.7  101.   -0.119  16.7  
## 4   1.9   90.4   0.0813  5.92 
## 5   1.85  85.0   0.0312  0.525
## 6   1.72  86.4  -0.0938  1.88 
## # i 6 more rows
\end{verbatim}
\item
  Vamos calcular o desvio médio das alturas e o desvio médio dos pesos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{d\_medio\_altura =} \FunctionTok{mean}\NormalTok{(d\_altura),}
    \AttributeTok{d\_medio\_peso =} \FunctionTok{mean}\NormalTok{(d\_peso)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 2
##   d_medio_altura d_medio_peso
##            <dbl>        <dbl>
## 1              0    -3.55e-15
\end{verbatim}
\item
  \protect\hypertarget{desvio-medio-zero}{}{} Não foi uma boa idéia. {\hl{O desvio médio sempre é igual a zero}}.\footnote{Você vai provar isto em um exercício.} (O R pode mostrar algum valor diferente de zero por causa da precisão limitada dos números de ponto flutuante.)
\item
  Como resolver isto? Elevando os desvios ao quadrado:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dq\_medidas }\OtherTok{\textless{}{-}}\NormalTok{ d\_medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{dq\_altura =}\NormalTok{ d\_altura}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{,}
    \AttributeTok{dq\_peso =}\NormalTok{ d\_peso}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{  )}

\NormalTok{dq\_medidas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 12 x 6
##   altura  peso d_altura d_peso dq_altura dq_peso
##    <dbl> <dbl>    <dbl>  <dbl>     <dbl>   <dbl>
## 1   1.8   81    -0.0188 -3.53   0.000352  12.4  
## 2   1.85  75.6   0.0312 -8.92   0.000977  79.7  
## 3   1.7  101.   -0.119  16.7    0.0141   280.   
## 4   1.9   90.4   0.0813  5.92   0.00660   35.1  
## 5   1.85  85.0   0.0312  0.525  0.000977   0.276
## 6   1.72  86.4  -0.0938  1.88   0.00879    3.52 
## # i 6 more rows
\end{verbatim}
\item
  Agora temos os {\hl{desvios quadrados}}, que são todos {\hl{positivos}}.
\item
  O {\hl{desvio quadrado médio}} vai ser a {\hl{variância}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dq\_medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{var\_altura =} \FunctionTok{mean}\NormalTok{(dq\_altura),}
    \AttributeTok{var\_peso =} \FunctionTok{mean}\NormalTok{(dq\_peso)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 2
##   var_altura var_peso
##        <dbl>    <dbl>
## 1    0.00678     63.3
\end{verbatim}
\item
  Uma vantagem da variância é que \emph{outliers} (que têm desvios quadrados maiores) contribuem mais do que elementos próximos à média (que têm desvios quadrados menores).
\item
  Uma desvantagem da variância é que a {\hl{sua unidade é o quadrado da unidade dos valores}}.
\item
  Neste exemplo, as unidades são $m^2$ e $kg^2$!
\end{itemize}

\hypertarget{desvio-padruxe3o}{%
\subsection{Desvio-padrão}\label{desvio-padruxe3o}}

\begin{itemize}
\item
  É melhor trabalhar com {\hl{a raiz quadrada da variância}}, que chamamos de {\hl{desvio-padrão}}.
\item
  As unidades são as mesmas que as unidades dos dados.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dq\_medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{dp\_altura =} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{mean}\NormalTok{(dq\_altura)),}
    \AttributeTok{dp\_peso =} \FunctionTok{sqrt}\NormalTok{((}\FunctionTok{mean}\NormalTok{(dq\_peso)))}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 2
##   dp_altura dp_peso
##       <dbl>   <dbl>
## 1    0.0824    7.96
\end{verbatim}
\item
  Claro que o R tem funções para calcular isso: \texttt{var} e \texttt{sd} (\emph{standard deviation}):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{altura\_var =} \FunctionTok{var}\NormalTok{(altura),}
    \AttributeTok{altura\_dp =} \FunctionTok{sd}\NormalTok{(altura),}
    \AttributeTok{peso\_var =} \FunctionTok{var}\NormalTok{(peso),}
    \AttributeTok{peso\_dp =} \FunctionTok{sd}\NormalTok{(peso)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 4
##   altura_var altura_dp peso_var peso_dp
##        <dbl>     <dbl>    <dbl>   <dbl>
## 1    0.00740    0.0860     69.1    8.31
\end{verbatim}
\item
  Mas os valores são diferentes dos que calculamos. Por quê?
\end{itemize}

\hypertarget{definiuxe7uxf5es}{%
\subsection{Definições}\label{definiuxe7uxf5es}}

\begin{itemize}
\item
  Para uma {\hl{população}} com $N$ elementos e média $\mu$, a {\hl{variância}} é

  \[
  \sigma^2 = \frac{\sum_{i=1}^N (x_i - \mu)^2}{N}
  \]

  e o {\hl{desvio-padrão}} é

  \[
  \sigma = \sqrt{\frac{\sum_{i=1}^N (x_i - \mu)^2}{N}}
  \]
\item
  Para uma {\hl{amostra}} com $n$ elementos e média $\bar x$, a {\hl{variância}} é

  \[
  s^2 = \frac{\sum_{i=1}^n (x_i - \bar x)^2}{n-1}
  \]

  e o {\hl{desvio-padrão}} é

  \[
  s = \sqrt{\frac{\sum_{i=1}^n (x_i - \bar x)^2}{n -1}}
  \]
\item
  Nós calculamos a versão {\hl{populacional}} destas medidas.
\item
  R calcula a versão {\hl{amostral}} destas medidas.
\item
  Reveja os cálculos e entenda a diferença.
\item
  Note, também, que as {\hl{medidas populacionais são representadas por letras gregas}} --- $\mu$, $\sigma^2$, $\sigma$ ---, enquanto as {\hl{medidas amostrais são representadas por letras latinas}} --- $\bar x$, $s^2$, $s$.
\end{itemize}

\begin{rmdimportant}
Mais adiante no curso, você vai entender por que o denominador da variância amostral é $n - 1$, em vez de $n$.

Nada é por acaso, nem mesmo em Estatística.

\end{rmdimportant}

\hypertarget{exercuxedcios-10}{%
\subsection{Exercícios}\label{exercuxedcios-10}}

\begin{itemize}
\item
  Quando a variância e o desvio-padrão de um conjunto de dados são iguais a zero?
\item
  Mostre que o \protect\hyperlink{desvio-medio-zero}{desvio médio de qualquer conjunto de valores é igual a zero}.

  Ou seja, considere o conjunto

  \[
  \{x_1, x_2, \ldots, x_n\}
  \]

  e prove que

  \[
  \sum_{i = 1}^n (x_i - \bar x) = 0
  \]

  Manipule apenas as variáveis $x_i$. {\hl{Não use exemplos, pois eles não provam o enunciado geral.}}

  \textbf{Dica:} lembre que $\displaystyle \bar x = \frac{\sum_{i = 1}^n x_i}{n}$.
\end{itemize}

\hypertarget{coeficiente-de-variauxe7uxe3o}{%
\section{Coeficiente de variação}\label{coeficiente-de-variauxe7uxe3o}}

\begin{itemize}
\item
  Em um conjunto de dados, o desvio-padrão é uma medida importante da variação dos dados.
\item
  Mas {\hl{a unidade do desvio-padrão muda de um conjunto de dados para outro}}: alturas em metros, pesos em quilos etc.
\item
  {\hl{Podemos eliminar as unidades expressando o desvio-padrão em termos da média}}.
\item
  O resultado é a fração $\frac{\sigma}{\mu}$ (na população) ou $\frac{s}{\bar x}$ na amostra.
\item
  Esta fração é o {\hl{coeficiente de variação (CV)}}.
\item
  O CV não tem unidades.
\item
  Para as alturas do exemplo dos jogadores de basquete:

  A média das alturas é $1{,}82$ metros.

  O desvio-padrão das alturas é $0{,}09$ metros.

  O CV é aproximadamente $0{,}0473$.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{statip}\SpecialCharTok{::}\FunctionTok{cv}\NormalTok{(medidas}\SpecialCharTok{$}\NormalTok{altura)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,04729982
\end{verbatim}

  Em outras palavras, {\hl{para as alturas, um desvio-padrão corresponde a $4{,}73\%$ da média}}.
\item
  Para os pesos:

  A média dos pesos é $84{,}53$ quilos.

  O desvio-padrão dos pesos é $8{,}31$ quilos.

  O CV é aproximadamente $0{,}0983$.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{statip}\SpecialCharTok{::}\FunctionTok{cv}\NormalTok{(medidas}\SpecialCharTok{$}\NormalTok{peso)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,09834649
\end{verbatim}

  Em outras palavras, {\hl{para os pesos, um desvio-padrão corresponde a $9{,}83\%$ da média}}.
\item
  Segundo estes valores, a variação dos pesos é cerca de $2$ vezes maior do que a variação das alturas.
\end{itemize}

\begin{rmdcaution}
O coeficiente de variação sempre faz sentido para dados do {\hl{nível racional}} (\protect\hyperlink{niveis-de-dados}{veja a definição}) --- i.e., dados onde o zero é absoluto.

Para dados apenas intervalares, o uso do CV pode levar a conclusões absurdas, como você terá chance de ver no exercício.

\end{rmdcaution}

\hypertarget{exercuxedcios-11}{%
\subsection{Exercícios}\label{exercuxedcios-11}}

\begin{itemize}
\item
  Considere o seguinte conjunto de temperaturas (em graus Celsius):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{celsius }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{40}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  E as {\hl{mesmas temperaturas}} (em graus Fahrenheit):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fahrenheit }\OtherTok{\textless{}{-}} \DecValTok{9} \SpecialCharTok{*}\NormalTok{ celsius }\SpecialCharTok{/} \DecValTok{5} \SpecialCharTok{+} \DecValTok{32}
\end{Highlighting}
\end{Shaded}
\item
  Calcule para cada um dos dois vetores acima:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    A média,
  \item
    O desvio-padrão,
  \item
    O coeficiente de variação.
  \end{enumerate}
\item
  As temperaturas são as mesmas (apenas em unidades diferentes), mas os CVs são diferentes. Por quê?
\item
  Agora, convertemos as {\hl{mesmas temperaturas}} para \href{https://pt.wikipedia.org/wiki/Kelvin}{a escala Kelvin}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kelvin }\OtherTok{\textless{}{-}}\NormalTok{ celsius }\SpecialCharTok{+} \FloatTok{273.15}
\end{Highlighting}
\end{Shaded}
\item
  E para a \href{https://pt.wikipedia.org/wiki/Rankine}{escala Rankine}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rankine }\OtherTok{\textless{}{-}}\NormalTok{ fahrenheit }\SpecialCharTok{+} \FloatTok{459.67}
\end{Highlighting}
\end{Shaded}
\item
  Calcule para cada um dos dois vetores acima:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    A média,
  \item
    O desvio-padrão,
  \item
    O coeficiente de variação.
  \end{enumerate}
\item
  Compare:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    As médias de \texttt{celsius} e \texttt{kelvin},
  \item
    As médias de \texttt{fahrenheit} e \texttt{rankine},
  \item
    Os desvios-padrão de \texttt{celsius} e \texttt{kelvin},
  \item
    Os desvios-padrão de \texttt{fahrenheit} e \texttt{rankine},
  \item
    Os coeficientes de variação de \texttt{kelvin} e \texttt{rankine}.
  \end{enumerate}
\item
  Explique o que houve.
\end{itemize}

\hypertarget{escores-padruxe3o}{%
\section{Escores-padrão}\label{escores-padruxe3o}}

\begin{itemize}
\item
  Para qualquer conjunto de dados, {\hl{a unidade usada é uma escolha arbitrária}}.
\item
  Para alturas, por exemplo, podemos usar metros, centímetros, pés, polegadas etc.
\item
  A escolha de unidades é tão arbitrária que podemos escolher uma unidade (que dificilmente vai ter nome) que faça com que {\hl{a média do conjunto de dados seja zero}} e que {\hl{o desvio-padrão seja igual a $1$}}.
\item
  Isto equivale a tomar, como unidade, o {\hl{\emph{desvio-padrão acima da média}}}.
\item
  Os valores, nesta nova unidade, são chamados de {\hl{escores-padrão}}.
\item
  Dizemos que os valores foram {\hl{padronizados}}.
\item
  Vamos usar as alturas dos jogadores de basquete.
\item
  {\hl{Para fazer a altura média virar zero, basta subtrair, de cada altura, a altura média:}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alturas }\OtherTok{\textless{}{-}}\NormalTok{ medidas}\SpecialCharTok{$}\NormalTok{altura}
\FunctionTok{mean}\NormalTok{(alturas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1,81875
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alturas\_deslocadas }\OtherTok{\textless{}{-}}\NormalTok{ alturas }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(alturas)}
\FunctionTok{mean}\NormalTok{(alturas\_deslocadas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0
\end{verbatim}
\item
  \protect\hypertarget{dividir-por-sd}{}{} {\hl{Para fazer o desvio-padrão ser igual a $1$, basta dividir estes valores pelo desvio-padrão dos dados originais:}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(alturas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,08602656
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alturas\_padronizadas }\OtherTok{\textless{}{-}}\NormalTok{ alturas\_deslocadas }\SpecialCharTok{/} \FunctionTok{sd}\NormalTok{(alturas)}
\FunctionTok{sd}\NormalTok{(alturas\_padronizadas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
\end{verbatim}
\item
  Tome, por exemplo, o seguinte jogador:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{altura }\OtherTok{\textless{}{-}}\NormalTok{ alturas[}\DecValTok{1}\NormalTok{] }
\NormalTok{altura}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1,8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{altura\_padronizada }\OtherTok{\textless{}{-}}\NormalTok{ (alturas[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(alturas)) }\SpecialCharTok{/} \FunctionTok{sd}\NormalTok{(alturas)}
\NormalTok{altura\_padronizada}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0,217956
\end{verbatim}

  Faça as contas: o valor da altura padronizada deste jogador significa que a altura dele está $0{,}217956$ {\hl{desvios-padrão \emph{abaixo} da altura média}}.
\item
  {\hl{No geral:}}

  \begin{itemize}
  \item
    Se a média for $\bar x$, e
  \item
    Se o desvio-padrão for $s$,
  \item
    Os escores-padrão $z_i$ vão ser
    \[
    z_i = \frac{x_i - \bar x}{s}
    \]
  \end{itemize}
\item
  Em R, a função \texttt{scale} faz isso:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{medidas }\OtherTok{\textless{}{-}}\NormalTok{ medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{altura\_padronizada =} \FunctionTok{scale}\NormalTok{(altura)[,}\DecValTok{1}\NormalTok{])}

\NormalTok{medidas }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(altura, altura\_padronizada)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 12 x 2
##   altura altura_padronizada
##    <dbl>              <dbl>
## 1   1.8              -0.218
## 2   1.85              0.363
## 3   1.7              -1.38 
## 4   1.9               0.944
## 5   1.85              0.363
## 6   1.72             -1.09 
## # i 6 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(medidas}\SpecialCharTok{$}\NormalTok{altura\_padronizada)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0,000000000000000004610683
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(medidas}\SpecialCharTok{$}\NormalTok{altura\_padronizada)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
\end{verbatim}
\item
  A função \texttt{scale} foi feita para receber e retornar {\hl{matrizes}}. Como estamos trabalhando com {\hl{vetores}}, usamos \texttt{scale(altura){[},1{]}} para tomar apenas a primeira (e única) coluna do resultado.
\end{itemize}

\hypertarget{exercuxedcios-12}{%
\subsection{Exercícios}\label{exercuxedcios-12}}

\begin{itemize}
\item
  Por que, \protect\hyperlink{dividir-por-sd}{quando calculamos as alturas deslocadas divididas pelo desvio-padrão das alturas}, temos certeza de que a média dos valores resultantes não mudou?
\item
  Padronize os pesos dos jogadores de basquete.
\item
  Confira a média e o desvio-padrão dos pesos padronizados.
\item
  Crie um \emph{scatterplot} de peso por altura.
\item
  Crie um \emph{scatterplot} de peso padronizado por altura padronizada.
\item
  Compare os dois \emph{scatterplots}. O que muda de um para outro?
\end{itemize}

\hypertarget{teorema-de-tchebychev}{%
\section{Teorema de Tchebychev}\label{teorema-de-tchebychev}}

\begin{itemize}
\item
  Grosso modo, {\hl{quanto mais alto o desvio-padrão, maior é a distância da média até os valores}}.
\item
  Ou seja, {\hl{quanto menor o desvio-padrão, maior é a proporção de valores que estão próximos à média}}.
\item
  O teorema de Tchebychev quantifica esta idéia:

  Em {\hl{\emph{qualquer}}} distribuição, a proporção de valores {\hl{dentro de $\pm k$ desvios-padrão $(k > 1)$ da média}} é de, {\hl{\emph{no mínimo}}}
  \[
  1 - \frac{1}{k^2}
  \]
\end{itemize}

\hypertarget{exemplo-2}{%
\subsection{Exemplo}\label{exemplo-2}}

\begin{itemize}
\item
  Lembre-se do \protect\hyperlink{mamiferos}{conjunto de dados sobre os totais de horas de sono de diversos mamíferos}:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/msleep-hist-1} \end{center}
\item
  Média e desvio-padrão:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{media }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{value)}
\NormalTok{media}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10,43373
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dp }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{value)}
\NormalTok{dp}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4,450357
\end{verbatim}
\item
  Qual a proporção de espécies que estão a $1{,}3$ ou menos desvios-padrão de distância da média?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{k }\OtherTok{\textless{}{-}} \FloatTok{1.3}
\NormalTok{inicio }\OtherTok{\textless{}{-}}\NormalTok{ media }\SpecialCharTok{{-}}\NormalTok{ k }\SpecialCharTok{*}\NormalTok{ dp}
\NormalTok{inicio}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4,648271
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fim }\OtherTok{\textless{}{-}}\NormalTok{ media }\SpecialCharTok{+}\NormalTok{ k }\SpecialCharTok{*}\NormalTok{ dp}
\NormalTok{fim}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16,2192
\end{verbatim}
\item
  O teorema diz que no mínimo a seguinte proporção das espécies está dentro deste intervalo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{proporcao\_teorema }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ k}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{proporcao\_teorema}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,408284
\end{verbatim}
\item
  Graficamente:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-263-1} \end{center}
\item
  Vamos conferir:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total\_especies }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\NormalTok{total\_especies}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 83
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{especies\_intervalo }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(value }\SpecialCharTok{\textgreater{}=}\NormalTok{ inicio }\SpecialCharTok{\&}\NormalTok{ value }\SpecialCharTok{\textless{}=}\NormalTok{ fim) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{nrow}\NormalTok{()}
\NormalTok{especies\_intervalo}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 64
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{proporcao\_real }\OtherTok{\textless{}{-}}\NormalTok{ especies\_intervalo }\SpecialCharTok{/}\NormalTok{ total\_especies}
\NormalTok{proporcao\_real}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,7710843
\end{verbatim}
\item
  Como o teorema usa apenas a média e o desvio-padrão, e {\hl{mais nenhuma informação sobre a distribuição dos valores}} --- forma, simetria etc. --- o que ele garante é, muitas vezes, mais fraco do que a realidade.
\item
  Neste exemplo, o teorema garantia {\hl{no mínimo}} $40{,}83\%$ das espécies a $1{,}30$ ou menos desvios-padrão de distância da média.
\item
  A proporção verdadeira é $77{,}11\%$ das espécies.
\item
  O teorema está certo (claro), mas, sem mais informações sobre a distribuição dos dados, o teorema não pode ser mais preciso.
\end{itemize}

\hypertarget{exercuxedcio-2}{%
\subsection{Exercício}\label{exercuxedcio-2}}

\begin{itemize}
\item
  Uma loja recebe uma média de $20$ clientes por dia, com desvio-padrão de $2$ clientes.
\item
  Em um ano ($365$ dias), em quantos dias, no mínimo, o número de clientes ficou entre $16$ e $24$, inclusive?
\end{itemize}

\hypertarget{probs}{%
\chapter{Probabilidades}\label{probs}}

\hypertarget{vuxeddeo-1-4}{%
\section{Vídeo 1}\label{vuxeddeo-1-4}}

\begin{center} \url{https://youtu.be/hJfyzRzEs44} \end{center}

\hypertarget{espauxe7o-amostral}{%
\section{Espaço amostral}\label{espauxe7o-amostral}}

\begin{itemize}
\item
  Para falar em probabilidades, precisamos falar de {\hl{experimentos, resultados, espaços amostrais, e eventos}}.
\item
  Um {\hl{experimento probabilístico}} é um experimento cujo resultado exato é desconhecido \emph{a priori}; mais ainda: {\hl{executar o experimento diversas vezes, nas mesmas condições, pode produzir resultados diferentes}}.
\item
  O {\hl{espaço amostral}} é o conjunto de {\hl{todos os resultados possíveis}} de um experimento probabilístico, representados de alguma forma.
\item
  Exemplos:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Experimento: lançar uma moeda;\\
    Espaço amostral: $\{ K, C \}$ (onde $K$ é cara, $C$ é coroa).
  \item
    Experimento: lançar $2$ moedas;\\
    Espaço amostral: $\{ (K,K), (K,C), (C,K), (C,C) \}$.
  \item
    Experimento: lançar um dado;\\
    Espaço amostral: $\{ 1, 2, 3, 4, 5, 6 \}$.
  \item
    Experimento: lançar $2$ dados:\\
    Espaço amostral: $\{ (1, 1), (1, 2), \ldots, (6, 5), (6, 6) \}$.
  \end{enumerate}
\end{itemize}

\hypertarget{evento}{%
\section{Evento}\label{evento}}

\begin{itemize}
\item
  Um {\hl{evento}} é um subconjunto do espaço amostral; ou seja, um evento é um {\hl{conjunto de resultados}}.
\item
  Exemplos:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Lançar uma moeda e {\hl{obter cara}}:\\
    $\{ K \}$.
  \item
    Lançar 2 moedas e {\hl{obter resultados iguais}}:\\
    $\{ (K,K), (C,C) \}$.
  \item
    Lançar um dado e {\hl{obter um número maior que 4}}:\\
    $\{ 5, 6 \}$.
  \item
    Lançar 2 dados e {\hl{obter 2 números iguais}}:\\
    $\{ (1,1), (2,2), (3,3), (4,4), (5,5), (6,6) \}$.
  \end{enumerate}
\item
  Dizemos que {\hl{o evento $A$ ocorreu}} se o experimento foi realizado e {\hl{o resultado obtido está no conjunto que corresponde ao evento $A$}}.
\end{itemize}

\hypertarget{anuxe1lise-combinatuxf3ria}{%
\section{Análise Combinatória}\label{anuxe1lise-combinatuxf3ria}}

\begin{itemize}
\item
  Para calcularmos probabilidades, vamos precisar {\hl{contar a quantidade de certos objetos complexos}} (formados por partes menores).
\item
  Existem {\hl{técnicas de contagem}}, que são assunto de {\hl{Análise Combinatória}}.
\item
  Exemplos:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Quantas senhas de $6$ caracteres (dentre letras e dígitos apenas) existem, {\hl{sem distinguir entre minúsculas e maiúsculas}}?

    \begin{comment}


    * O conjunto de letras e dígitos tem $36$ elementos.

    * A resposta é $36^{6} = 2.176.782.336$.


    \end{comment}
  \item
    E se não puder haver repetição de caracteres?

    \begin{comment}


    * Agora, a resposta é
      $$
      36 \cdot 35 \cdot 34 \cdot 33 \cdot 32 \cdot 31 = 1.402.410.240
      $$


    \end{comment}
  \end{enumerate}
\item
  Se você nunca tiver estudado técnicas de contagem, ou se quiser revisar ou aprender mais, consulte o excelente livro Morgado et al. (\protect\hyperlink{ref-morgadoAnaliseCombinatoriaProbabilidade2004}{2004}).
\end{itemize}

\hypertarget{probabilidade-cluxe1ssica}{%
\section{Probabilidade clássica}\label{probabilidade-cluxe1ssica}}

\begin{itemize}
\item
  Nesta abordagem simples --- que pode não ser a correta para o problema que estamos tentando resolver ---, {\hl{cada resultado do espaço amostral tem a mesma chance de ocorrer}}.
\item
  Ou seja, para um evento $A$, a probabilidade $P(A)$ é

  \[
  P(A) = \frac{\text{Qtde de resultados em } A}{\text{Qtde de resultados no espaço amostral}}
  \]
\item
  Exemplo: de um baralho normal, de $52$ cartas, qual a probabilidade de escolher uma carta ao acaso e obter

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Uma carta de ouros?

    \begin{comment}


    $$
    \frac{13}{52} = \frac{1}{4}
    $$


    \end{comment}
  \item
    Uma carta vermelha?

    \begin{comment}


    $$
    \frac{26}{52} = \frac{1}{2}
    $$


    \end{comment}
  \item
    Uma carta de figura (J, Q ou K)?

    \begin{comment}


    $$
    \frac{12}{52} = \frac{3}{13}
    $$


    \end{comment}
  \item
    Uma carta de ouros, copas, paus ou espadas?

    \begin{comment}


    $$
    \frac{52}{52} = 1
    $$


    \end{comment}
  \item
    Um carta de um naipe verde?

    \begin{comment}


    $$
    \frac{0}{52} = 0
    $$


    \end{comment}
  \end{enumerate}

  \begin{rmdcaution}
  Só podemos usar este raciocínio {\hl{se todos os resultados do experimento tiverem a mesma probabilidade}} de ocorrer.

  Como a carta é escolhida {\hl{ao acaso}}, esta condição é satisfeita neste exemplo.

  \end{rmdcaution}
\end{itemize}

\hypertarget{probabilidade-empuxedrica}{%
\section{Probabilidade empírica}\label{probabilidade-empuxedrica}}

\begin{itemize}
\item
  Baseada em {\hl{repetições de um experimento probabilístico}}.
\item
  Nesta abordagem, a probabilidade de um evento é sua {\hl{frequência relativa}}:

  \[
  P(A) = \frac{\text{Qtde de ocorrências de } A}{\text{Qtde total de repetições do experimento}}
  \]
\item
  Esta abordagem é fácil de usar quando é possível repetir o experimento muitas vezes, nas mesmas condições (lançar uma moeda, escolher uma carta de um baralho).
\item
  Em outros casos (calcular a probabilidade de um candidato vencer uma eleição), não é possível repetir o experimento nas mesmas condições.
\item
  Exemplo: se lançarmos uma moeda não-viciada muitas vezes, a proporção de caras vai ser aproximadamente $0{,}5$. Os gráficos abaixo mostram como, à medida que o número de lançamentos aumenta (no eixo horizontal), a proporção de caras (no eixo vertical) vai se aproximando de $0{,}5$:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/lancar-1} \end{center}
\item
  A \href{https://pt.wikipedia.org/wiki/Lei_dos_grandes_n\%C3\%BAmeros}{{\hl{lei dos grandes números}}} é um resultado matemático que diz, essencialmente, que, {\hl{quando o número $n$ de repetições de um experimento tende a infinito, a frequência relativa de um evento tende à sua probabilidade real}}.

  \begin{rmdcaution}
  Um {\hl{erro comum}} é achar que, se houve poucas caras nos lançamentos mais recentes, então a probabilidade de o resultado ser cara no próximo lançamento é maior, para que a proporção de caras fique mais perto de $0{,}5$.

  A lei dos grandes números fala sobre os resultados do experimento quando $n$ tende ao infinito, {\hl{não no futuro próximo}}.

  Em lançamentos {\hl{independentes}} de uma moeda {\hl{não-viciada}}, a probabilidade de cara {\hl{sempre}} é $0{,}5$.

  \end{rmdcaution}
\end{itemize}

\hypertarget{probabilidade-subjetiva}{%
\section{Probabilidade subjetiva}\label{probabilidade-subjetiva}}

\begin{itemize}
\item
  Outra interpretação de probabilidades se baseia na {\hl{crença}} --- a estimativa de um agente sobre a ocorrência de um evento.
\item
  Uma maneira de quantificar a crença é através de {\hl{apostas justas}}.
\item
  Por exemplo, você aposta com um amigo que

  \begin{itemize}
  \item
    Se o seu time de basquete\footnote{Considere que, no basquete, o empate é impossível.} vencer o próximo jogo contra o dele, ele pagará $\$3$ para você.
  \item
    Se o time dele vencer o próximo jogo contra o seu, você pagará $\$1$ para ele.
  \end{itemize}
\item
  Se você considera justa esta aposta, então {\hl{você crê que a probabilidade de o time dele vencer é $3$ vezes maior do que a probabilidade de o seu time vencer}}.
\item
  Como {\hl{a soma das probabilidades de um evento e do evento complementar deve ser $1$}}, isto equivale a dizer que

  \[
  P(\text{seu time vencer}) = 1/4 \qquad\text{e}\qquad  P(\text{time dele vencer}) = 3/4
  \]
\item
  Em mais detalhes:

  \begin{itemize}
  \item
    Você pode receber menos com uma probabilidade maior,
  \item
    Seu amigo pode receber mais com uma probabilidade menor,
  \item
    A razão entre as quantias ($3$) é contrabalançada exatamente pela razão entre as probabilidades ($1/3$).
  \end{itemize}
\end{itemize}

\hypertarget{axiomas}{%
\section{Formalização de probabilidades}\label{axiomas}}

\begin{itemize}
\item
  Para trabalhar matematicamente com probabilidades, é preciso definir as ``regras do jogo''.
\item
  {\hl{Tudo}} que se pode concluir sobre probabilidades é {\hl{consequência dos seguintes axiomas}}, \href{https://pt.wikipedia.org/wiki/Axiomas_de_probabilidade\#Axiomas}{formulados por Kolmogorov em 1933}:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    $0 \leq P(A) \leq 1$, para qualquer evento $A$.
  \item
    $P(\Omega) = 1$, onde $\Omega$ é o espaço amostral (o conjunto de todos os resultados possíveis do experimento em questão);
  \item
    $P(\bar A) = 1 - P(A)$, onde $\bar A$ é o evento {\hl{complementar}} de $A$ (i.e., o evento que corresponde a $A$ {\hl{não}} ocorrer)
  \item
    $P(A_1 \cup \cdots \cup A_n) = P(A_1) + \cdots + P(A_n)$, onde $A_1, \ldots, A_n$ são eventos {\hl{disjuntos dois a dois}} (i.e., $A_i$ e $A_j$ {\hl{não podem ocorrer ao mesmo tempo}}, para todo par $(i, j)$ com $i \neq j$).
  \end{enumerate}
\item
  Mostre, a partir dos axiomas acima, que

  \[
  P(\varnothing) = 0
  \]

  Dica~~\hrulefill 

  \[\varnothing = \bar \Omega \]

  \vspace{-1.5ex} \hrulefill \vspace{1ex}

  \begin{comment}


  $$
  \begin{aligned}
    P(\varnothing) 
    &= P(\bar \Omega) \\
    &= 1 - P(\Omega) & \text{(pelo axioma 3)}\\
    &= 1 - 1 & \text{(pelo axioma 2)} \\
    &= 0
  \end{aligned}
  $$


     \end{comment}
\end{itemize}

\hypertarget{eventos-independentes-explicauxe7uxe3o-informal}{%
\section{Eventos independentes (explicação informal)}\label{eventos-independentes-explicauxe7uxe3o-informal}}

\begin{itemize}
\item
  Se a ocorrência de $A$ {\hl{não influencia}} a ocorrência de $B$, nem vice-versa, dizemos que os eventos $A$ e $B$ são {\hl{independentes}}.
\item
  Exemplo:

  \begin{itemize}
  \item
    O experimento é {\hl{lançar um dado duas vezes}}.
  \item
    $A$ é o evento o {\hl{primeiro lançamento deu um número par}}.
  \item
    $B$ é o evento {\hl{o segundo lançamento deu 6}}.
  \item
    Saber se $A$ aconteceu {\hl{não nos ajuda}} em nada a estimar se $B$ aconteceu.
  \item
    Aqui, {\hl{$A$ e $B$ são independentes}}.
  \end{itemize}
\item
  Outro exemplo:

  \begin{itemize}
  \item
    O experimento é {\hl{lançar um dado duas vezes}}.
  \item
    $A$ é o evento o {\hl{primeiro lançamento deu um número menor que $3$}}.
  \item
    $B$ é o evento {\hl{a soma dos dois lançamentos é maior que $8$}}.
  \item
    Agora, saber se $A$ aconteceu {\hl{ajuda}} a estimar se $B$ aconteceu.
  \item
    Na verdade, {\hl{se $A$ aconteceu, $B$ é impossível}} (a probabilidade de $B$, dado $A$, é $0$).
  \item
    Se $A$ não aconteceu, a probabilidade de $B$ é $5/12$.
  \item
    Aqui, $A$ e $B$ {\hl{não são independentes}}.
  \end{itemize}
\item
  \protect\hypertarget{independentes-produto}{}{} A probabilidade de os eventos $A$ e $B$ acontecerem ao mesmo tempo é escrita como

  \[
  P(A, B) \qquad \text{ou como} \qquad P(A \cap B)
  \]
\item
  Quando $A$ e $B$ são {\hl{independentes}},

  \[
  P(A, B) = P(A) \cdot P(B)
  \]
\item
  Ou seja, {\hl{quando $A$ e $B$ são independentes, a probabilidade de $A$ e $B$ acontecerem ao mesmo tempo é igual ao produto das probabilidades de $A$ e de $B$}}.
\item
  Mais adiante, vamos ver uma definição formal de independência, e vamos provar esta última igualdade.
\end{itemize}

\hypertarget{pa-cup-b-com-a-e-b-nuxe3o-disjuntos}{%
\section{\texorpdfstring{$P(A \cup B)$ com $A$ e $B$ não-disjuntos}{ com  e  não-disjuntos}}\label{pa-cup-b-com-a-e-b-nuxe3o-disjuntos}}

\begin{itemize}
\item
  Um dos \protect\hyperlink{axiomas}{axiomas de probabilidade} fala sobre a probabilidade da união de vários eventos {\hl{disjuntos}} (sem elementos em comum):

  \[
  P(A_1 \cup \cdots \cup A_n) = P(A_1) + \cdots + P(A_n)
  \]
\item
  E {\hl{se os eventos não forem disjuntos}}?
\item
  Veja a figura abaixo:

  ???
\item
  Imagine que a probabilidade de um evento é proporcional à sua área nesta figura.
\item
  Se você somar a área de $A$ com a área de $B$, você vai estar {\hl{contando duas vezes}} a área comum aos dois (a área que corresponde a $A \cap B$).
\item
  Por isso, {\hl{o certo é ``descontar'' esta área}}.
\item
  O resultado é

  \[
  P(A \cup B) = P(A) + P(B) - P(A \cap B)
  \]
\item
  Exemplo: suponha que 25\% das pessoas têm cachorro, 29\% das pessoas têm gato, e 12\% das pessoas têm cachorro e gato.
\item
  Qual a probabilidade de que uma pessoa tenha gato ou cachorro ou ambos?

  \[
  \begin{aligned}
  P(\text{cachorro } \cup \text{ gato}) 
    &= P(\text{cachorro}) + P(\text{gato}) - P(\text{cachorro } \cap \text{ gato}) \\
    &= 0{,}25 + 0{,}29 - 0{,}12 \\
    &= 0{,}42
  \end{aligned}
  \]
\item
  No geral, para $n$ eventos $A_1, \ldots, A_n$:

  \[
  \begin{aligned}
  P(A_1 \cup \cdots \cup A_n) &=
    P(A_1) + \cdots + P(A_n) \\
    & - P(A_1 \cap A_2) - \cdots - P(A_{n-1} \cap A_n) \\
    & + P(A_1 \cap A_2 \cap A_3) + \cdots + P(A_{n-2} \cap A_{n-1} \cap A_n) \\
    & \cdots \\
    & \pm P(A_1 \cap \cdots \cap A_n )
  \end{aligned}
  \]
\item
  Na última linha

  \begin{itemize}
  \item
    o sinal vai ser $+$ se $n$ for ímpar;
  \item
    o sinal vai ser $-$ se $n$ for par;
  \item
    poderíamos escrever, então, $(-1)^{n+1} \cdot P(A_1 \cap \cdots \cap A_n )$.
  \end{itemize}
\item
  Escreva, seguindo o padrão acima, a expressão para

  \[
  P(A \cup B \cup C)
  \]

  \begin{comment}


  $$
  \begin{aligned}
  P(A \cup B \cup C) &=
    P(A) + P(B) + P(C) \\
    & - P(A \cap B) - P(A \cap C) - P(B \cap C) \\
    & + P(A \cap B \cap C)
  \end{aligned}
  $$


     \end{comment}
\end{itemize}

\hypertarget{problema-do-aniversuxe1rio}{%
\section{Problema do aniversário}\label{problema-do-aniversuxe1rio}}

\hypertarget{soluuxe7uxe3o-teuxf3rica}{%
\subsection{Solução teórica}\label{soluuxe7uxe3o-teuxf3rica}}

\begin{itemize}
\item
  Em uma sala estão $25$ pessoas escolhidas ao acaso.
\item
  {\hl{Qual a probabilidade de que pelo menos $2$ delas façam aniversário no mesmo dia do ano?}}
\item
  Premissas:

  \begin{itemize}
  \item
    Os dias dos aniversários das pessoas são independentes.
  \item
    Cada dia do ano tem a mesma probabilidade de ser o aniversário de alguém.
  \item
    Vamos ignorar anos bissextos. Cada ano tem 365 dias.
  \end{itemize}
\item
  Queremos achar $P(I)$, onde $I$ é o evento de que pelo menos duas pessoas têm aniversários iguais.
\item
  Vamos calcular a probabilidade $P(N)$ de que {\hl{não}} haja aniversários iguais.
\item
  Este evento $N$ é o complementar do evento $I$, i.e., $N = \bar I$.
\item
  Então, $P(I) = 1 - P(N)$.
\item
  $P(N)$ é a probabilidade de que todos os aniversários caiam em dias diferentes:

  \begin{itemize}
  \item
    A pessoa $1$ pode ter nascido em qualquer dia do ano.
  \item
    A pessoa $2$ precisa ter nascido em algum dos outros $364$ dias. A probabilidade é $\frac{364}{365}$.
  \item
    A pessoa $3$ precisa ter nascido em algum dos outros $363$ dias. A probabilidade é $\frac{363}{365}$.
  \item
    $\ldots$
  \item
    A pessoa $25$ precisa ter nascido em algum dos outros $341$ dias. A probabilidade é $\frac{341}{365}$.
  \end{itemize}
\item
  \protect\hyperlink{independentes-produto}{Como os nascimentos são independentes}, a probabilidade de todos os eventos acontecerem juntos é o produto das probabilidades:

  \[
  P(N) = \frac{364}{365} \cdot \frac{363}{365} \cdot \cdots \cdot
         \frac{341}{365}
       = \frac{364 \cdot 363 \cdot \cdots \cdot 341}{365^{24}}
  \]
\item
  O que dá

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pn }\OtherTok{\textless{}{-}} \FunctionTok{prod}\NormalTok{((}\DecValTok{364}\SpecialCharTok{:}\DecValTok{341}\NormalTok{)}\SpecialCharTok{/}\DecValTok{365}\NormalTok{)}
\NormalTok{pn}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,4313003
\end{verbatim}
\item
  Então, $P(I)$ é

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ pn}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,5686997
\end{verbatim}
\item
  Surpreso? Com $25$ pessoas na sala, é mais provável haver do que não haver coincidência de aniversários!
\end{itemize}

\hypertarget{simulauxe7uxe3o}{%
\subsection{Simulação}\label{simulauxe7uxe3o}}

\begin{itemize}
\item
  Vamos simular milhares de salas com $25$ pessoas satisfazendo as \protect\hyperlink{premissas}{premissas} e ver em quantas delas há coincidência de aniversários. Examine o código abaixo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nsalas }\OtherTok{\textless{}{-}} \FloatTok{1e4}
\NormalTok{npessoas }\OtherTok{\textless{}{-}} \DecValTok{25}

\NormalTok{coincidencia }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(sala) \{}

  \CommentTok{\# Se a quantidade de valores únicos for diferente }
  \CommentTok{\# da quantidade total de valores, então há repetição  }
  \SpecialCharTok{!}\NormalTok{(}\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(sala)) }\SpecialCharTok{==} \FunctionTok{length}\NormalTok{(sala))}

\NormalTok{\}}

\NormalTok{gerar\_e\_testar }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(npessoas) \{}

  \CommentTok{\# Escolhemos, ao acaso, npessoas números entre 1 e 365,}
  \CommentTok{\# com reposição}
\NormalTok{  sala }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{365}\NormalTok{, npessoas, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}

  \CommentTok{\# Testamos se há alguma coincidência de aniversários}
  \FunctionTok{coincidencia}\NormalTok{(sala)}

\NormalTok{\}}

\NormalTok{simular }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(npessoas, nsalas) \{}

\NormalTok{  resultados }\OtherTok{\textless{}{-}} \FunctionTok{replicate}\NormalTok{(nsalas, }\FunctionTok{gerar\_e\_testar}\NormalTok{(npessoas))}

  \CommentTok{\# Como resultados é um vetor booleano, tirar a média}
  \CommentTok{\# vai dar a proporção de resultados verdadeiros,}
  \CommentTok{\# que é a probabilidade.}
  \FunctionTok{mean}\NormalTok{(resultados)}

\NormalTok{\}}

\FunctionTok{simular}\NormalTok{(npessoas, nsalas)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,5666
\end{verbatim}
\end{itemize}

\hypertarget{para-diferentes-valores-de-n-in-2-3-ldots-50}{%
\subsection{\texorpdfstring{Para diferentes valores de $n \in \{2, 3, \ldots, 50\}$}{Para diferentes valores de }}\label{para-diferentes-valores-de-n-in-2-3-ldots-50}}

\hypertarget{soluuxe7uxf5es-teuxf3ricas}{%
\subsubsection*{Soluções teóricas}\label{soluuxe7uxf5es-teuxf3ricas}}
\addcontentsline{toc}{subsubsection}{Soluções teóricas}

\begin{itemize}
\item
  Vamos calcular as probabilidades de coincidência para diferentes quantidades $n$ de pessoas na sala e fazer um gráfico:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{npessoas }\OtherTok{\textless{}{-}} \DecValTok{2}\SpecialCharTok{:}\DecValTok{50}

\NormalTok{p }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(n) \{}

  \CommentTok{\# Fórmula geral, para n pessoas}
  \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{prod}\NormalTok{((}\DecValTok{364}\SpecialCharTok{:}\NormalTok{(}\DecValTok{366} \SpecialCharTok{{-}}\NormalTok{ n))}\SpecialCharTok{/}\DecValTok{365}\NormalTok{)}

\NormalTok{\}}

\NormalTok{probs }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(npessoas, p)}

\NormalTok{grafico }\OtherTok{\textless{}{-}}\NormalTok{ probs }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_tibble}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ npessoas, }\AttributeTok{y =}\NormalTok{ value)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Probabilidades de coincidência com n pessoas\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \ConstantTok{NULL}\NormalTok{,}
      \AttributeTok{x =} \StringTok{\textquotesingle{}n\textquotesingle{}}
\NormalTok{    )}

\NormalTok{grafico}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/n-teorico-1} \end{center}
\item
  Este problema é tão usado em cursos de probabilidade que o R oferece as funções \texttt{pbirthday} e \texttt{qbirthday}.
\item
  Leia a ajuda de \texttt{pbirthday} e recrie o gráfico acima usando esta função.
\item
  Leia a ajuda de \texttt{qbirthday} e responda:

  \begin{itemize}
  \item
    Quantas pessoas são necessárias para que a probabilidade de uma ou mais coincidências seja de pelo menos $50\%$?

    \begin{comment}


    Os valores *default* dos argumentos resolvem este problema:


    ```r
    qbirthday()
    ```

    ```
    ## [1] 23
    ```


     \end{comment}
  \item
    Quantas pessoas são necessárias para que a probabilidade de uma ou mais coincidências seja de pelo menos $90\%$?

    \begin{comment}



    ```r
    qbirthday(.9)
    ```

    ```
    ## [1] 41
    ```


     \end{comment}
  \item
    Quantas pessoas são necessárias para que haja uma probabilidade de pelo menos $50\%$ de que $5$ ou mais pessoas façam aniversário no mesmo dia?

    \begin{comment}



    ```r
    qbirthday(coincident = 5)
    ```

    ```
    ## [1] 313
    ```


     \end{comment}
  \end{itemize}
\end{itemize}

\hypertarget{simulauxe7uxe3o-1}{%
\subsubsection*{Simulação}\label{simulauxe7uxe3o-1}}
\addcontentsline{toc}{subsubsection}{Simulação}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nsalas }\OtherTok{\textless{}{-}} \FloatTok{1e3}
\NormalTok{npessoas }\OtherTok{\textless{}{-}} \DecValTok{2}\SpecialCharTok{:}\DecValTok{50}

\NormalTok{probs\_sim }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(npessoas, simular, nsalas)}

\NormalTok{grafico }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}
    \AttributeTok{data =} \FunctionTok{as\_tibble}\NormalTok{(probs\_sim),}
    \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ value),}
    \AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{subtitle =} \StringTok{\textquotesingle{}(teóricas em azul, simulações em vermelho)\textquotesingle{}}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/n-simul-1} \end{center}

\hypertarget{premissas-mais-realistas}{%
\subsection{Premissas mais realistas}\label{premissas-mais-realistas}}

\begin{itemize}
\item
  {\hl{Vamos considerar anos bissextos}}. O total de dias muda para $366$, mas um dos dias ($29$ de fevereiro) tem $1/4$ da probabilidade de um dia normal de ser o aniversário de alguém.
\item
  {\hl{Além disso}}, vamos supor que haja $165$ dias em que a probabilidade de alguém nascer é $25\%$ maior do que nos $200$ dias normais.
\item
  A solução teórica é bem mais complexa do que no caso uniforme!
\item
  Vamos fazer apenas a simulação.
\item
  Preste atenção no vetor \texttt{pesos}, que representam as probabilidades de dias diferentes:

  \begin{itemize}
  \item
    $200$ dias normais têm peso $4$;
  \item
    $165$ dias mais prováveis têm peso $5$;
  \item
    $1$ dia ($29$ de fevereiro) tem peso $1$.
  \end{itemize}
\item
  {\hl{Estes pesos não são probabilidades, porque a soma deles não é $1$}}.
\item
  A função \texttt{sample} {\hl{normaliza}} automaticamente estes pesos.
\item
  Normalizar significa dividir todos os valores pela mesma constante, de forma que a soma seja $1$.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nsalas }\OtherTok{\textless{}{-}} \FloatTok{1e3}
\NormalTok{npessoas }\OtherTok{\textless{}{-}} \DecValTok{2}\SpecialCharTok{:}\DecValTok{50}

\NormalTok{pesos }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \FunctionTok{rep}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{200}\NormalTok{),    }\CommentTok{\# dias normais}
  \FunctionTok{rep}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{165}\NormalTok{),    }\CommentTok{\# dias mais prováveis}
  \DecValTok{1}               \CommentTok{\# 29 de fevereiro}
\NormalTok{)}

\NormalTok{gerar\_e\_testar }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(npessoas, pesos) \{}

\NormalTok{  sala }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{366}\NormalTok{, npessoas, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{prob =}\NormalTok{ pesos)}
  \FunctionTok{coincidencia}\NormalTok{(sala)}

\NormalTok{\}}

\NormalTok{simular }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(npessoas, nsalas, pesos) \{}

\NormalTok{  resultados }\OtherTok{\textless{}{-}} \FunctionTok{replicate}\NormalTok{(nsalas, }\FunctionTok{gerar\_e\_testar}\NormalTok{(npessoas, pesos))}
  \FunctionTok{mean}\NormalTok{(resultados)}

\NormalTok{\}}

\NormalTok{novas\_probs }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(npessoas, simular, nsalas, pesos)}

\NormalTok{grafico }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}
    \AttributeTok{data =} \FunctionTok{as\_tibble}\NormalTok{(novas\_probs),}
    \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ value),}
    \AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}
      \StringTok{\textquotesingle{}(teóricas, premissas originais: azul;\textquotesingle{}}\NormalTok{, }
      \StringTok{\textquotesingle{}simulações, novas premissas: vermelho)\textquotesingle{}}
\NormalTok{    )}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/premissas-real-1} \end{center}
\item
  As novas premissas não mudaram muita coisa.
\item
  Escreva a versão normalizada do vetor \texttt{pesos}.

  \begin{comment}


  O vetor original é

  $$
  (
  \underbrace{4, \ldots, 4}_{200\text{ vezes}},\;\; 
  \underbrace{5, \ldots, 5}_{165\text{ vezes}},\;\;
  1
  )
  $$

  A soma de todos os elementos é 

  $$
  200 \cdot 4 + 165 \cdot 165 + 1 = 1.626
  $$

  O vetor normalizado fica

  $$
  \left(
  \underbrace{\frac4{1626}, \ldots, \frac4{1626}}_{200\text{ vezes}},\;\; 
  \underbrace{\frac5{1626}, \ldots, \frac5{1626}}_{165\text{ vezes}},\;\; 
  \frac1{1626}
  \right)
  $$

  ou

  $$
  \left(
  \underbrace{\frac2{813}, \ldots, \frac2{813}}_{200\text{ vezes}},\;\; 
  \underbrace{\frac5{1626}, \ldots, \frac5{1626}}_{165\text{ vezes}},\;\; 
  \frac1{1626}
  \right)
  $$


     \end{comment}
\end{itemize}

\hypertarget{exercuxedcios-13}{%
\section{Exercícios}\label{exercuxedcios-13}}

\hypertarget{semanas-com-mais-nascimentos}{%
\subsection{Semanas com mais nascimentos}\label{semanas-com-mais-nascimentos}}

\begin{itemize}
\item
  Imagine que $50\%$ dos nascimentos de um ano aconteçam em um período de $15$ semanas, e o restante dos nascimentos seja distribuído de maneira uniforme no restante do ano. Ignore anos bissextos.
\item
  Faça simulações como na seção anterior ($2 \leq n \leq 50$) e construa o gráfico comparando com as probabilidades teóricas (com as premissas originais).
\item
  Interprete o resultado.

  \begin{comment}


  * $15$ semanas são $105$ dias.

  * O restante do ano tem $260$ dias.


    ```r
    nsalas <- 1e4
    npessoas <- 2:50

    # Probabilidades teóricas, premissas originais
    p <- function(n) {

      1 - prod((364:(366 - n))/365)

    }

    probs <- sapply(npessoas, p)

    grafico <- probs %>% 
      as_tibble() %>% 
      ggplot(aes(x = npessoas, y = value)) +
        geom_line(color = 'blue') +
        labs(
          title = 'Probabilidades de coincidência com n pessoas',
          y = NULL,
          x = 'n'
        )

    # Probabilidades com 15 semanas com 50% dos nascimentos
    pesos <- c(
      rep(50/105, 105),    # dias das semanas com mais nascimentos
      rep(50/260, 260)     # dias das semanas normais
    )

    coincidencia <- function(sala) {

      !(length(unique(sala)) == length(sala))

    }

    gerar_e_testar <- function(npessoas, pesos) {

      sala <- sample(1:365, npessoas, replace = TRUE, prob = pesos)
      coincidencia(sala)

    }

    simular <- function(npessoas, nsalas, pesos) {

      resultados <- replicate(nsalas, gerar_e_testar(npessoas, pesos))
      mean(resultados)

    }

    novas_probs <- sapply(npessoas, simular, nsalas, pesos)

    grafico +
      geom_line(
        data = as_tibble(novas_probs),
        mapping = aes(y = value),
        color = 'red'
      ) +
      labs(
        subtitle = paste(
          '(teóricas com premissas originais: azul;', 
          'simulações com novas premissas: vermelho)'
        )
      )
    ```



    \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unnamed-chunk-272-1} \end{center}

  * Com as novas premissas, a probabilidade de coincidência é maior para quase todos os valores de $n$: a linha vermelha está acima da linha azul.

  * Como metade dos nascimentos está concentrada nas $15$ semanas, a probabilidade de haver coincidência para $n$ pessoas é maior do que com as premissas originais. 


     \end{comment}
\end{itemize}

\hypertarget{puxf4quer}{%
\subsection{Pôquer}\label{puxf4quer}}

\begin{itemize}
\item
  Uma mão de pôquer consiste de $5$ cartas retiradas ao acaso de um baralho de $32$ cartas ($4$ naipes, cada um com cartas 7, 8, 9, 10, J, Q, K, A).
\item
  Calcule as seguintes probabilidades teoricamente e através de simulações.

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Qual a probabilidade de obter uma mão sem ases?

    \begin{comment}


    * A ordem das cartas não importa.

    * Basta calcular o número de mãos possíveis usando as $28$ cartas que  não são ases:

      $$
      {28 \choose 5} = 98.280
      $$

    * E dividir pelo total de mão possíveis:

      $$
      {32 \choose 5} = 201.376
      $$

    * O resultado é aproximadamente $0{,}49$.

    * Criando as cartas:


      ```r
      baralho <- expand_grid(
        numero = c(7:10, 'J', 'Q', 'K', 'A'),
        naipe = c('♥', '♦', '♣', '♠')
      ) %>% 
        mutate(carta = paste(numero, naipe)) %>% 
        pull(carta)
      ```

    * Função para gerar uma mão:


      ```r
      mao <- function(){
        sample(baralho, size = 5)
      }
      ```

    * Testar se a mão tem (pelo menos) um ás:


      ```r
      tem_as <- function(mao) {

        any(str_starts(mao, 'A'))

      }
      ```

    * Simulação:


      ```r
      nsim <- 1e6
      maos <- rerun(nsim, mao())
      ```

      ```
      ## Warning: `rerun()` was deprecated in purrr 1.0.0.
      ## i Please use `map()` instead.
      ##   # Previously
      ##   rerun(1000000, mao())
      ## 
      ##   # Now
      ##   map(1:1000000, ~ mao())
      ## This warning is displayed once every 8 hours.
      ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.
      ```

      ```r
      mean(!map_lgl(maos, tem_as))
      ```

      ```
      ## [1] 0,488225
      ```


    \end{comment}
  \item
    Qual a probabilidade de obter $4$ ases?

    \begin{comment}


    * A ordem das cartas não importa.

    * Existe uma mão com $4$ ases para cada uma das outras $28$ cartas. Ou seja, existem $28$ mãos com $4$ ases.

    * Logo, a resposta é 

      $$
      \frac{28}{\binom{32}{5}} = 
      \frac{28}{201.376} \approx 0{,}000139
      $$

    * Uma probabilidade de pouco mais de [um décimo de milésimo]{.hl}.

    * Testar se a mão tem $4$ ases:


      ```r
      tem_4_ases <- function(mao) {

        sum(str_starts(mao, 'A')) == 4

      }
      ```

    * Simular (usando as mesmas mãos geradas na resposta anterior):


      ```r
      mean(map_lgl(maos, tem_4_ases))
      ```

      ```
      ## [1] 0,000125
      ```


    \end{comment}
  \item
    Qual a probabilidade de obter uma sequência (7 a J, 8 a Q, 9 a K, ou 10 a A) de naipes quaisquer?

    \begin{comment}


    * São $4$ possibilidades para o primeiro número da sequência (7, 8, 9, 10).

    * Cada uma das $5$ cartas pode ter um de $4$ naipes, dando $4^5$      possibilidades.

    * Então, existem $4 \cdot 4^5 = 4^6 = 4.096$ sequências.

    * A resposta é 

      $$
      \frac{4.096}{\binom{32}{5}} =
      \frac{4.096}{201.376} 
      \approx 0{,}020340
      $$

    * Testar se a mão tem sequência:


      ```r
      tem_seq <- function(mao) {

        all(c(7, 8, 9, 1, 'J') %in% str_sub(mao, 1, 1)) ||
        all(c(8, 9, 1, 'J', 'Q') %in% str_sub(mao, 1, 1)) ||
        all(c(9, 1, 'J', 'Q', 'K') %in% str_sub(mao, 1, 1)) ||
        all(c(1, 'J', 'Q', 'K', 'A') %in% str_sub(mao, 1, 1))

      }
      ```

    * Simular (usando as mesmas mãos geradas na primeira resposta):


      ```r
      mean(map_lgl(maos, tem_seq))
      ```

      ```
      ## [1] 0,020403
      ```


    \end{comment}
  \item
    Qual a probabilidade de obter uma sequência (7 a J, 8 a Q, 9 a K, ou 10 a A) do mesmo naipe?

    \begin{comment}


    * Cada naipe tem $4$ sequências possíveis.

    * O total de sequências do mesmo naipe, então, é $4 \cdot 4 = 16$.

    * A resposta é

      $$
      \frac{16}{\binom{32}{5}} = 
      \frac{16}{201.376} \approx
      0{,}000079
      $$

    * [É mais improvável obter uma sequência do mesmo naipe do que obter $4$ ases.]{.hl}

    * Testar se a mão tem sequência do mesmo naipe:


      ```r
      tem_seq_naipe <- function(mao) {

        tem_seq(mao) && (
          all(str_ends(mao, '♥')) ||
          all(str_ends(mao, '♦')) ||
          all(str_ends(mao, '♠')) ||
          all(str_ends(mao, '♣'))
        )

      }
      ```

    * Simular:


      ```r
      mean(map_lgl(maos, tem_seq_naipe))
      ```

      ```
      ## [1] 0,000067
      ```


    \end{comment}
  \end{enumerate}
\end{itemize}

\hypertarget{dados}{%
\subsection{Dados}\label{dados}}

\begin{itemize}
\item
  Calcule as seguintes probabilidades teoricamente e através de simulações.

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Você lança um dado não-viciado $6$ vezes. Qual a probabilidade de que saiam os $6$ números?
  \item
    Idem, se você lançar o dado $10$ vezes.
  \end{enumerate}
\end{itemize}

\hypertarget{vuxeddeo-2-3}{%
\section{Vídeo 2}\label{vuxeddeo-2-3}}

\begin{center} \url{https://youtu.be/NVP-MwtGp0Q} \end{center}

\hypertarget{probabilidade-condicional}{%
\section{Probabilidade condicional}\label{probabilidade-condicional}}

\begin{itemize}
\item
  {\hl{Em um mesmo experimento, saber que um evento $B$ aconteceu pode dar informação sobre um outro evento $A$.}}
\item
  Por exemplo, ao lançar um dado, a probabilidade de $A$ --- {\hl{conseguir um $6$}} --- é de $1/6$.
\item
  Se formos informados que o evento $B$ --- {\hl{o lançamento deu um número maior que $3$}} --- ocorreu, então a probabilidade de ter conseguido um $6$ passa para $1/3$.
\item
  Escrevemos

  \[
  P(A) = 1/6
  \]

  e

  \[
  P(A \mid B) = 1/3
  \]
\item
  $P(A \mid B)$ é a {\hl{probabilidade de $A$ ocorrer, dado que $B$ ocorreu}}.
\item
  É uma probabilidade {\hl{condicional}}. Estamos {\hl{condicionando sobre $B$}}.
\end{itemize}

\hypertarget{exemplo-titanic}{%
\subsection{Exemplo: Titanic}\label{exemplo-titanic}}

\begin{itemize}
\item
  A seguinte tabela mostra as quantidades de pessoas no Titanic, categorizadas como sobreviventes ou não, e divididas pela classe:

\begin{verbatim}
##           Classe
## Sobreviveu    1    2    3 Tripulação Total
##      Não    122  167  528        673  1490
##      Sim    203  118  178        212   711
##      Total  325  285  706        885  2201
\end{verbatim}
\end{itemize}

\hypertarget{probabilidade-de-ser-tripulante}{%
\subsubsection*{Probabilidade de ser tripulante}\label{probabilidade-de-ser-tripulante}}
\addcontentsline{toc}{subsubsection}{Probabilidade de ser tripulante}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{ser um tripulante}}?
\item
  Esta é uma probabilidade {\hl{não-condicional}}: basta dividir o total de tripulantes pelo total de pessoas:

  \[
  P(\text{tripulante}) = 
  \frac
  {885}
  {2.201}
  \]
\item
  A tabela está na variável \texttt{tit\_tab}. Em R, podemos indexar uma tabela pelos nomes. O primeiro índice corresponde à linha, o segundo à coluna:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ptrip }\OtherTok{\textless{}{-}} 
\NormalTok{  tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Tripulação\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}

\NormalTok{ptrip}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,40209
\end{verbatim}
\end{itemize}

\hypertarget{probabilidade-de-nuxe3o-ser-tripulante}{%
\subsubsection*{Probabilidade de não ser tripulante}\label{probabilidade-de-nuxe3o-ser-tripulante}}
\addcontentsline{toc}{subsubsection}{Probabilidade de não ser tripulante}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{não ser um tripulante}}?
\item
  Esta é uma probabilidade {\hl{não-condicional}}: basta dividir o total de não-tripulantes pelo total de pessoas:

  \[
  P(\text{não-tripulante}) = 
  \frac
  {325 + 285 + 706}
  {2.201}
  \]
\item
  Em R, podemos selecionar várias células de uma tabela; basta usar um vetor como índice:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ntrip }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}2\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}3\textquotesingle{}}\NormalTok{)])}

\NormalTok{ntrip }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,59791
\end{verbatim}
\item
  Mas nem era preciso fazer este cálculo. Basta perceber que ``ser tripulante'' e ``ser não-tripulante'' são {\hl{eventos complementares}}. Daí,

  \[
  P(\text{não-tripulante}) = 1 - P(\text{tripulante})
  \]

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ ptrip}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,59791
\end{verbatim}
\end{itemize}

\hypertarget{probabilidade-de-sobreviver}{%
\subsubsection*{Probabilidade de sobreviver}\label{probabilidade-de-sobreviver}}
\addcontentsline{toc}{subsubsection}{Probabilidade de sobreviver}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{ter sobrevivido}}?
\item
  Esta é uma probabilidade {\hl{não-condicional}}: basta dividir o total de sobreviventes pelo total de pessoas:

  \[
  P(\text{sobrevivente}) = 
  \frac
  {711}
  {2.201}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,323035
\end{verbatim}
\end{itemize}

\hypertarget{probabilidade-de-ser-de-primeira-classe}{%
\subsubsection*{Probabilidade de ser de primeira classe}\label{probabilidade-de-ser-de-primeira-classe}}
\addcontentsline{toc}{subsubsection}{Probabilidade de ser de primeira classe}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{ser da primeira classe}}?
\item
  Esta é uma probabilidade {\hl{não-condicional}}: basta dividir o total de passageiros da primeira classe pelo total de pessoas:

  \[
  P(\text{1ª classe}) = 
  \frac
  {325}
  {2.201}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,1476602
\end{verbatim}
\end{itemize}

\hypertarget{probabilidade-de-sobreviver-e-ser-de-primeira-classe}{%
\subsubsection*{\texorpdfstring{Probabilidade de sobreviver \emph{E} ser de primeira classe}{Probabilidade de sobreviver E ser de primeira classe}}\label{probabilidade-de-sobreviver-e-ser-de-primeira-classe}}
\addcontentsline{toc}{subsubsection}{Probabilidade de sobreviver \emph{E} ser de primeira classe}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{ter sobrevivido e ser da primeira classe}}?
\item
  Isto é uma {\hl{probabilidade conjunta}} --- a probabilidade de dois eventos terem ocorrido ao mesmo tempo. {\hl{Ainda não é uma probabilidade condicional}}.
\item
  Queremos saber a proporção de pessoas, do total de pessoas a bordo, que eram de primeira classe e sobreviveram.

  \[
  P(\text{sobrevivente da 1ª classe}) = 
  \frac
  {203}
  {2.201}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,0922308
\end{verbatim}
\end{itemize}

\hypertarget{probabilidade-de-uma-pessoa-da-primeira-classe-sobreviver}{%
\subsubsection*{Probabilidade de uma pessoa da primeira classe sobreviver}\label{probabilidade-de-uma-pessoa-da-primeira-classe-sobreviver}}
\addcontentsline{toc}{subsubsection}{Probabilidade de uma pessoa da primeira classe sobreviver}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{ter sobrevivido, dado que a pessoa estava na primeira classe}}?
\item
  Isto é uma {\hl{probabilidade condicional}}, escrita como

  \[
  P(\text{sobrevivente } \mid \text{ 1ª classe})
  \]
\item
  Cuidado, agora.
\item
  Já sabemos que a pessoa é da primeira classe. Logo, {\hl{restringimos o universo a estas 325 pessoas}}. O denominador vai ser o total de passageiros da primeira classe:

  \[
  P(\text{sobrevivente } \mid \text{ 1ª classe}) = 
  \frac
  {203}
  {325}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{] }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,6246154
\end{verbatim}
\item
  Perceba que

  \[
  P(\text{sobreviveu} \mid \text{1ª classe} )
  \]

  é o mesmo que

  \[
  \frac{P(\text{sobreviveu } \cap \text{ 1ª classe})}{P(\text{1ª classe})}
  \]
\end{itemize}

\hypertarget{probabilidade-de-um-sobrevivente-ser-da-primeira-classe}{%
\subsubsection*{Probabilidade de um sobrevivente ser da primeira classe}\label{probabilidade-de-um-sobrevivente-ser-da-primeira-classe}}
\addcontentsline{toc}{subsubsection}{Probabilidade de um sobrevivente ser da primeira classe}

\begin{itemize}
\item
  Escolha uma das $2.201$ pessoas {\hl{ao acaso}}.
\item
  Qual é a probabilidade de a pessoa escolhida {\hl{ser da primeira classe, dado que ela sobreviveu}}?
\item
  Isto é outra {\hl{probabilidade condicional}}, escrita como

  \[
  P(\text{1ª classe } \mid \text{ sobreviveu})
  \]
\item
  {\hl{Não é a mesma probabilidade}} que $P(\text{sobreviveu} \mid \text{1ª classe})$.
\item
  Em português:

  \begin{itemize}
  \item
    {\hl{$P(\text{sobreviveu} \mid \text{1ª classe})$}} é a probabilidade de

    \begin{itemize}
    \item
      A pessoa sobreviver, dado que era da primeira classe;
    \item
      Equivalentemente: alguém da primeira classe sobreviver.
    \end{itemize}
  \item
    {\hl{$P(\text{1ª classe } \mid \text{ sobreviveu})$}} é a probabilidade de

    \begin{itemize}
    \item
      A pessoa ter sido da primeira classe, dado que sobreviveu;
    \item
      Equivalentemente: alguém que sobreviveu ter sido da primeira classe.
    \end{itemize}
  \item
    Releia até entender.
  \end{itemize}
\item
  Agora, restringimos o universo às pessoas que sobreviveram. Dentre estas, quantas são da primeira classe?

  \[
  P(\text{1ª classe } \mid \text{ sobreviveu}) = 
  \frac
  {203}
  {711}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,2855134
\end{verbatim}

  \begin{rmdimportant}
  Este é um exemplo de que $P(A \mid B)$ pode ser {\hl{diferente}} de $P(B \mid A)$.

  \end{rmdimportant}
\end{itemize}

\hypertarget{definiuxe7uxe3o-de-probabilidade-condicional}{%
\subsection{Definição de probabilidade condicional}\label{definiuxe7uxe3o-de-probabilidade-condicional}}

\begin{itemize}
\item
  Como vimos nos exemplos, {\hl{para calcular $P(A \mid B)$, restringimos o universo aos elementos onde $B$ acontece}}, e, deste universo, verificamos quantos elementos também correspondem a $A$ acontecer --- isto é, {\hl{elementos onde $A \cap B$ acontece}}.
\item
  Em termos de frequência relativa:

  \[
  \frac{\text{ocorrências de } A \cap B}{\text{ocorrências de }B}
  \]
\item
  Em termos de probabilidade, a definição é

  \[
  P(A \mid B) \quad=\quad \frac{P(A \cap B)}{P(B)}
  \]
\end{itemize}

\hypertarget{exercuxedcios-14}{%
\subsection{Exercícios}\label{exercuxedcios-14}}

No Titanic,

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Qual a probabilidade de um tripulante sobreviver?
\item
  Qual a probabilidade de um sobrevivente ser tripulante?
\item
  Qual a probabilidade de um não-tripulante sobreviver?
\item
  Qual a probabilidade de um sobrevivente não ser tripulante?
\item
  Compare as probabilidades condicionais de uma pessoa sobreviver dado que

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    Ela estava na 1ª classe. (Já calculada no exemplo acima: $0{,}62$.)
  \item
    Ela estava na 2ª classe.
  \item
    Ela estava na 3ª classe.
  \item
    Ela era da tripulação.
  \end{enumerate}

  Que conclusões você tira?
\end{enumerate}

\hypertarget{probabilidade-conjunta}{%
\section{Probabilidade conjunta}\label{probabilidade-conjunta}}

\begin{itemize}
\item
  Imagine que queremos calcular a probabilidade de dois eventos $A$ e $B$ acontecerem {\hl{ao mesmo tempo}}.
\item
  Ou seja, queremos descobrir {\hl{a probabilidade conjunta $P(A \cap B)$}}.
\item
  Muitas vezes, é difícil calcular esta probabilidade diretamente.
\item
  A fórmula para calcular $P(A \mid B)$ nos dá uma maneira de calcular $P(A \cap B)$:

  \[
  P(A \mid B) \;=\; \frac{P(A \cap B)}{P(B)} 
  \quad\iff\quad
  P(A \cap B) \;=\; P(A \mid B) \cdot P(B)
  \]
\item
  Ou, invertendo $A$ e $B$,

  \[
  P(B \mid A) \;=\; \frac{P(A \cap B)}{P(A)} 
  \quad\iff\quad
  P(A \cap B) \;=\; P(B \mid A) \cdot P(A)
  \]
\item
  Em palavras:

  \begin{itemize}
  \item
    A {\hl{probabilidade de $A$ e $B$ acontecerem juntos}} é a {\hl{probabilidade de $A$ dado que $B$ aconteceu}}, multiplicada pela {\hl{probabilidade de $B$}}.
  \item
    Ou, invertendo $A$ e $B$, a {\hl{probabilidade de $A$ e $B$ acontecerem juntos}} é a {\hl{probabilidade de $B$ dado que $A$ aconteceu}}, multiplicada pela {\hl{probabilidade de $A$}}.
  \end{itemize}
\end{itemize}

\hypertarget{independuxeancia}{%
\section{Independência}\label{independuxeancia}}

\begin{itemize}
\item
  \protect\hyperlink{eventos-independentes-explicaux5cux25C3ux5cux25A7ux5cux25C3ux5cux25A3o-informal}{Mais acima}, vimos que, para dois eventos {\hl{independentes}} $A$ e $B$, a probabilidade conjunta $P(A \cap B)$ é igual a $P(A) \cdot P(B)$.
\item
  Olhando para as fórmulas acima para a probabilidade conjunta, se $A$ e $B$ forem independentes, então

  \[
  \begin{aligned}
  P(A \cap B) &= P(A \mid B) \cdot P(B) \\
              &= P(A) \cdot P(B)
  \end{aligned}
  \]

  o que nos diz que

  \[
  P(A \mid B) = P(A)
  \]
\item
  Da mesma forma,

  \[
  P(B \mid A) = P(B)
  \]
\item
  Em palavras: {\hl{saber que um dos eventos ocorreu não altera a probabilidade do outro evento}}.
\item
  Qualquer uma das $3$ igualdades pode ser tomada como a definição formal de {\hl{eventos independentes}}.
\end{itemize}

\hypertarget{exemplos}{%
\subsection{Exemplos}\label{exemplos}}

\hypertarget{estar-na-primeira-classe-e-sobreviver-suxe3o-independentes}{%
\subsubsection*{Estar na primeira classe e sobreviver são independentes?}\label{estar-na-primeira-classe-e-sobreviver-suxe3o-independentes}}
\addcontentsline{toc}{subsubsection}{Estar na primeira classe e sobreviver são independentes?}

\begin{itemize}
\item
  A probabilidade de sobreviver, dado que a pessoa estava na 1ª classe, é

  \[
  P(\text{sobreviver} \mid \text{1ª classe}) = 
  \frac{203}{325}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,6246154
\end{verbatim}
\item
  Mas a probabilidade (incondicional) de sobreviver é

  \[
  P(\text{sobreviver}) = \frac{711}{2.201}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tit\_tab[}\StringTok{\textquotesingle{}Sim\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ tit\_tab[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,323035
\end{verbatim}
\item
  Como as probabilidades são diferentes, os eventos {\hl{não são independentes}}.
\item
  Verifique se $P(\text{sobreviver} \cap \text{1ª classe}) = P(\text{sobreviver}) \cdot P(\text{1ª classe})$.
\end{itemize}

\hypertarget{faltas-e-turno-de-trabalho}{%
\subsubsection*{Faltas e turno de trabalho}\label{faltas-e-turno-de-trabalho}}
\addcontentsline{toc}{subsubsection}{Faltas e turno de trabalho}

\begin{itemize}
\item
  Numa empresa:

  \begin{itemize}
  \item
    $75$ funcionários trabalham no turno diurno, com um número de faltas de $3$ por semana.
  \item
    $25$ funcionários trabalham no turno noturno, com um número de faltas de $1$ por semana.
  \item
    Faltar é independente do turno de trabalho?
  \end{itemize}
\item
  Vamos construir uma tabela:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{faltas }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}
  \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{72}\NormalTok{, }\DecValTok{24}\NormalTok{),}
  \AttributeTok{dim =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{addmargins}\NormalTok{()}

\FunctionTok{dimnames}\NormalTok{(faltas) }\OtherTok{=} \FunctionTok{list}\NormalTok{(}
    \StringTok{\textquotesingle{}Turno\textquotesingle{}} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Diurno\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Noturno\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{),}
    \StringTok{\textquotesingle{}Presença\textquotesingle{}} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Faltou\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Presente\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{)}
\NormalTok{  )}

\NormalTok{faltas}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          Presença
## Turno     Faltou Presente Total
##   Diurno       3       72    75
##   Noturno      1       24    25
##   Total        4       96   100
\end{verbatim}
\item
  A probabilidade (incondicional) de faltar é

  \[
  P(\text{Faltou}) = 
  \frac{4}
  {100}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{faltas[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Faltou\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ faltas[}\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,04
\end{verbatim}
\item
  A probabilidade de faltar no turno diurno é

  \[
  P(\text{Faltou} \mid \text{Diurno}) = 
  \frac{3}
  {75}
  \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{faltas[}\StringTok{\textquotesingle{}Diurno\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Faltou\textquotesingle{}}\NormalTok{] }\SpecialCharTok{/}\NormalTok{ faltas[}\StringTok{\textquotesingle{}Diurno\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Total\textquotesingle{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,04
\end{verbatim}
\item
  Como as probabilidades são iguais, os eventos {\hl{são independentes}}.
\item
  Verifique que $P(\text{Faltou}) = P(\text{Faltou} \mid \text{Noturno})$.
\end{itemize}

\hypertarget{probabilidade-total}{%
\section{Probabilidade total}\label{probabilidade-total}}

\hypertarget{exemplo-3}{%
\subsection{Exemplo}\label{exemplo-3}}

\begin{itemize}
\item
  Dentre $80$ homens, $30$ têm olhos azuis.
\item
  Dentre $50$ mulheres, $20$ têm olhos azuis.
\item
  Neste grupo de pessoas, qual a {\hl{probabilidade de ter olhos azuis}}?
\item
  Homens e mulheres formam uma {\hl{partição}} deste grupo --- i.e., cada pessoa {\hl{só pode}} ser homem ou mulher (não ambos) e cada pessoa {\hl{precisa}} ser homem ou mulher.
\item
  O evento ``ter olhos azuis'' se subdivide em dois casos {\hl{mutuamente exclusivos}}:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Ter olhos azuis e ser homem;
  \item
    Ter olhos azuis e ser mulher.
  \end{enumerate}
\item
  Vamos chamar os eventos de

  \begin{itemize}
  \item
    $A$ = ter olhos azuis
  \item
    $H$ = ser homem
  \item
    $M$ = ser mulher
  \end{itemize}
\item
  Calculamos a probabilidade $P(A)$ somando as probabilidades dos dois casos:

  \[
  \begin{aligned}
  P(A) &= P(A \cap H) + P(A \cap M)
  \end{aligned}
  \]
\item
  Então,

  \[
  \begin{aligned}
  P(A) = \frac{30}{130} + \frac{20}{130} = \frac{50}{130} \approx 0{,}39
  \end{aligned}
  \]
\item
  Ou, {\hl{antes de somar}}, podemos transformar as probabilidades conjuntas em produtos de uma probabilidade condicional por uma probabilidade não-condicional:

  \[
  \begin{aligned}
  P(A) &= P(A \cap H) + P(A \cap M) \\
       &= P(A \mid H) P(H) + P(A \mid M) P(M)
  \end{aligned}
  \]
\item
  O que nos dá o mesmo resultado:

  \[
  \begin{aligned}
  P(A) &= \frac{30}{80} \cdot \frac{80}{130} + \frac{20}{50} \cdot \frac{50}{130} \\
       &= \frac{50}{130} \\
       &\approx 0{,}39
  \end{aligned}
  \]
\end{itemize}

\hypertarget{teorema-de-bayes}{%
\section{Teorema de Bayes}\label{teorema-de-bayes}}

\hypertarget{exemplo-4}{%
\subsection{Exemplo}\label{exemplo-4}}

\begin{itemize}
\item
  De {\hl{todos}} os \emph{emails}, $60\%$ são \emph{spam}:

  \[
  P(\text{spam}) = 0{,}6
  \]
\item
  De todos os \emph{emails} {\hl{que são \emph{spam}}}, $90\%$ contêm a palavra ``compre'':

  \[
  P(\text{compre} \mid \text{spam}) = 0{,}9
  \]
\item
  De {\hl{todos}} os \emph{emails} (\emph{spam} ou não), $70\%$ contêm a palavra ``compre'':

  \[
  P(\text{compre}) = 0{,}7
  \]
\item
  Você acaba de receber um \emph{email}. {\hl{Antes de você abri-lo, qual a probabilidade de o \emph{email} ser \emph{spam}}}?
\item
  Bem, {\hl{na ausência de informação adicional}}, $P(\text{spam}) = 0{,}6$.
\item
  Você abre o \emph{email}. {\hl{Ele contém a palavra ``compre''}}.
\item
  Agora, qual a probabilidade de ser \emph{spam}?

  \[
  P(\text{spam} \mid \text{compre}) = {}?
  \]
\item
  Lembre-se de que

  \[
  P(\text{compre} \cap \text{spam}) = P(\text{spam} \mid \text{compre}) \cdot P(\text{compre})
  \]
\item
  Mas também

  \[
  P(\text{compre} \cap \text{spam}) = P(\text{compre} \mid \text{spam}) \cdot P(\text{spam})
  \]
\item
  As duas expressões são iguais:

  \[
  P(\text{spam} \mid \text{compre}) \cdot P(\text{compre}) = P(\text{compre} \mid \text{spam}) \cdot P(\text{spam})
  \]
\item
  Isolando o termo que queremos descobrir:

  \[
  P(\text{spam} \mid \text{compre}) = \frac{P(\text{compre} \mid \text{spam}) \cdot P(\text{spam})}{P(\text{compre})}
  \]
\item
  Substituindo os valores:

  \[
  P(\text{spam} \mid \text{compre}) = \frac{0{,}9 \cdot 0{,}6}{0{,}7} \approx 0{,}77
  \]
\item
  Isto é {\hl{inferência bayesiana}}:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Começamos com uma probabilidade não-condicional: {\hl{\emph{a priori}}}, $P(\text{spam}) = 0{,}6$;
  \item
    Obtivemos {\hl{nova informação}}: o \emph{email} contém ``compre'';
  \item
    Usamos esta informação para calcular uma probabilidade condicional, {\hl{\emph{a posteriori}}}:
  \end{enumerate}

  \[
    P(\text{spam} \mid \text{compre}) = \frac{P(\text{compre} \mid \text{spam}) \cdot P(\text{spam})}{P(\text{compre})}
    \]
\item
  Perceba que, para isso, precisamos da probabilidade não-condicional $P(\text{compre})$ (no denominador).
\end{itemize}

\hypertarget{no-geral}{%
\subsection{No geral}\label{no-geral}}

\[
P(A \mid B) = \frac{P(B \mid A) \cdot P(A)}{P(B)}
\]

\begin{itemize}
\item
  E se você não souber $P(B)$?
\item
  Use o teorema da probabilidade total:

  \[
  P(B) = P(B \cap A_1) + P(B \cap A_2) + \cdots + P(B \cap A_n)
  \]
  onde os $A_i$ formam uma partição da população.
\item
  Isto equivale a

  \[
  P(B) = P(B \mid A_1)P(A_1) + P(B \mid A_2)P(A_2) + \cdots + P(B \mid A_n)P(A_n)
  \]
\end{itemize}

\hypertarget{outro-exemplo}{%
\subsection{Outro exemplo}\label{outro-exemplo}}

\begin{itemize}
\item
  Uma {\hl{doença rara}} afeta $5$ pessoas em $100.000$.
\item
  O exame que detecta a doença tem precisão de $99{,}9\%$; i.e., {\hl{quando uma pessoa está doente, o exame dá positivo $99{,}9\%$ das vezes}}.
\item
  {\hl{Quando uma pessoa \emph{não} está doente, o exame dá positivo $1\%$ das vezes}}. Este caso é um falso positivo.
\item
  Você faz o exame, e {\hl{o resultado é positivo}}.
\item
  {\hl{Dado este resultado, qual a probabilidade de você ter a doença?}}
\item
  Vamos nomear os eventos:

  \begin{itemize}
  \item
    $D = {}$ você está doente;
  \item
    $ND = {}$ você {\hl{não}} está doente;
  \item
    $+ = {}$ o exame deu positivo;
  \item
    $- = {}$ o exame deu negativo.
  \end{itemize}
\item
  Vamos usar Bayes:

  \[
  P(D \mid +) = \frac{P(+ \mid D)P(D)}{P(+)}
  \]
\item
  $P(+ \mid D) = 0{,}999$, pelo enunciado.
\item
  $P(D) = 0{,}00005$, pelo enunciado.
\item
  Daí, $P(ND) = 1 - P(D) = 0{,}99995$.
\item
  Não temos $P(+)$, mas podemos achar usando o \protect\hyperlink{probabilidade-total}{teorema da probabilidade total}, lembrando que o enunciado diz que $P(+ \mid ND) = 0{,}01$:

  \[
  \begin{aligned}
  P(+) &= P(+ \cap D) \;+\; P(+ \cap ND) \\
     &= P(+ \mid D)P(D) \;+\; P(+ \mid ND)P(ND) \\
     &= 0{,}999 \cdot 0{,}00005 \;+\; 0{,}01 \cdot 0{,}99995 \\
     &= 0{,}01004945
  \end{aligned}
  \]
\item
  Inserindo os valores no teorema de Bayes:

  \[
  \begin{aligned}
    P(D \mid +) &= \frac{P(+ \mid D)P(D)}{P(+)} \\
                &= \frac{0{,}999 \cdot 0{,}00005}{0{,}01004945} \\
                &= 0{,}00497
  \end{aligned}
  \]
\item
  A probabilidade de estar doente é {\hl{menos do que $0{,}5\%$}}!
\item
  Você provavelmente esperava uma probabilidade maior.
\item
  Qual das $3$ probabilidades usadas no cálculo fez o resultado ser tão pequeno?

  \begin{itemize}
  \item
    $P(+ \mid D)$?
  \item
    $P(D)$?
  \item
    $P(+)$?
  \end{itemize}
\end{itemize}

\hypertarget{variaveis}{%
\chapter{Variáveis aleatórias}\label{variaveis}}

\hypertarget{vuxeddeo-3}{%
\section{Vídeo}\label{vuxeddeo-3}}

\begin{center} \url{https://youtu.be/8PI-rfsgNdE} \end{center}

\hypertarget{o-que-uxe9-uma-variuxe1vel-aleatuxf3ria}{%
\section{O que é uma variável aleatória?}\label{o-que-uxe9-uma-variuxe1vel-aleatuxf3ria}}

\begin{itemize}
\item
  Uma variável aleatória é uma maneira de {\hl{associar a cada resultado do espaço amostral um número real}}.
\item
  Dependendo do conjunto de números, a variável aleatória pode ser {\hl{discreta}} ou {\hl{contínua}}.
\item
  Falamos sobre a {\hl{probabilidade}} de uma variável aleatória assumir um valor (ou uma faixa de valores).
\end{itemize}

\hypertarget{exemplos-1}{%
\section{Exemplos}\label{exemplos-1}}

\hypertarget{lanuxe7ar-dois-dados}{%
\subsection{Lançar dois dados}\label{lanuxe7ar-dois-dados}}

\begin{itemize}
\item
  Definimos $X = \text{soma dos resultados dos dois dados}$.
\item
  Esta é uma variável aleatória {\hl{discreta}}, com $11$ valores possíveis.
\item
  A tabela com todos os valores possíveis de $X$ e suas probabilidades é chamada de {\hl{distribuição de probabilidade}}:
\end{itemize}

\begin{longtable}{rr}
\toprule
x & P(X = x) \\ 
\midrule
2 & 1/36 \\ 
3 & 2/36 \\ 
4 & 3/36 \\ 
5 & 4/36 \\ 
6 & 5/36 \\ 
7 & 6/36 \\ 
8 & 5/36 \\ 
9 & 4/36 \\ 
10 & 3/36 \\ 
11 & 2/36 \\ 
12 & 1/36 \\ 
\bottomrule
\end{longtable}

\begin{itemize}
\item
  Graficamente:

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/dados-plot-1} \end{center}
\item
  Suponha que a distribuição de probabilidade de $X$ esteja na seguinte \emph{tibble}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glimpse}\NormalTok{(dados\_distr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 11
## Columns: 3
## $ x          <int> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12
## $ `P(X = x)` <chr> "1/36", "2/36", "3/36", "4/36", "5/36", "6/36", "5~
## $ num        <dbl> 0,02777778, 0,05555556, 0,08333333, 0,11111111, 0,~
\end{verbatim}

  A coluna \texttt{num} tem os valores numéricos das probabilidades.
\item
  Qual a probabilidade de conseguir {\hl{$10$ ou mais}}?

  Basta somar as probabilidades de $X=10$, $X=11$ e $X=12$:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dados\_distr }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{\textgreater{}=} \DecValTok{10}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(num) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,1666667
\end{verbatim}
\item
  Qual a probabilidade de conseguir entre $6$ e $8$, inclusive?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dados\_distr }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{\textgreater{}=} \DecValTok{6} \SpecialCharTok{\&}\NormalTok{ x }\SpecialCharTok{\textless{}=} \DecValTok{8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,4444444
\end{verbatim}
\end{itemize}

\hypertarget{altura-de-um-homem-adulto}{%
\subsection{Altura de um homem adulto}\label{altura-de-um-homem-adulto}}

\begin{itemize}
\item
  Definimos $X = \text{estatura em metros de um homem brasileiro adulto, escolhido ao acaso}$.
\item
  Esta é uma variável aleatória {\hl{contínua}}, com um número {\hl{infinito não-enumerável}} de valores.
\item
  Segundo o \href{https://pdf4pro.com/view/levantamento-do-perfil-antropom-201-trico-10652c.html}{Levantamento do Perfil Antropométrico da População Brasileira Usuária do Transporte Aéreo Nacional}, em $2009$, a estatura média do homem brasileiro adulto era de $1{,}73$m, com desvio-padrão de $0{,}07$m.
\item
  Vamos simular uma amostra de muitos homens desta população:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{media }\OtherTok{\textless{}{-}} \FloatTok{1.73}
\NormalTok{desvio }\OtherTok{\textless{}{-}} \FloatTok{0.07}
\NormalTok{homens }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{altura =} \FunctionTok{rnorm}\NormalTok{(}\FloatTok{1e5}\NormalTok{, }\AttributeTok{mean =}\NormalTok{ media, }\AttributeTok{sd =}\NormalTok{ desvio)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Eis um histograma com as {\hl{percentagens}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{homens\_plot }\OtherTok{\textless{}{-}}\NormalTok{ homens }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ altura)) }\SpecialCharTok{+}
    \FunctionTok{geom\_histogram}\NormalTok{(}
      \FunctionTok{aes}\NormalTok{(}\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(density)),}
      \AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\FloatTok{1.4}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{0.01}\NormalTok{)}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\FloatTok{1.4}\NormalTok{, }\FloatTok{2.0}\NormalTok{, .}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =} \StringTok{\textquotesingle{}Altura de um homem brasileiro adulto\textquotesingle{}}\NormalTok{,}
      \AttributeTok{x =} \StringTok{\textquotesingle{}metros\textquotesingle{}}\NormalTok{,}
      \AttributeTok{y =} \StringTok{\textquotesingle{}\%\textquotesingle{}}
\NormalTok{    )}

\NormalTok{homens\_plot}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/homens-plot-1} \end{center}
\item
  Agora, {\hl{sobrepomos o gráfico de uma distribuição normal}} com a mesma média e o mesmo desvio-padrão que a distribuição das alturas:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{homens\_normal }\OtherTok{\textless{}{-}}\NormalTok{ homens\_plot }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}
    \AttributeTok{fun =}\NormalTok{ dnorm, }
    \AttributeTok{args =} \FunctionTok{list}\NormalTok{(}
      \StringTok{\textquotesingle{}mean\textquotesingle{}} \OtherTok{=}\NormalTok{ media,}
      \StringTok{\textquotesingle{}sd\textquotesingle{}} \OtherTok{=}\NormalTok{ desvio}
\NormalTok{    ),}
    \AttributeTok{geom =} \StringTok{\textquotesingle{}line\textquotesingle{}}\NormalTok{,}
    \AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{,}
    \AttributeTok{linewidth =} \DecValTok{1}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{subtitle =} \FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}com N(\textquotesingle{}}\NormalTok{, media, }\StringTok{\textquotesingle{}, \textquotesingle{}}\NormalTok{, desvio,}\StringTok{\textquotesingle{}) em vermelho\textquotesingle{}}\NormalTok{)}
\NormalTok{  )}

\NormalTok{homens\_normal}
\end{Highlighting}
\end{Shaded}

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/homens-normal-1} \end{center}
\item
  A curva vermelha no gráfico é a {\hl{função de densidade de probabilidade}} da distribuição normal, dada por

  \[
  \text{fdp}(x) = {\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}
  \]

  \begin{rmdimportant}
  Em uma distribuição contínua, {\hl{não faz sentido perguntar o valor de $P(X = x)$}}. Como $X$ pode assumir uma quantidade infinita não-enumerável de valores, esta probabilidade é igual a zero!

  Com uma distribuição contínua, {\hl{vamos sempre perguntar sobre faixas de valores}}.

  \end{rmdimportant}
\item
  Qual a probabilidade de um homem ter mais de $1{,}80$m?

  \begin{itemize}
  \item
    Na amostra:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(homens}\SpecialCharTok{$}\NormalTok{altura }\SpecialCharTok{\textgreater{}} \FloatTok{1.80}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,16123
\end{verbatim}
  \item
    Na distribuição teórica:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pnorm}\NormalTok{(}\FloatTok{1.80}\NormalTok{, }\AttributeTok{mean =}\NormalTok{ media, }\AttributeTok{sd =}\NormalTok{ desvio, }\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,1586553
\end{verbatim}
  \item
    No gráfico:

    \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/maior180-plot-1} \end{center}
  \end{itemize}
\item
  Qual a probabilidade de um homem ter entre $1{,}60$m e $1{,}70$m?

  \begin{itemize}
  \item
    Na amostra:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(homens}\SpecialCharTok{$}\NormalTok{altura }\SpecialCharTok{\textgreater{}} \FloatTok{1.60} \SpecialCharTok{\&}\NormalTok{ homens}\SpecialCharTok{$}\NormalTok{altura }\SpecialCharTok{\textless{}} \FloatTok{1.70}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,30585
\end{verbatim}
  \item
    Na distribuição teórica:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pnorm}\NormalTok{(}\FloatTok{1.70}\NormalTok{, }\AttributeTok{mean =}\NormalTok{ media, }\AttributeTok{sd =}\NormalTok{ desvio) }\SpecialCharTok{{-}}
\FunctionTok{pnorm}\NormalTok{(}\FloatTok{1.60}\NormalTok{, }\AttributeTok{mean =}\NormalTok{ media, }\AttributeTok{sd =}\NormalTok{ desvio)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,3024722
\end{verbatim}
  \item
    No gráfico :

    \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/entre-plot-1} \end{center}
  \end{itemize}
\end{itemize}

\hypertarget{valor-esperado}{%
\section{Valor esperado}\label{valor-esperado}}

\begin{itemize}
\item
  O {\hl{valor esperado}} (ou {\hl{esperança matemática}}) de uma variável aleatória é a {\hl{média ponderada dos valores possíveis da variável}}, considerando as probabilidades (ou, no caso contínuo, a densidade de probabilidade) como pesos.
\item
  No caso {\hl{discreto}}:

  \[
  \mu = E(X) = \sum_i x_i \cdot P(X = x_i)
  \]
\item
  No caso {\hl{contínuo}}:

  \[
  \mu = E(X) = \int_{-\infty}^{+\infty} x \cdot \text{fdp}(x) \text{d}x
  \]
\end{itemize}

\hypertarget{lanuxe7ar-dois-dados-1}{%
\subsection{Lançar dois dados}\label{lanuxe7ar-dois-dados-1}}

\begin{itemize}
\item
  Lembrando que a \emph{tibble} \texttt{dados\_distr} contém a distribuição de probabilidades do valor da soma de dois dados, o valor esperado é

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dados\_distr }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{E =} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*}\NormalTok{ num)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(E)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7
\end{verbatim}
\end{itemize}

\hypertarget{lanuxe7ar-um-dado}{%
\subsection{Lançar um dado}\label{lanuxe7ar-um-dado}}

\begin{itemize}
\item
  O valor esperado do valor obtido em um lançamento de um dado não-viciado (onde cada valor tem a probabilidade $1/6$) é

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lado }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}
\NormalTok{p }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{/}\DecValTok{6}
\FunctionTok{sum}\NormalTok{(lado }\SpecialCharTok{*}\NormalTok{ p)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3,5
\end{verbatim}
\end{itemize}

\hypertarget{altura-de-um-homem-adulto-1}{%
\subsection{Altura de um homem adulto}\label{altura-de-um-homem-adulto-1}}

\begin{itemize}
\item
  Estimamos o valor esperado da população simplesmente calculando a média da amostra:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(homens}\SpecialCharTok{$}\NormalTok{altura)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1,730044
\end{verbatim}
\item
  Se a variável aleatória $X$ é normalmente distribuída, com média $\mu$ e desvio-padrão $\sigma$, i.e., $X \sim \mathcal{N}(\mu, \sigma)$, então o valor esperado $E(X)$ é igual a $mu$, que é o valor da integral

  \[
  \int_{-\infty}^{+\infty} {\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}} \text{d}x
  \]
\end{itemize}

\hypertarget{propriedades-do-valor-esperado}{%
\section{Propriedades do valor esperado}\label{propriedades-do-valor-esperado}}

\begin{itemize}
\item
  Vamos ver como o valor esperado se comporta.
\item
  O valor esperado de uma constante é ela mesma:

  \[
  E(c) = c
  \]
\item
  Somar uma constante à variável $X$ altera $E(X)$ pelo valor da constante:

  \[
  E(X \pm c) = E(X) \pm c
  \]
\item
  Multiplicar a variável $X$ por uma constante multiplica $E(X)$ pelo valor da constante:

  \[
  E(c \cdot X) = c \cdot E(X)
  \]
\item
  O valor esperado da soma (resp. diferença) de duas variáveis aleatórias é a soma (resp. diferença) dos valores esperados:

  \[
  E(X \pm Y) = E(X) \pm E(Y)
  \]
\item
  O valor esperado de uma função $f(X)$ de uma variável aleatória $X$ é

  \begin{itemize}
  \item
    Caso discreto:

    \[
    E(f(X)) = \sum_i f(x_i) \cdot P(X = x_i)
    \]
  \item
    Caso contínuo:

    \[
    E(f(X)) = \int_{-\infty}^{+\infty} f(x) \cdot \text{fdp}(x) \text{d}x
    \]
  \end{itemize}
\end{itemize}

\hypertarget{variuxe2ncia-1}{%
\section{Variância}\label{variuxe2ncia-1}}

\begin{itemize}
\item
  A {\hl{variância}} de uma variável aleatória $X$ é {\hl{a média ponderada dos desvios quadrados}}, com as probabilidades como peso.

  \begin{itemize}
  \item
    Caso {\hl{discreto}}:

    \[
    \sigma^2(X) = \sum_i (x_i - \mu)^2 \cdot P(X = x_i)
    \]
  \item
    Caso {\hl{contínuo}}:

    \[
    \sigma^2(X) = \int_{-\infty}^{+\infty} (x - \mu)^2 \cdot \text{fdp}(x) \text{d}x
    \]
  \end{itemize}
\item
  Em qualquer caso,

  \[
  \begin{aligned}
    \sigma^2(X) &= E[(X - \mu)^2]\\
                &= E(X^2) - [E(X)]^2
  \end{aligned}
  \]
\item
  Faça as contas, partindo de $E[(X - \mu)^2]$ e usando as propriedades do valor esperado para chegar a $E(X^2) - [E(X)]^2$.
\end{itemize}

\hypertarget{lanuxe7ar-dois-dados-2}{%
\subsection{Lançar dois dados}\label{lanuxe7ar-dois-dados-2}}

\begin{itemize}
\item
  A variância é

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dados\_distr }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{s2 =} \FunctionTok{sum}\NormalTok{((x }\SpecialCharTok{{-}} \DecValTok{7}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{*}\NormalTok{ num)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(s2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5,833333
\end{verbatim}
\end{itemize}

\hypertarget{lanuxe7ar-um-dado-1}{%
\subsection{Lançar um dado}\label{lanuxe7ar-um-dado-1}}

\begin{itemize}
\item
  A variância é

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lado }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}
\NormalTok{p }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{/}\DecValTok{6}
\FunctionTok{sum}\NormalTok{((lado }\SpecialCharTok{{-}} \FloatTok{3.5}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{*}\NormalTok{ p)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2,916667
\end{verbatim}
\end{itemize}

\hypertarget{altura-de-um-homem-adulto-2}{%
\subsection{Altura de um homem adulto}\label{altura-de-um-homem-adulto-2}}

\begin{itemize}
\item
  Estimando pela variância da amostra:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{var}\NormalTok{(homens}\SpecialCharTok{$}\NormalTok{altura)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,004917532
\end{verbatim}
\item
  Se $X$ é normalmente distribuída com média $\mu$ e desvio-padrão $\sigma$, i.e., $X \sim \mathcal{N}(\mu, \sigma)$, então $\sigma^2(X) = \sigma^2$. De acordo com o estudo, $\sigma^2 = 0.07^2 = 0{,}0049$.
\end{itemize}

\hypertarget{propriedades-da-variuxe2ncia}{%
\section{Propriedades da variância}\label{propriedades-da-variuxe2ncia}}

\begin{itemize}
\item
  A variância de uma constante é zero:

  \[
  \sigma^2(c) = 0
  \]
\item
  Somar uma constante à variável $X$ {\hl{não altera}} a variância:

  \[
  \sigma^2(X \pm c) = \sigma^2(X)
  \]
\item
  Multiplicar a variável $X$ por uma constante multiplica a variância pelo {\hl{quadrado}} da constante:

  \[
  \sigma^2(c \cdot X) = c^2 \cdot \sigma^2(X)
  \]
\item
  A variância da {\hl{soma ou diferença}} de duas variáveis aleatórias é a {\hl{soma}} das variâncias das variáveis:

  \[
  \sigma^2(X \pm Y) = \sigma^2(X) + \sigma^2(Y)
  \]

  \begin{rmdimportant}

  Por que a {\hl{variância da diferença}} é a {\hl{soma das variâncias}}?

  Variância significa {\hl{incerteza}}.

  Considere o seguinte exemplo para entender por que $\sigma^2(X - Y) = \sigma^2(X) + \sigma^2(Y)$:

  \begin{itemize}
  \item
    Você compra uma caixa de $500$g de cereal no mercado. Como o peso não é exato, considere que $X$ é a variável aleatória que representa o peso do cereal na caixa, com $\mu_X = 500$g e uma variância qualquer $\sigma^2_X$ (que corresponde à {\hl{incerteza do processo de embalagem do cereal}} na fábrica).
  \item
    Você decide comer $100\text{g}$ de cereal, despejando parte do conteúdo na caixa em uma tigela. Como sua capacidade de medir $100\text{g}$ não é exata, considere que $Y$ é a variável aleatória que representa o peso do cereal na tigela, com $\mu_Y = 100\text{g}$ e uma variância qualquer $\sigma^2_Y$ (que corresponde à {\hl{incerteza do seu processo de pesar}} $100\text{g}$).
  \item
    Considere a variável aleatória $Z = X - Y$, que representa a quantidade de cereal que sobrou na caixa.

    \begin{itemize}
    \item
      Certamente a média $\mu_Z = \mu_X - \mu_Y = 400\text{g}$.
    \item
      E a variância $\sigma^2_Z$?
    \item
      O fato de $Z$ ser o resultado da subtração de duas variáveis aleatórias diminui a incerteza?
    \item
      Ou a composição de incertezas aumenta a incerteza?
    \end{itemize}
  \end{itemize}

  \end{rmdimportant}
\end{itemize}

\hypertarget{mais-exemplos}{%
\section{Mais exemplos}\label{mais-exemplos}}

\hypertarget{seguradora}{%
\subsection{Seguradora}\label{seguradora}}

\begin{itemize}
\item
  Você tem uma seguradora, com $1.000$ segurados, cada um deles pagando $50$ dinheiros por ano.
\item
  Por ano, $1$ dos $1.000$ segurados morre. Neste caso, sua seguradora deve pagar $10.000$ dinheiros.
\item
  Por ano, $2$ dos $1.000$ segurados ficam inválidos. Neste caso, sua seguradora deve pagar $5.000$ dinheiros.
\item
  {\hl{Quanto sua seguradora espera ter de lucro (ou prejuízo) por segurado, por ano?}}

  \begin{itemize}
  \item
    {\hl{Chamando de $X$ a variável aleatória que representa o dinheiro pago pela seguradora por apólice, por ano}}, temos

    \[
    \begin{aligned}
    P(X = 10000) &= 1/1000\\
    P(X = 5000)  &= 2/1000\\
    P(X = 0)     &= 997/1000
    \end{aligned}
    \]
  \item
    Daí,
  \end{itemize}

  \[
   \begin{aligned}
   E(X) &= 10000 \cdot \frac{1}{1000} \;+\; 5000 \cdot \frac{2}{1000} \;+\; 0 \cdot \frac{997}{1000} \\
        &= 20
   \end{aligned}
   \]

  \begin{itemize}
  \tightlist
  \item
    Como cada segurado paga $50$ dinheiros por ano, sua seguradora lucra, em média, $30$ dinheiros por apólice, por ano.
  \end{itemize}
\item
  E o desvio-padrão?

  \begin{itemize}
  \item
    Calculando a variância antes:

    \[
     \begin{aligned}
     \sigma^2(X) &= (10000 - 20)^2 \cdot \frac{1}{1000} \;+\; (5000 -20)^2 \cdot \frac{2}{1000} \;+\; (0 - 20)^2 \cdot \frac{997}{1000} \\
          &= 9980^2 \cdot \frac{1}{1000} \;+\; 4980^2 \cdot \frac{2}{1000} \;+\; (- 20)^2 \cdot \frac{997}{1000} \\
          &= 149600
     \end{aligned}
    \]
  \item
    O desvio-padrão é a raiz quadrada de $\sigma^2$:

    \[
    \sigma = 386{,}78
    \]
  \end{itemize}
\end{itemize}

\hypertarget{gerador-de-nuxfameros-aleatuxf3rios}{%
\subsection{Gerador de números aleatórios}\label{gerador-de-nuxfameros-aleatuxf3rios}}

\begin{itemize}
\item
  Você programa um gerador de números aleatórios $x \in [1, 3] \subset \mathbb{R}$.
\item
  Considere $X$ a variável aleatória que representa os números gerados.
\item
  $X$ é uma variável aleatória contínua, com fdp

  \[
  f(x) = 
    \begin{cases}\displaystyle
      \frac{1}{2} & \text{se } x \in [1, 3] \\
      \,0 & \text{se } x \not\in [1, 3]
    \end{cases}
  \]

  cujo gráfico é

  \begin{center}\includegraphics[width=1\linewidth]{_main_files/figure-latex/unif-1} \end{center}
\item
  Isto significa que a densidade de probabilidade está distribuída uniformemente no intervalo $[1, 3]$.
\item
  Vamos calcular o valor esperado $E(X)$:

  \[
  \begin{aligned}
  E(X) 
    &= \int_{-\infty}^{+ \infty} x \cdot f(x) \text{d}x \\
    &= \int_{1}^{3} x \cdot \frac{1}{2} \text{d}x \\
    &= \frac12 \cdot \left.\frac{x^2}{2} \right|_1^3 \\
    &= 2
  \end{aligned}
  \]
\item
  Ou seja, a média dos números gerados, depois de muitas execuções, vai ser $2$.
\item
  Vamos calcular a variância $\sigma^2(X)$:
\end{itemize}

\[
\begin{aligned}
\sigma^2(X) 
  &= \int_{-\infty}^{+ \infty} (x - 2)^2 \cdot f(x) \text{d}x \\
  &= \int_{1}^{3} (x-2)^2 \cdot \frac{1}{2} \text{d}x \\
  &= \frac13
\end{aligned}
\]

\begin{itemize}
\item
  Isto vai dar um desvio-padrão $\sigma = \sqrt{\sigma^2} = \frac{\sqrt{3}}{3} \approx 0{,}58$.
\item
  Mas R tem este gerador! Vamos gerar muitos valores e calcular a média e o desvio-padrão:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{valores }\OtherTok{\textless{}{-}} \FunctionTok{runif}\NormalTok{(}\AttributeTok{n =} \FloatTok{1e6}\NormalTok{, }\AttributeTok{min =} \DecValTok{1}\NormalTok{, }\AttributeTok{max =} \DecValTok{3}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(valores)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1,999605
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(valores)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0,5771331
\end{verbatim}
\item
  Como exercício, verifique que, para qualquer variável aleatória contínua $X$ distribuída uniformemente entre $a$ e $b$, i.e., com fdp

  \[
  f(x) = 
    \begin{cases}\displaystyle
      \frac{1}{b - a} & \text{se } x \in [a, b] \\
      \,0 & \text{se } x \not\in [a, b]
    \end{cases}
  \]

  ocorre que

  \begin{itemize}
  \item
    $E(X) = \frac{a+b}{2}$, e
  \item
    $\sigma^2(X) = \frac{(a - b)^2}{12}$.
  \end{itemize}
\end{itemize}

\hypertarget{referuxeancias}{%
\chapter*{Referências}\label{referuxeancias}}
\addcontentsline{toc}{chapter}{Referências}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-morgadoAnaliseCombinatoriaProbabilidade2004}{}}%
Morgado, Augusto César de Oliveira, João Bosco Pitombeira de Carvalho, Paulo Cezar Pinto Carvalho, e Pedro Jesus Fernandez. 2004. \emph{Análise Combinatória e Probabilidade}. {Rio de Janeiro}: {Impa / Vitae}.

\end{CSLReferences}

\end{document}
